var globalBuildVersion="9487".replace(/ /g,"");var GSEnum={};
(function(){GSEnum.GameDirection={NOT_SET:-1,BOTTOM:0,RIGHT:1,TOP:2,LEFT:3};GSEnum.Balance={Win:0,Lose:1,Normal:2};GSEnum.Scene={Launch:1<<0,Login:1<<1,Lobby:1<<2,Game:1<<3,Slot:1<<4};GSEnum.Game={LAST:-1,NONE:0,MJ_16:5,MJ_13:8,BIGTWO:3,BIGTWOD:13,POKER13:7,SEVENS:2,LANDLORD:20,TEXAS:19};GSEnum.InAppBrowser={NONE:0,LINE:1,FACEBOOK:2,WECHAT:3};GSEnum.OpacityPercent={PERCENT_0:0,PERCENT_10:26,PERCENT_20:51,PERCENT_30:77,PERCENT_40:102,PERCENT_50:128,PERCENT_60:153,PERCENT_70:179,PERCENT_80:204,PERCENT_90:230,
PERCENT_100:255};GSEnum.BundleID={MJ_16_Android:"com.godgame.mj.android",MJ_16_iPhone:"com.godgame.mj",MJ_16_iPad:"com.godgame.mjHD",MJ_13_Android:"com.godgame.mj13.android",MJ_13_iPhone:"com.godgame.13mj",MJ_13_iPad:"com.godgame.13mjHD",BigTwo_Android:"com.godgame.bigtwo.android",BigTwo_iPhone:"com.godgame.bigtwo",BigTwo_iPad:"com.godgame.bigtwoHD",BigTwoD_Android:"com.godgame.bigtwod.android",BigTwoD_iPhone:"com.godgame.bigtwod",BigTwoD_iPad:"com.godgame.bigtwodHD",Poker13_Android:"com.godgame.poker13.android",
Poker13_iPhone:"com.godgame.13poker",Poker13_iPad:"com.godgame.13pokerHD",Sevens_Android:"com.godgame.sevens.android",Sevens_iPhone:"com.godgame.sevens",Sevens_iPad:"com.godgame.sevensHD",Landlord_Android:"com.godgame.landlord.android",Landlord_iPhone:"com.godgame.landlord",Landlord_iPad:"com.godgame.landlordHD",Texas_Android:"com.godgame.texasholdem.android",Texas_iPhone:"tw.godgame.texasholdem",Texas_iPad:"com.godgame.texasholdemHD"}})();
function GSEnumHelper(obj){var lastIndex=-1;var keys=Object.keys(obj);for(var i=0;i<keys.length;i++){var key=keys[i];var val=obj[key];if(val===-1){val=++lastIndex;obj[key]=val}else if(typeof val==="number")lastIndex=val;else if(typeof val==="string"&&typeof parseFloat(key)==="number")continue}return obj};var GSFont={};
(function(){if(cc.sys.isNative)if(cc.sys.os===cc.sys.OS_IOS)GSFont.TTF={Arial:"Arial",Arial_Bold:"Arial",Sans:"Sans",Sans_Bold:"Sans",HelveticaNeue:"HelveticaNeue",HelveticaNeue_Bold:"HelveticaNeue",BebasKai:"BebasKai",OmnesSemibold:"OmnesSemibold-Roman",SweiGothicCJKtc:"SweiGothicCJKtc-Medium"};else GSFont.TTF={Arial:"Arial",Arial_Bold:"Arial",Sans:"Sans",Sans_Bold:"Sans",HelveticaNeue:"HelveticaNeue",HelveticaNeue_Bold:"HelveticaNeue-Bold",BebasKai:"Fonts/BebasKai.ttf",OmnesSemibold:"Fonts/Omnes Semibold Regular.ttf",SweiGothicCJKtc:"Fonts/SweiGothicCJKtc-Medium.ttf"};
else GSFont.TTF={Arial:"Arial",Arial_Bold:"Arial",Sans:"Sans",Sans_Bold:"Sans",HelveticaNeue:"HelveticaNeue",HelveticaNeue_Bold:"HelveticaNeue-Bold",BebasKai:"BebasKai",OmnesSemibold:"OmnesSemibold-Roman",SweiGothicCJKtc:"SweiGothicCJKtc-Medium"}})();var JSDebugMode=cc.sys.isNative?GSDeviceInfo.getIsDebugMode():false;var SlotTestMode=!cc.sys.isNative&&JSDebugMode?0:0;var USE_i18n=cc.sys.isNative?true:true;var LogShowPingPong=false;var SLOT_CSF=.5;
if(SLOT_CSF===1)var SCSF={p:function(x,y){return cc.p(x,y)},size:function(w,h){return cc.size(w,h)},rect:function(x,y,w,h){return cc.rect(x,y,w,h)},get:function(value){return value}};else var SCSF={p:function(x,y){return cc.pMult(cc.p(x,y),SLOT_CSF)},size:function(w,h){return cc.size(w*SLOT_CSF,h*SLOT_CSF)},rect:function(x,y,w,h){return cc.rect(x*SLOT_CSF,y*SLOT_CSF,w*SLOT_CSF,h*SLOT_CSF)},get:function(value){return value*SLOT_CSF}};var JSFontName=GSFont.TTF.SweiGothicCJKtc;var JSFontBoldName=JSFontName;
var JSFontDefaultName=JSFontName;var JSFontBoldDefaultName=JSFontBoldName;var JSVisibleSize=null;var JSOriginPoint=null;var JSScreenMidPos=null;var JSScreenBonusWidth=0;var JSScreenBonusHeight=0;var JSScreenBonusHalfWidth=0;var JSScreenBonusHalfHeight=0;var JSScreenSafeWidth=0;var JSScreenSafeHeight=0;var JSWriteablePath=cc.sys.isNative?jsb.fileUtils.getWritablePath():"";var JSIsPortrait=false;
var JSConfigInit=function(){JSConfigReset();var config=cc.game.config;if(config)JSDebugMode=config[cc.game.CONFIG_KEY.debugMode]==0?false:true;if(cc.sys.isBuildH5&&"isDebug"in GS.getUrlQueryParam(window.location.href))JSDebugMode=true;JSServerConfigReset();cc.director.setDisplayStats(JSDebugMode);if(cc.director.getContentScaleFactor()===4)GS.resourcesFolder="HDR"};
var JSConfigReset=function(){cc.winSize=cc.director.getWinSize();cc.sys.isNative&&cc.visibleRect.init();JSVisibleSize=cc.director.getVisibleSize();JSOriginPoint=cc.director.getVisibleOrigin();JSIsPortrait=JSVisibleSize.width<JSVisibleSize.height;JSScreenMidPos=cc.p(JSVisibleSize.width/2,JSVisibleSize.height/2);JSScreenBonusWidth=JSVisibleSize.width-(JSIsPortrait?288:512);JSScreenBonusHeight=JSVisibleSize.height-(JSIsPortrait?512:288);JSScreenBonusHalfWidth=JSScreenBonusWidth/2;JSScreenBonusHalfHeight=
JSScreenBonusHeight/2;JSScreenSafeWidth=cc.sys.isNative?GSDeviceInfo.getSafeAreaWidth():0;JSScreenSafeHeight=cc.sys.isNative?GSDeviceInfo.getSafeAreaHeight():0;var notificationNode=cc.director.getNotificationNode();if(notificationNode){notificationNode.setPosition(JSOriginPoint);var logView=notificationNode.getChildByName("LogView");if(logView)logView.refreshViewSize()}if(cc.sys.isNative&&cc.sys.os===cc.sys.OS_ANDROID){var minRatio=9/18;if(JSIsPortrait&&JSScreenSafeHeight===0){if(JSVisibleSize.width/
JSVisibleSize.height<minRatio)JSScreenSafeHeight=10}else if(!JSIsPortrait&&JSScreenSafeWidth===0)if(JSVisibleSize.height/JSVisibleSize.width<minRatio)JSScreenSafeWidth=10}};
var JSServerConfigReset=function(){JSDebugMode=JSDebugMode||(GS.testPeople="");if(param.test)if(/^\w+$/.test(param.test))GS.testPeople=param.test;else param.test=null;if((param.test||JSDebugMode)&&GS.testPeople){var dm=SlotTestMode?"ws.vgs.tw":"t.vgs.tw";if(GS.isHttps)GS.domain=GS.httpScheme+"//"+GS.testPeople+"-"+dm;else GS.domain=GS.httpScheme+"//"+GS.testPeople+"."+dm}else GS.domain=GS.httpScheme+"//"+GS.reallyDomain;if((param.test||JSDebugMode)&&GS.testPeople)GS.hostURL=GS.domain+GS.hostPHP+"test="+
GS.testPeople+"&";else GS.hostURL=GS.domain+GS.hostPHP};var JSTYPE={UNKNOW:-1,NULL:0,UNDEFINED:1,FUNCTION:2,STRING:3,NUMBER:4,BOOLEAN:5,ARRAY:6,OBJECT:7};
var JSColor={BLACK:cc.color(0,0,0),BLUE:cc.color(50,220,255),BLUE_BRIGHT:cc.color(0,185,245),BLUE_DARK:cc.color(0,55,250),BROWN:cc.color(95,65,5),CYAN:cc.color(80,220,220),GRAY:cc.color(150,150,150),GRAY_DARK:cc.color(54,54,54),GREEN:cc.color(150,255,50),GREEN_BRIGHT:cc.color(0,195,100),ORANGE:cc.color(255,200,45),PEACH:cc.color(255,0,180),PEACH_DARK:cc.color(235,0,95),PINK:cc.color(235,0,225),PINK2:cc.color(250,190,240),PURPLE:cc.color(200,216,255),PURPLE_DARK:cc.color(165,0,205),PURPLE_SLOT:cc.color(85,
0,200),RED:cc.color(255,0,0),YELLOW:cc.color(250,250,80),YELLOW2:cc.color(255,230,160),YELLOW3:cc.color(255,235,0),YELLOW4:cc.color(255,240,0),WHITE:cc.color(255,255,255),OUTLINE_GREEN:cc.color(0,105,0),OUTLINE_PURPLE:cc.color(5,0,115),OUTLINE_BLUE:cc.color(0,70,195),OUTLINE_RED:cc.color(50,0,55),OUTLINE_GRAY:cc.color(50,50,50),OUTLINE_YELLOW:cc.color(165,45,25),OUTLINE_CONTENT:cc.color(45,0,135),colorToRichColor:function(color){var hR=color.r.toString(16).toUpperCase(),hG=color.g.toString(16).toUpperCase(),
hB=color.b.toString(16).toUpperCase();return"#!"+(color.r<16?"0"+hR:hR)+(color.g<16?"0"+hG:hG)+(color.b<16?"0"+hB:hB)+"!#"}};var DIALOG_FULL_ANIMATION_TIME=.4;var DIALOG_ANIMATION_TIME=.25;var DIALOG_BG_OPACITY=150;var DIALOG_MASK_WIDTH=35;var DIALOG_MASK_HEIGHT=35;var DIALOG_MASK_OPACITY=100;var param={};var hash={};
if(!cc.sys.isNative){var dataStr=window.location.search;var tempStr=dataStr.slice(1);var tempArr=tempStr.split("&");tempArr.forEach(cur=>{var splitArr=cur.split("=");param[splitArr[0]]=splitArr[1]});var dataStr=window.location.hash;var tempStr=dataStr.slice(1);var tempArr=tempStr.split("&");tempArr.forEach(cur=>{var splitArr=cur.split("=");hash[splitArr[0]]=splitArr[1]})}var GS={};GS.urlSearchParam=param;GS.urlHashParam=hash;GS.is13MJ=false;GS.gameVersion="11.6"+"_"+globalBuildVersion;
GS.gameName="\u795e\u4f86\u4e5f\u9ebb\u5c07";GS.fbAppID=null;GS.isApplePad=cc.sys.platform===cc.sys.IPAD;GS.resourcesFolder="HD";
if(cc.sys.isNative){GS.platform=GSDeviceInfo.getDevice();GS.bundleID=GSDeviceInfo.getBundleID();GS.deviceName=GSDeviceInfo.getDeviceName();GS.gameVersion=GSDeviceInfo.getGameVersion();GS.nativeBundleID=GS.bundleID;GS.apkDownloadFromEnc=1;if(GSDeviceInfo.getEncIsDownloadFormGamesofa())GS.apkDownloadFromEnc=7168;else GS.apkDownloadFromEnc=GSDeviceInfo.getIsDownloadFormStore()?1:2}else{if(cc.sys.os===cc.sys.OS_IOS)if(cc.sys.deviceName===cc.sys.IPHONE){GS.platform="iPhone_H5";GS.bundleID="com.gamesofa.html5_iphone.mj"}else{GS.platform=
"iPad_H5";GS.bundleID="com.gamesofa.html5_ipad.mj"}else if(cc.sys.os===cc.sys.OS_ANDROID){GS.platform="Android_H5";GS.bundleID="com.gamesofa.html5_an.mj"}else{GS.platform="MOBILE_H5";GS.bundleID="com.gamesofa.html5_mobile.mj"}GS.deviceName=window.navigator.userAgent;GS.nativeBundleID=GS.bundleID;if(SlotTestMode){GS.apkDownloadFromEnc=1;GS.platform="MOBILE_H5";GS.bundleID="com.gamesofa.android.wowslot"}else{GS.apkDownloadFromEnc=1;GS.platform="AndroidPhone";GS.nativeBundleID=GSEnum.BundleID.MJ_16_Android}}
GS.useNewAudioEngine=cc.sys.isNative;switch(GS.nativeBundleID){case GSEnum.BundleID.Texas_iPhone:case GSEnum.BundleID.Texas_Android:GS.containerID=0;GS.isContainer=false;break;default:GS.containerID=3;GS.isContainer=true;break}GS.gameLobbyID=GSEnum.Game.MJ_16;GS.nowGame=GSEnum.Game.NONE;GS.oldNowGame=GS.nowGame;
GS.webUrlParam="bundleID="+GS.bundleID+"&appid="+GS.bundleID+"&container="+GS.containerID.toString()+"&client_ver="+GS.gameVersion+"&os="+GS.platform+"&device="+encodeURIComponent(GS.deviceName)+"&nativeBundleID="+GS.nativeBundleID+"&isHtml5="+(cc.sys.isNative?"0":"1");GS.fingerprint=null;if(!cc.sys.isNative){GS.isGamesofaHost=window.location.hostname.indexOf("www.gamesofa.com")>-1;GS.httpScheme=window.location.protocol==="https:"?"https:":"http:"}else{GS.isGamesofaHost=true;GS.httpScheme="https:"}
GS.isHttps=GS.httpScheme=="https:";GS.getAppleStoreID=function(nativeBundleID){switch(nativeBundleID){case GSEnum.BundleID.MJ_16_iPhone:return"455902495";case GSEnum.BundleID.MJ_16_iPad:return"448564325";case GSEnum.BundleID.Texas_iPhone:return"439159270";case GSEnum.BundleID.BigTwo_iPhone:return"465816319"}};if(cc.sys.os===cc.sys.OS_IOS)GS.appleStoreID=GS.getAppleStoreID(GS.nativeBundleID);
GS.getNativeAppURL=function(nativeBundleID){if(cc.sys.os===cc.sys.OS_IOS)return"https://apps.apple.com/tw/app/apple-store/id"+GS.getAppleStoreID(nativeBundleID);else if(cc.sys.os===cc.sys.OS_ANDROID)return"https://play.google.com/store/apps/details?id="+nativeBundleID;else return GS.httpScheme+"//www.gamesofa.com"};GS.nativeAppURL=GS.getNativeAppURL(GS.nativeBundleID);GS.isPrivateBrowsing=false;if(!cc.sys.isNative)try{localStorage.test=2}catch(e){GS.isPrivateBrowsing=true}GS.useSpineAvatar=true;
GS.testPeople="";if(SlotTestMode);GS.reallyDomain="www.gamesofa.com";GS.domain=GS.httpScheme+"//"+GS.reallyDomain;GS.hostPHP="/big/mj.php?";if(SlotTestMode)GS.hostPHP="/big/slots_new_host.php?";GS.hostURL=GS.domain+GS.hostPHP;GS.sceneLoaded=0;GS.pushNotificationServerKey="BKnN1T2Z0b8YzX8Qxz-fl1eGUa6Kx3_8RyVtnd-5vtiPWDCfO12XTrp8PqpqIsBHtoepO4WVEb6tt1x-hBbUqEk";
if(!cc.sys.isNative&&cc.sys.isMobile)window.onbeforeunload=function(e){var message="\u662f\u5426\u8981\u96e2\u958b\u6b64\u904a\u6232",e=e||window.event;if(e)e.returnValue=message;return message};
if(!cc.sys.isNative){var ua=window.navigator.userAgent;if(cc.sys.deviceName==cc.sys.IPHONE&&ua.indexOf("Safari")!==-1){__BrowserGetter.availHeight=function(){return window.innerHeight};window.addEventListener("resize",function(){var bodyHeight=document.body.offsetHeight;var windowHeight=window.innerHeight;var isLandscape=Math.abs(window.orientation)===90;if(isLandscape)if(windowHeight!=bodyHeight)setTimeout(function(){window.scrollTo(0,1)},0)})}}GS.inAppBrowser=GSEnum.InAppBrowser.NONE;
if(!cc.sys.isNative){var ua=window.navigator.userAgent;if(ua.indexOf("Line")>-1)GS.inAppBrowser=GSEnum.InAppBrowser.LINE;else if(ua.indexOf("FBAN")>-1||ua.indexOf("FBAV")>-1||ua.indexOf("FBIOS")>-1||ua.indexOf("facebookexternalhit")>-1||ua.indexOf("Facebot")>-1||ua.indexOf("facebook")>-1)GS.inAppBrowser=GSEnum.InAppBrowser.FACEBOOK;else if(ua.indexOf("MicroMessenger")>-1)GS.inAppBrowser=GSEnum.InAppBrowser.WECHAT}const REGEXP_TWO_NUMBERS=/\d{2}/g;const REGEXP_CARD_NUMBERS=/\w{2}/g;if(typeof GS==="undefined")GS={};
(function(){GS.addListener=function(name,callback,node){if(!cc.sys.isNative){var listener=new cc.EventListener(cc.EventListener.CUSTOM,name,callback);return cc.eventManager.addListener(listener,node)}else return cc.eventManager.addListener({event:cc.EventListener.CUSTOM,eventName:name,callback:callback},node)};GS.addListenerOnce=function(name,callback,node){var listener;var newCallbackFunc=function(event){callback&&callback(event);listener&&cc.eventManager.removeListener(listener)};if(!cc.sys.isNative){listener=
new cc.EventListener(cc.EventListener.CUSTOM,name,newCallbackFunc);return cc.eventManager.addListener(listener,node)}else{listener=cc.eventManager.addListener({event:cc.EventListener.CUSTOM,eventName:name,callback:newCallbackFunc},node);return listener}};GS.dispatchCustomEvent=function(name,value){cc.eventManager.dispatchCustomEvent(name,value)};GS.enableAutoFullScreen=function(){if(!cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID){var ua=navigator.userAgent;if(ua.indexOf("Version/")<0){var repeatFunc=
function(){if(!cc.screen.fullScreen()){var element=document.getElementById("Cocos2dGameContainer");cc.screen.autoFullScreen(element,function(){window.dispatchEvent(new Event("orientationchange"));repeatFunc()})}};repeatFunc()}}};GS.localStorage={setItem:function(name,value,crossGame=false){if(typeof value!=="string")cc.error("GS.localStorage.setItem key="+name+" Value is not String");if(!crossGame)name=GS.bundleID+"_"+name;if(!cc.sys.isNative)name=GS.nativeBundleID+"_"+name;cc.sys.localStorage.setItem(name,
value)},getItem:function(name,defaultValue,crossGame=false){if(!crossGame)name=GS.bundleID+"_"+name;if(!cc.sys.isNative)name=GS.nativeBundleID+"_"+name;var value=cc.sys.localStorage.getItem(name);if(value==null)value=defaultValue;return value}};var needTransferURL=GS.httpScheme=="https:";GS.transferURL=function(url){return needTransferURL?url.replace(/http:/g,GS.httpScheme):url};GS.transferDomain=function(url){return url.replace("www.gamesofa.com",GS.reallyDomain)};GS.loadJSFile=function(filename,
callback){if(cc.sys.isNative)return;var fileref=document.createElement("script");fileref.setAttribute("type","text/javascript");fileref.setAttribute("src",filename);if(callback){fileref.async=true;fileref.onreadystatechange=callback;fileref.onload=callback}document.getElementsByTagName("head")[0].appendChild(fileref)};GS.getUrlQueryParam=function(url){var query={};if(url.indexOf("?")!==-1){var array=url.split("?")[1].split("&");array.forEach(cur=>{var keyValue=cur.split("=");query[keyValue[0]]=decodeURIComponent(keyValue[1])})}return query};
GS.loadSpine=function(file,callback){if(!cc.sys.isNative){var resources;if(Array.isArray(file))resources=file;else resources=[file+".json",file+".atlas",file+".png"];if(resources.every(cur=>cc.loader.getRes(cur)))callback();else cc.loader.load(resources,function(a,b){callback()})}else callback()};GS.loadSpineBinary=function(file,callback){if(!cc.sys.isNative){var resources;if(Array.isArray(file))resources=file;else resources=[file+".skel",file+".atlas",file+".png"];if(resources.every(cur=>cc.loader.getRes(cur)))callback();
else cc.loader.load(resources,function(a,b){callback()})}else callback()};GS.scheduleOnce=function(func,target,delayTime=0,key){cc.director.getScheduler().schedule(func,target,0,0,delayTime,false,key)};GS.schedule=function(func,target,interval=0,delayTime=0,key){cc.director.getScheduler().schedule(func,target,interval,cc.REPEAT_FOREVER,delayTime,false,key)};GS.unschedule=function(key,target){cc.director.getScheduler().unschedule(key,target)};GS.unscheduleAll=function(target){cc.director.getScheduler().unscheduleAllForTarget(target)}})();var DialogPriority={};
(function(){var priorityObject=GSEnumHelper({VegasCompetePurchaseDialog:-1,VegasCompeteMainDialog:-1,VegasChooseAreaDialog:-1,VegasMallTycoonGetRewardDialog:-1,VegasTreasureIslandDialog:-1,VegasTreasureIslandMainDialog:-1,VegasDialog_SlotUpdateDialog:-1,VegasPiggyBankDialog:-1,VegasMallTycoonLeadTeachDialog:-1,VegasDragonTeaserDialog:-1,PrimoChallengeDialog:-1,CollectionBookAwardDialog:-1,Slot_PurchasePackDialog_bankrupt_on_spin:-1,MP_LobbyBackDialog:-1,MP_FriendPartyMissionDialog:-1,MP_FriendPuzzleMissionDialog:-1,
MP_PurchasePackDialog_dailyMissionPlus:-1,MP_DailyMissionDialog:-1,MP_HighStakesMissionDialog:-1,MP_AvatarTaskDialog:-1,MP_AvatarDialog_potentialMajorPlayer:-1,MP_BattlePassStartDialog:-1,MP_VipChallengeDialog:-1,MP_AreaCompetePromoteDialog:-1,MP_PurchasePackDialog_findStar:-1,MP_FitnessTestDialog:-1,MP_TreasureBowlDialog:-1,MP_EncourageGoldDialog:-1,MP_PurchasePackDialog_billBanner:-1,MP_PurchasePackDialog_vipPromotion:-1,MP_PurchasePackDialog_fatedraw:-1,MP_PurchasePackDialog_slotFreeTicket:-1,
MP_PurchasePackDialog_slotWheel:-1,MP_PurchasePackDialog_goldHand:-1,MP_PurchasePackDialog_vipCasino:-1,MP_PurchasePackDialog_treasureboxNewbie:-1,MP_PurchasePackDialog_treasureboxVeteran:-1,MP_PurchasePackDialog_bonusMoney:-1,MP_PurchasePackDialog_fiveback:-1,MP_PurchasePackDialog_comeBack:-1,MP_PurchasePackDialog_highStakes:-1,MP_PurchasePackDialog_pinball:-1,MP_PurchasePackDialog_rightNow:-1,MP_PurchasePackDialog_gambling:-1,MP_PurchasePackDialog_doubleWin:-1,MP_PurchasePackDialog_oldPlayer:-1,
MP_PurchasePackDialog_sixTimesTree:-1,MP_PurchasePackDialog_goldCat:-1,MP_PurchasePackDialog_friend:-1,MP_PurchasePackDialog_bankruptSlot:-1,MP_PurchasePackDialog_fanBei:-1,MP_PurchasePromptDialog:-1,MP_PurchasePackDialog_newLife:-1,MP_PurchasePackDialog_firstpaynew:-1,MP_PurchasePackDialog_firstpayold:-1,MP_DragonTreasureDialog:-1,MP_LuckyChallengeDialog:-1,MP_VipInviteDialog:-1,MP_LobbyCouponDialog:-1,MP_RatingDialog:-1,MP_Dialog_GuildJoinSuccess:-1,MP_NewsWallDialog:-1,MP_PurchasePackDialog_dailySlotAgain:-1,
MP_CrystalMissionDialog:-1,MP_DailySlotDialog:-1,MP_AvatarDialog_dailyMoney:-1,MP_LuckyDrawLotsDialog:-1,MP_PurchasePackDialog_combatLevelPlus:-1,MP_CombatUpgradeDialog:-1,MP_LuckyBagDialog:-1,MP_LoserGiftGameDialog:-1,MP_GoldPigTeachDialog:-1,MP_GuildAutoJoinDialog:-1,MP_RegisterBaseDialog:-1,MP_DailyMissionWelcomeBackDialog:-1,MP_RichBackSMSDialog:-1,MP_LobbyUpgradeGiftDialog:-1,MP_NewbieGiftDialog:-1,MP_NewbieGiftGuideDialog:-1,MP_SurveyGiftDialog:-1,MP_LobbyNotifyDialog:-1,MP_AvatarDialog_NewPlayerGetMoney:-1,
MP_PurchasePackPluralDialog:-1,MP_ScratchCardViewDialog:-1,MP_GachaponAnimationDialog:-1,MP_GachaponRewardDialog:-1,MP_RoomDesktopDialog:-1,MP_LuckyWheelDialog:-1,MP_PurchaseBonusDialog:-1,Texas_LobbyBackDialog:-1,Texas_LobbyCoinAnimDialog:-1,Texas_LuckyMoneyDialog:-1,Texas_CardKingInviteDialog:-1,Texas_LotteryNotifyBannerDialog_WinWinLottery:-1,Texas_LotteryNotifyBannerDialog_BigLottery:-1,Texas_TurnTableDialog:-1,Texas_VegasChallengeInviteDialog:-1,Texas_ProfilePageHousekeeperTeachDialog:-1,Texas_GoldMedalTaskDialog:-1,
Texas_LimitIAPCouponDialog:-1,Texas_VipFreeGemDialog:-1,Texas_LobbyLuckyLoginDialog:-1,Texas_AreaCompeteAreaSelectDialog:-1,Texas_AreaCompeteCommonDialog:-1,Texas_DailySignInDialog:-1,Texas_PaybackMainDialog:-1,Texas_PurchasePackDialog_CouponSPBanner:-1,Texas_FortuneWheelLobbyDialog:-1,Texas_PurchasePackDialog_BonusMore:-1,Texas_PurchasePackDialog_LuckyPotPack:-1,Texas_PurchasePackDialog_ScratchSpecial:-1,Texas_PurchasePackDialog_DragonTigerBox:-1,Texas_PurchasePackDialog_TurnAroundPack:-1,Texas_PurchasePackDialog_TurnAroundPack2:-1,
Texas_TreasureBowlLimitTimeCouponDialog:-1,Texas_PurchasePackDialog_StrokeOfGenius:-1,Texas_PurchasePackDialog_LuckTime:-1,Texas_PurchasePackDialog_LuckTimeRoom:-1,Texas_PurchasePackDialog_Fight21:-1,Texas_PurchasePackDialog_Fight21Skin2:-1,Texas_PurchasePackDialog_FortuneWheel:-1,Texas_PurchasePackDialog_LifeEcpStore:-1,Texas_PurchasePackDialog_SciboGod:-1,Texas_PurchasePackDialog_FastPass:-1,Texas_FantasticBeastDialog:-1,Texas_PurchasePackDialog_VipCasino:-1,Texas_PurchasePackDialog_FortuneCat:-1,
Texas_PurchasePackDialog_LuckySupply:-1,Texas_PurchasePackDialog_PokeFun:-1,Texas_PurchasePackDialog_LuckySlotDiscount:-1,Texas_PurchasePackDialog_LadderRocket:-1,Texas_GemCurrencyLuckyDiscountDialog:-1,Texas_ScratchCardFreeUseDialog:-1,Texas_VipFreeGemRewardDialog:-1,Texas_PurchasePackDialog_LuckyScratch:-1,Texas_BingoHomeRunDialog:-1,Texas_PurchasePackDialog_FinalChoice:-1,Texas_PurchasePackDialog_TimeOffer:-1,Texas_PurchasePackDialog_Template:-1,Texas_PurchasePackDialog_FirstPay:-1,Texas_NewUserSendGemDialog:-1,
Texas_VipHolidayBonusDialog:-1,Texas_OldPlayersPaymentDialog:-1,Texas_PurchasePackDialog_NightOwl:-1,Texas_RPGLobbyChallengeFailureIntroDialog:-1,Texas_LimitedCouponDialog:-1,Texas_PurchasePackDialog_GameRankWeekendRush:-1,Texas_PurchasePackDialog_GameRankLevelUp:-1,Texas_ProfileDialog:-1,Texas_LadderChangeClassDialog:-1,Texas_GameRankLobbyFirstDialog:-1,Texas_NoMoneyDialog:-1,Texas_SimpleNoMoneyDialog:-1,Texas_ReturnWelfareDialog:-1,Texas_ReturnWelfareMissionDialog:-1,Texas_ReturnWelfareSignInDialog:-1,
Texas_ReturnWelfareCertificateDialog:-1,Texas_ReturnWelfareUIHelperDialog:-1,Texas_TreasuryDialog:-1,Texas_FreeChipDialog:-1,Texas_CompeteFinalDialog:-1,Texas_CompeteKOFinalDialog:-1,Texas_CompeteKOFinalEndDialog:-1,Texas_PurchaseBonusDialog:-1,LoginAnnounceDialog:-1,LoginServerDownDialog:-1,SelectGameRemindDialog:-1,SelectGameDownloadDialog:-1,Texas_Dialog_TexasDownloadFailDialog:-1,MP_Dialog_TexasDownloadFailDialog:-1,Fish_DownloadDialog:-1});DialogPriority.getPriority=function(dialog){var retValue=
-1;if(dialog){var value=priorityObject[dialog.key];if(value!==undefined)retValue=value}return retValue+1};DialogPriority.backupGetPriority=DialogPriority.getPriority})();var gaf=gaf||{};
(function(){gaf.DOWNLOAD_FILE_USE_HTTP=true;if(cc.sys.isNative)gaf.Asset=GAFAsset;gaf.create=function(gafFilePath,baseNode,fromCache,callback,errorCallback){var gafAsset;if(fromCache)gafAsset=GAFCustomAssetManager.createAsset(gafFilePath,null,baseNode);else gafAsset=gaf.Asset.create(gafFilePath,null,baseNode);if(gafAsset&&gafAsset.addEventListener){var onLoad=function(){callback&&callback(gafAsset);gafAsset.removeEventListener("loadError",onError)};var onError=function(){errorCallback&&errorCallback();
GAFCustomAssetManager.removeAsset(gafFilePath);gafAsset.removeEventListener("load",onLoad)};gafAsset.addEventListener("load",onLoad);gafAsset.addEventListener("loadError",onError)}else if(gafAsset||!errorCallback)callback&&callback(gafAsset);else errorCallback&&errorCallback();return gafAsset};gaf.createWithBundle=function(zipFilePath,entryFile,baseNode,fromCache,callback,errorCallback){var gafAsset;if(fromCache)gafAsset=GAFCustomAssetManager.createAssetWithBundle(zipFilePath,entryFile,null,baseNode);
else gafAsset=gaf.Asset.createWithBundle(zipFilePath,entryFile,null,baseNode);if(!gafAsset)cc.log(zipFilePath);if(gafAsset&&gafAsset.addEventListener){var onLoad=function(){callback(gafAsset);gafAsset.removeEventListener("loadError",onError)};var onError=function(){errorCallback&&errorCallback();GAFCustomAssetManager.removeAsset(zipFilePath);gafAsset.removeEventListener("load",onLoad)};gafAsset.addEventListener("load",onLoad);gafAsset.addEventListener("loadError",onError)}else if(gafAsset||!errorCallback)callback(gafAsset);
else errorCallback();return gafAsset};gaf.createAndDownloadWithBundle=function(url,zipFilePath,entryFile,baseNode,callback,errorCallback){if(cc.sys.isNative&&zipFilePath)if(jsb.fileUtils.isFileExist(zipFilePath))return gaf.createWithBundle(zipFilePath,entryFile,baseNode,true,callback,errorCallback);else{var fileName=zipFilePath.replace(JSWriteablePath,"");var isInApp=jsb.fileUtils.isFileExist(fileName);if(isInApp)if(cc.sys.os===cc.sys.OS_IOS)return gaf.createWithBundle(fileName,entryFile,baseNode,
true,callback,errorCallback);else{var gafData=jsb.fileUtils.getDataFromFile(fileName);var targetArr=zipFilePath.split("/");var filename=targetArr.pop();var directoryPath=targetArr.join("/");if(!jsb.fileUtils.isDirectoryExist(directoryPath))jsb.fileUtils.createDirectory(directoryPath);var success=jsb.fileUtils.writeDataToFile(gafData,zipFilePath);if(success)return gaf.createWithBundle(zipFilePath,entryFile,baseNode,true,callback,errorCallback)}var downloaderCallback=new GSDownloaderCallback(this);
downloaderCallback.onTaskSuccess=function(){gaf.createWithBundle(zipFilePath,entryFile,baseNode,true,callback,errorCallback)};downloaderCallback.onTaskError=function(task,errorCode,errorCodeInternal,errorStr){jsb.fileUtils.removeFile(zipFilePath);if(errorCallback)errorCallback();else callback(null)};GSDownloaderManager.addDownloader(url,zipFilePath,null,downloaderCallback,gaf.DOWNLOAD_FILE_USE_HTTP)}else return gaf.createWithBundle(url,entryFile,baseNode,true,callback,errorCallback)};gaf.createAndMultiDomainDownloadWithBundle=
function(domainList,url,zipFilePath,entryFile,baseNode,callback,errorCallback){if(cc.sys.isNative&&zipFilePath)if(jsb.fileUtils.isFileExist(zipFilePath))return gaf.createWithBundle(zipFilePath,entryFile,baseNode,true,callback,errorCallback);else{var fileName=zipFilePath.replace(JSWriteablePath,"");var isInApp=jsb.fileUtils.isFileExist(fileName);if(isInApp)if(cc.sys.os===cc.sys.OS_IOS)return gaf.createWithBundle(fileName,entryFile,baseNode,true,callback,errorCallback);else{var gafData=jsb.fileUtils.getDataFromFile(fileName);
var targetArr=zipFilePath.split("/");var filename=targetArr.pop();var directoryPath=targetArr.join("/");if(!jsb.fileUtils.isDirectoryExist(directoryPath))jsb.fileUtils.createDirectory(directoryPath);var success=jsb.fileUtils.writeDataToFile(gafData,zipFilePath);if(success)return gaf.createWithBundle(zipFilePath,entryFile,baseNode,true,callback,errorCallback)}var downloaderCallback=new GSDownloaderCallback(this);downloaderCallback.onTaskSuccess=task=>{gaf.createWithBundle(zipFilePath,entryFile,baseNode,
true,callback,errorCallback)};downloaderCallback.onTaskError=(task,errorCode,errorCodeInternal,errorStr)=>{jsb.fileUtils.removeFile(zipFilePath);if(errorCallback)errorCallback();else callback(null)};GSDownloaderManager.downloadWithMultiDomain(domainList,url,zipFilePath,downloaderCallback)}else return gaf.createWithBundle(GS.httpScheme+"//"+domainList[0]+url,entryFile,baseNode,true,callback,errorCallback)}}).call(window||module||{});var GAFCustomAssetManager=cc.sys.isNative?GAFCustomAssetManager:null;
(function(){if(cc.sys.isNative)return;const CHECK_REF_TIME=12;var instance=null;GAFCustomAssetManager=cc.Class.extend({ctor:function(){this._assetMap={};setInterval(_=>{var assetMap=this._assetMap;for(var key in assetMap){var assetObj=assetMap[key];if(gaf.gafAssetObject[assetObj.filePath]==1){assetObj.reduceAssetRefCount();delete assetMap[key]}}},CHECK_REF_TIME*1E3)},getAsset:function(gafFilePath,delegate,baseNode){var retAsset=this._assetMap[gafFilePath];if(!retAsset){retAsset=gaf.Asset.create(gafFilePath,
delegate,baseNode);this._assetMap[gafFilePath]=retAsset}else if(baseNode){var destroyNode=baseNode.getChildByName("GAFDestroyNode");if(!destroyNode){destroyNode=new GAFDestroyNode;baseNode.addChild(destroyNode)}destroyNode.addAssetDestroyCallback(function(){retAsset.reduceAssetRefCount()})}else cc.assert(0,"GAFAsset\u9700\u8981Node\u50b3\u9032\u4f86\u7528\u4f86\u4e4b\u5f8crelease");retAsset.addAssetRefCount();return retAsset},getAssetWithBundle:function(zipFilePath,entryFile,delegate,baseNode){var retAsset=
this._assetMap[zipFilePath];if(!retAsset){retAsset=gaf.Asset.createWithBundle(zipFilePath,entryFile,delegate,baseNode);this._assetMap[zipFilePath]=retAsset}else if(baseNode){var destroyNode=baseNode.getChildByName("GAFDestroyNode");if(!destroyNode){destroyNode=new GAFDestroyNode;baseNode.addChild(destroyNode)}destroyNode.addAssetDestroyCallback(function(){retAsset.reduceAssetRefCount()})}else cc.assert(0,"GAFAsset\u9700\u8981Node\u50b3\u9032\u4f86\u7528\u4f86\u4e4b\u5f8crelease");retAsset.addAssetRefCount();
return retAsset},removeAsset:function(filePath){var retAsset=this._assetMap[filePath];if(retAsset){retAsset.reduceAssetRefCount();delete this._assetMap[filePath]}}});GAFCustomAssetManager.getInstance=function(){if(instance==null)instance=new GAFCustomAssetManager;return instance};GAFCustomAssetManager.createAsset=function(gafFilePath,delegate,baseNode){return GAFCustomAssetManager.getInstance().getAsset(gafFilePath,delegate,baseNode)};GAFCustomAssetManager.createAssetWithBundle=function(zipFilePath,
entryFile,delegate,baseNode){return GAFCustomAssetManager.getInstance().getAssetWithBundle(zipFilePath,entryFile,delegate,baseNode)};GAFCustomAssetManager.removeAsset=function(filePath){GAFCustomAssetManager.getInstance().removeAsset(filePath)}}).call(window||module||{});/*
 MIT License. Copyright 2015-2018 Richard Moore <me@ricmoo.com>. See LICENSE.txt. */
(function(root){function checkInt(value){return parseInt(value)===value}function checkInts(arrayish){if(!checkInt(arrayish.length))return false;for(var i=0;i<arrayish.length;i++)if(!checkInt(arrayish[i])||arrayish[i]<0||arrayish[i]>255)return false;return true}function coerceArray(arg,copy){if(arg.buffer&&arg.name==="Uint8Array"){if(copy)if(arg.slice)arg=arg.slice();else arg=Array.prototype.slice.call(arg);return arg}if(Array.isArray(arg)){if(!checkInts(arg))throw new Error("Array contains invalid value: "+
arg);return new Uint8Array(arg)}if(checkInt(arg.length)&&checkInts(arg))return new Uint8Array(arg);throw new Error("unsupported array-like object");}function createArray(length){return new Uint8Array(length)}function copyArray(sourceArray,targetArray,targetStart,sourceStart,sourceEnd){if(sourceStart!=null||sourceEnd!=null)if(sourceArray.slice)sourceArray=sourceArray.slice(sourceStart,sourceEnd);else sourceArray=Array.prototype.slice.call(sourceArray,sourceStart,sourceEnd);targetArray.set(sourceArray,
targetStart)}var convertUtf8=function(){function toBytes(text){var result=[],i=0;text=encodeURI(text);while(i<text.length){var c=text.charCodeAt(i++);if(c===37){result.push(parseInt(text.substr(i,2),16));i+=2}else result.push(c)}return coerceArray(result)}function fromBytes(bytes){var result=[],i=0;while(i<bytes.length){var c=bytes[i];if(c<128){result.push(String.fromCharCode(c));i++}else if(c>191&&c<224){result.push(String.fromCharCode((c&31)<<6|bytes[i+1]&63));i+=2}else{result.push(String.fromCharCode((c&
15)<<12|(bytes[i+1]&63)<<6|bytes[i+2]&63));i+=3}}return result.join("")}return{toBytes:toBytes,fromBytes:fromBytes}}();var convertHex=function(){function toBytes(text){var result=[];for(var i=0;i<text.length;i+=2)result.push(parseInt(text.substr(i,2),16));return result}var Hex="0123456789abcdef";function fromBytes(bytes){var result=[];for(var i=0;i<bytes.length;i++){var v=bytes[i];result.push(Hex[(v&240)>>4]+Hex[v&15])}return result.join("")}return{toBytes:toBytes,fromBytes:fromBytes}}();var numberOfRounds=
{16:10,24:12,32:14};var rcon=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145];var S=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,
77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,
137,13,191,230,66,104,65,153,45,15,176,84,187,22];var Si=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,
19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125];var T1=[3328402341,4168907908,
4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,
134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,
3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,
3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,
1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,
2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986];var T2=[2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,
3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940642008,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,
1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,
1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,
1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,
2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766];var T3=[1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,
1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,
2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,
1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110742005,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,
577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,
779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,
2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126];var T4=[1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,
3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,
1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,
3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,
2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,
488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436];var T5=[1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,
1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,
3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,
908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,
294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,
4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,
967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890];var T6=[1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,
1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,
91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,
3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,
1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,
2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935];var T7=[2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,
459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239E3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,
472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,
1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,
1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,
4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,
1551124588,1463996600];var T8=[4104605777,1097159550,396673818,660510266,2875968315,2638606623,4200115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,
1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998E3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,
3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,
3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,
2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,
4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480];var U1=[0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,
2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,
2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,
3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,
2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,
875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795];var U2=[0,185469197,370938394,
487725847,741876788,657861945,975451694,824852259,1483753576,1400783205,1315723890,1164071807,1950903388,2135319889,1649704518,1767536459,2967507152,3152976349,2801566410,2918353863,2631447780,2547432937,2328143614,2177544179,3901806776,3818836405,4270639778,4118987695,3299409036,3483825537,3535072918,3652904859,2077965243,1893020342,1841768865,1724457132,1474502543,1559041666,1107234197,1257309336,598438867,681933534,901210569,1052338372,261314535,77422314,428819965,310463728,3409685355,3224740454,
3710368113,3593056380,3875770207,3960309330,4045380933,4195456072,2471224067,2554718734,2237133081,2388260884,3212035895,3028143674,2842678573,2724322336,4138563181,4255350624,3769721975,3955191162,3667219033,3516619604,3431546947,3347532110,2933734917,2782082824,3099667487,3016697106,2196052529,2313884476,2499348523,2683765030,1179510461,1296297904,1347548327,1533017514,1786102409,1635502980,2087309459,2003294622,507358933,355706840,136428751,53458370,839224033,957055980,605657339,790073846,2373340630,
2256028891,2607439820,2422494913,2706270690,2856345839,3075636216,3160175349,3573941694,3725069491,3273267108,3356761769,4181598602,4063242375,4011996048,3828103837,1033297158,915985419,730517276,545572369,296679730,446754879,129166120,213705253,1709610350,1860738147,1945798516,2029293177,1239331162,1120974935,1606591296,1422699085,4148292826,4233094615,3781033664,3931371469,3682191598,3497509347,3446004468,3328955385,2939266226,2755636671,3106780840,2988687269,2198438022,2282195339,2501218972,2652609425,
1201765386,1286567175,1371368976,1521706781,1805211710,1620529459,2105887268,1988838185,533804130,350174575,164439672,46346101,870912086,954669403,636813900,788204353,2358957921,2274680428,2592523643,2441661558,2695033685,2880240216,3065962831,3182487618,3572145929,3756299780,3270937875,3388507166,4174560061,4091327024,4006521127,3854606378,1014646705,930369212,711349675,560487590,272786309,457992840,106852767,223377554,1678381017,1862534868,1914052035,2031621326,1211247597,1128014560,1580087799,
1428173050,32283319,182621114,401639597,486441376,768917123,651868046,1003007129,818324884,1503449823,1385356242,1333838021,1150208456,1973745387,2125135846,1673061617,1756818940,2970356327,3120694122,2802849917,2887651696,2637442643,2520393566,2334669897,2149987652,3917234703,3799141122,4284502037,4100872472,3309594171,3460984630,3545789473,3629546796,2050466060,1899603969,1814803222,1730525723,1443857720,1560382517,1075025698,1260232239,575138148,692707433,878443390,1062597235,243256656,91341917,
409198410,325965383,3403100636,3252238545,3704300486,3620022987,3874428392,3990953189,4042459122,4227665663,2460449204,2578018489,2226875310,2411029155,3198115200,3046200461,2827177882,2743944855];var U3=[0,218828297,437656594,387781147,875313188,958871085,775562294,590424639,1750626376,1699970625,1917742170,2135253587,1551124588,1367295589,1180849278,1265195639,3501252752,3720081049,3399941250,3350065803,3835484340,3919042237,4270507174,4085369519,3102249176,3051593425,2734591178,2952102595,2361698556,
2177869557,2530391278,2614737639,3145456443,3060847922,2708326185,2892417312,2404901663,2187128086,2504130317,2555048196,3542330227,3727205754,3375740769,3292445032,3876557655,3926170974,4246310725,4027744588,1808481195,1723872674,1910319033,2094410160,1608975247,1391201670,1173430173,1224348052,59984867,244860394,428169201,344873464,935293895,984907214,766078933,547512796,1844882806,1627235199,2011214180,2062270317,1507497298,1423022939,1137477952,1321699145,95345982,145085239,532201772,313773861,
830661914,1015671571,731183368,648017665,3175501286,2957853679,2807058932,2858115069,2305455554,2220981195,2474404304,2658625497,3575528878,3625268135,3473416636,3254988725,3778151818,3963161475,4213447064,4130281361,3599595085,3683022916,3432737375,3247465558,3802222185,4020912224,4172763771,4122762354,3201631749,3017672716,2764249623,2848461854,2331590177,2280796200,2431590963,2648976442,104699613,188127444,472615631,287343814,840019705,1058709744,671593195,621591778,1852171925,1668212892,1953757831,
2037970062,1514790577,1463996600,1080017571,1297403050,3673637356,3623636965,3235995134,3454686199,4007360968,3822090177,4107101658,4190530515,2997825956,3215212461,2830708150,2779915199,2256734592,2340947849,2627016082,2443058075,172466556,122466165,273792366,492483431,1047239E3,861968209,612205898,695634755,1646252340,1863638845,2013908262,1963115311,1446242576,1530455833,1277555970,1093597963,1636604631,1820824798,2073724613,1989249228,1436590835,1487645946,1337376481,1119727848,164948639,81781910,
331544205,516552836,1039717051,821288114,669961897,719700128,2973530695,3157750862,2871682645,2787207260,2232435299,2283490410,2667994737,2450346104,3647212047,3564045318,3279033885,3464042516,3980931627,3762502690,4150144569,4199882800,3070356634,3121275539,2904027272,2686254721,2200818878,2384911031,2570832044,2486224549,3747192018,3528626907,3310321856,3359936201,3950355702,3867060991,4049844452,4234721005,1739656202,1790575107,2108100632,1890328081,1402811438,1586903591,1233856572,1149249077,
266959938,48394827,369057872,418672217,1002783846,919489135,567498868,752375421,209336225,24197544,376187827,459744698,945164165,895287692,574624663,793451934,1679968233,1764313568,2117360635,1933530610,1343127501,1560637892,1243112415,1192455638,3704280881,3519142200,3336358691,3419915562,3907448597,3857572124,4075877127,4294704398,3029510009,3113855344,2927934315,2744104290,2159976285,2377486676,2594734927,2544078150];var U4=[0,151849742,303699484,454499602,607398968,758720310,908999204,1059270954,
1214797936,1097159550,1517440620,1400849762,1817998408,1699839814,2118541908,2001430874,2429595872,2581445614,2194319100,2345119218,3034881240,3186202582,2801699524,2951971274,3635996816,3518358430,3399679628,3283088770,4237083816,4118925222,4002861748,3885750714,1002142683,850817237,698445255,548169417,529487843,377642221,227885567,77089521,1943217067,2061379749,1640576439,1757691577,1474760595,1592394909,1174215055,1290801793,2875968315,2724642869,3111247143,2960971305,2405426947,2253581325,2638606623,
2487810577,3808662347,3926825029,4044981591,4162096729,3342319475,3459953789,3576539503,3693126241,1986918061,2137062819,1685577905,1836772287,1381620373,1532285339,1078185097,1229899655,1040559837,923313619,740276417,621982671,439452389,322734571,137073913,19308535,3871163981,4021308739,4104605777,4255800159,3263785589,3414450555,3499326569,3651041127,2933202493,2815956275,3167684641,3049390895,2330014213,2213296395,2566595609,2448830231,1305906550,1155237496,1607244650,1455525988,1776460110,1626319424,
2079897426,1928707164,96392454,213114376,396673818,514443284,562755902,679998E3,865136418,983426092,3708173718,3557504664,3474729866,3323011204,4180808110,4030667424,3945269170,3794078908,2507040230,2623762152,2272556026,2390325492,2975484382,3092726480,2738905026,2857194700,3973773121,3856137295,4274053469,4157467219,3371096953,3252932727,3673476453,3556361835,2763173681,2915017791,3064510765,3215307299,2156299017,2307622919,2459735317,2610011675,2081048481,1963412655,1846563261,1729977011,1480485785,
1362321559,1243905413,1126790795,878845905,1030690015,645401037,796197571,274084841,425408743,38544885,188821243,3613494426,3731654548,3313212038,3430322568,4082475170,4200115116,3780097726,3896688048,2668221674,2516901860,2366882550,2216610296,3141400786,2989552604,2837966542,2687165888,1202797690,1320957812,1437280870,1554391400,1669664834,1787304780,1906247262,2022837584,265905162,114585348,499347990,349075736,736970802,585122620,972512814,821712160,2595684844,2478443234,2293045232,2174754046,
3196267988,3079546586,2895723464,2777952454,3537852828,3687994002,3234156416,3385345166,4142626212,4293295786,3841024952,3992742070,174567692,57326082,410887952,292596766,777231668,660510266,1011452712,893681702,1108339068,1258480242,1343618912,1494807662,1715193156,1865862730,1948373848,2100090966,2701949495,2818666809,3004591147,3122358053,2235061775,2352307457,2535604243,2653899549,3915653703,3764988233,4219352155,4067639125,3444575871,3294430577,3746175075,3594982253,836553431,953270745,600235211,
718002117,367585007,484830689,133361907,251657213,2041877159,1891211689,1806599355,1654886325,1568718495,1418573201,1335535747,1184342925];function convertToInt32(bytes){var result=[];for(var i=0;i<bytes.length;i+=4)result.push(bytes[i]<<24|bytes[i+1]<<16|bytes[i+2]<<8|bytes[i+3]);return result}var AES=function(key){if(!(this instanceof AES))throw Error("AES must be instanitated with `new`");Object.defineProperty(this,"key",{value:coerceArray(key,true)});this._prepare()};AES.prototype._prepare=function(){var rounds=
numberOfRounds[this.key.length];if(rounds==null)throw new Error("invalid key size (must be 16, 24 or 32 bytes)");this._Ke=[];this._Kd=[];for(var i=0;i<=rounds;i++){this._Ke.push([0,0,0,0]);this._Kd.push([0,0,0,0])}var roundKeyCount=(rounds+1)*4;var KC=this.key.length/4;var tk=convertToInt32(this.key);var index;for(var i=0;i<KC;i++){index=i>>2;this._Ke[index][i%4]=tk[i];this._Kd[rounds-index][i%4]=tk[i]}var rconpointer=0;var t=KC,tt;while(t<roundKeyCount){tt=tk[KC-1];tk[0]^=S[tt>>16&255]<<24^S[tt>>
8&255]<<16^S[tt&255]<<8^S[tt>>24&255]^rcon[rconpointer]<<24;rconpointer+=1;if(KC!=8)for(var i=1;i<KC;i++)tk[i]^=tk[i-1];else{for(var i=1;i<KC/2;i++)tk[i]^=tk[i-1];tt=tk[KC/2-1];tk[KC/2]^=S[tt&255]^S[tt>>8&255]<<8^S[tt>>16&255]<<16^S[tt>>24&255]<<24;for(var i=KC/2+1;i<KC;i++)tk[i]^=tk[i-1]}var i=0,r,c;while(i<KC&&t<roundKeyCount){r=t>>2;c=t%4;this._Ke[r][c]=tk[i];this._Kd[rounds-r][c]=tk[i++];t++}}for(var r=1;r<rounds;r++)for(var c=0;c<4;c++){tt=this._Kd[r][c];this._Kd[r][c]=U1[tt>>24&255]^U2[tt>>
16&255]^U3[tt>>8&255]^U4[tt&255]}};AES.prototype.encrypt=function(plaintext){if(plaintext.length!=16)throw new Error("invalid plaintext size (must be 16 bytes)");var rounds=this._Ke.length-1;var a=[0,0,0,0];var t=convertToInt32(plaintext);for(var i=0;i<4;i++)t[i]^=this._Ke[0][i];for(var r=1;r<rounds;r++){for(var i=0;i<4;i++)a[i]=T1[t[i]>>24&255]^T2[t[(i+1)%4]>>16&255]^T3[t[(i+2)%4]>>8&255]^T4[t[(i+3)%4]&255]^this._Ke[r][i];t=a.slice()}var result=createArray(16),tt;for(var i=0;i<4;i++){tt=this._Ke[rounds][i];
result[4*i]=(S[t[i]>>24&255]^tt>>24)&255;result[4*i+1]=(S[t[(i+1)%4]>>16&255]^tt>>16)&255;result[4*i+2]=(S[t[(i+2)%4]>>8&255]^tt>>8)&255;result[4*i+3]=(S[t[(i+3)%4]&255]^tt)&255}return result};AES.prototype.decrypt=function(ciphertext){if(ciphertext.length!=16)throw new Error("invalid ciphertext size (must be 16 bytes)");var rounds=this._Kd.length-1;var a=[0,0,0,0];var t=convertToInt32(ciphertext);for(var i=0;i<4;i++)t[i]^=this._Kd[0][i];for(var r=1;r<rounds;r++){for(var i=0;i<4;i++)a[i]=T5[t[i]>>
24&255]^T6[t[(i+3)%4]>>16&255]^T7[t[(i+2)%4]>>8&255]^T8[t[(i+1)%4]&255]^this._Kd[r][i];t=a.slice()}var result=createArray(16),tt;for(var i=0;i<4;i++){tt=this._Kd[rounds][i];result[4*i]=(Si[t[i]>>24&255]^tt>>24)&255;result[4*i+1]=(Si[t[(i+3)%4]>>16&255]^tt>>16)&255;result[4*i+2]=(Si[t[(i+2)%4]>>8&255]^tt>>8)&255;result[4*i+3]=(Si[t[(i+1)%4]&255]^tt)&255}return result};var ModeOfOperationECB=function(key){if(!(this instanceof ModeOfOperationECB))throw Error("AES must be instanitated with `new`");this.description=
"Electronic Code Block";this.name="ecb";this._aes=new AES(key)};ModeOfOperationECB.prototype.encrypt=function(plaintext){plaintext=coerceArray(plaintext);if(plaintext.length%16!==0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");var ciphertext=createArray(plaintext.length);var block=createArray(16);for(var i=0;i<plaintext.length;i+=16){copyArray(plaintext,block,0,i,i+16);block=this._aes.encrypt(block);copyArray(block,ciphertext,i)}return ciphertext};ModeOfOperationECB.prototype.decrypt=
function(ciphertext){ciphertext=coerceArray(ciphertext);if(ciphertext.length%16!==0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");var plaintext=createArray(ciphertext.length);var block=createArray(16);for(var i=0;i<ciphertext.length;i+=16){copyArray(ciphertext,block,0,i,i+16);block=this._aes.decrypt(block);copyArray(block,plaintext,i)}return plaintext};var ModeOfOperationCBC=function(key,iv){if(!(this instanceof ModeOfOperationCBC))throw Error("AES must be instanitated with `new`");
this.description="Cipher Block Chaining";this.name="cbc";if(!iv)iv=createArray(16);else if(iv.length!=16)throw new Error("invalid initialation vector size (must be 16 bytes)");this._lastCipherblock=coerceArray(iv,true);this._aes=new AES(key)};ModeOfOperationCBC.prototype.encrypt=function(plaintext){plaintext=coerceArray(plaintext);if(plaintext.length%16!==0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");var ciphertext=createArray(plaintext.length);var block=createArray(16);
for(var i=0;i<plaintext.length;i+=16){copyArray(plaintext,block,0,i,i+16);for(var j=0;j<16;j++)block[j]^=this._lastCipherblock[j];this._lastCipherblock=this._aes.encrypt(block);copyArray(this._lastCipherblock,ciphertext,i)}return ciphertext};ModeOfOperationCBC.prototype.decrypt=function(ciphertext){ciphertext=coerceArray(ciphertext);if(ciphertext.length%16!==0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");var plaintext=createArray(ciphertext.length);var block=createArray(16);
for(var i=0;i<ciphertext.length;i+=16){copyArray(ciphertext,block,0,i,i+16);block=this._aes.decrypt(block);for(var j=0;j<16;j++)plaintext[i+j]=block[j]^this._lastCipherblock[j];copyArray(ciphertext,this._lastCipherblock,0,i,i+16)}return plaintext};var ModeOfOperationCFB=function(key,iv,segmentSize){if(!(this instanceof ModeOfOperationCFB))throw Error("AES must be instanitated with `new`");this.description="Cipher Feedback";this.name="cfb";if(!iv)iv=createArray(16);else if(iv.length!=16)throw new Error("invalid initialation vector size (must be 16 size)");
if(!segmentSize)segmentSize=1;this.segmentSize=segmentSize;this._shiftRegister=coerceArray(iv,true);this._aes=new AES(key)};ModeOfOperationCFB.prototype.encrypt=function(plaintext){if(plaintext.length%this.segmentSize!=0)throw new Error("invalid plaintext size (must be segmentSize bytes)");var encrypted=coerceArray(plaintext,true);var xorSegment;for(var i=0;i<encrypted.length;i+=this.segmentSize){xorSegment=this._aes.encrypt(this._shiftRegister);for(var j=0;j<this.segmentSize;j++)encrypted[i+j]^=
xorSegment[j];copyArray(this._shiftRegister,this._shiftRegister,0,this.segmentSize);copyArray(encrypted,this._shiftRegister,16-this.segmentSize,i,i+this.segmentSize)}return encrypted};ModeOfOperationCFB.prototype.decrypt=function(ciphertext){if(ciphertext.length%this.segmentSize!=0)throw new Error("invalid ciphertext size (must be segmentSize bytes)");var plaintext=coerceArray(ciphertext,true);var xorSegment;for(var i=0;i<plaintext.length;i+=this.segmentSize){xorSegment=this._aes.encrypt(this._shiftRegister);
for(var j=0;j<this.segmentSize;j++)plaintext[i+j]^=xorSegment[j];copyArray(this._shiftRegister,this._shiftRegister,0,this.segmentSize);copyArray(ciphertext,this._shiftRegister,16-this.segmentSize,i,i+this.segmentSize)}return plaintext};var ModeOfOperationOFB=function(key,iv){if(!(this instanceof ModeOfOperationOFB))throw Error("AES must be instanitated with `new`");this.description="Output Feedback";this.name="ofb";if(!iv)iv=createArray(16);else if(iv.length!=16)throw new Error("invalid initialation vector size (must be 16 bytes)");
this._lastPrecipher=coerceArray(iv,true);this._lastPrecipherIndex=16;this._aes=new AES(key)};ModeOfOperationOFB.prototype.encrypt=function(plaintext){var encrypted=coerceArray(plaintext,true);for(var i=0;i<encrypted.length;i++){if(this._lastPrecipherIndex===16){this._lastPrecipher=this._aes.encrypt(this._lastPrecipher);this._lastPrecipherIndex=0}encrypted[i]^=this._lastPrecipher[this._lastPrecipherIndex++]}return encrypted};ModeOfOperationOFB.prototype.decrypt=ModeOfOperationOFB.prototype.encrypt;
var Counter=function(initialValue){if(!(this instanceof Counter))throw Error("Counter must be instanitated with `new`");if(initialValue!==0&&!initialValue)initialValue=1;if(typeof initialValue==="number"){this._counter=createArray(16);this.setValue(initialValue)}else this.setBytes(initialValue)};Counter.prototype.setValue=function(value){if(typeof value!=="number"||parseInt(value)!=value)throw new Error("invalid counter value (must be an integer)");if(value>Number.MAX_SAFE_INTEGER)throw new Error("integer value out of safe range");
for(var index=15;index>=0;--index){this._counter[index]=value%256;value=parseInt(value/256)}};Counter.prototype.setBytes=function(bytes){bytes=coerceArray(bytes,true);if(bytes.length!=16)throw new Error("invalid counter bytes size (must be 16 bytes)");this._counter=bytes};Counter.prototype.increment=function(){for(var i=15;i>=0;i--)if(this._counter[i]===255)this._counter[i]=0;else{this._counter[i]++;break}};var ModeOfOperationCTR=function(key,counter){if(!(this instanceof ModeOfOperationCTR))throw Error("AES must be instanitated with `new`");
this.description="Counter";this.name="ctr";if(!(counter instanceof Counter))counter=new Counter(counter);this._counter=counter;this._remainingCounter=null;this._remainingCounterIndex=16;this._aes=new AES(key)};ModeOfOperationCTR.prototype.encrypt=function(plaintext){var encrypted=coerceArray(plaintext,true);for(var i=0;i<encrypted.length;i++){if(this._remainingCounterIndex===16){this._remainingCounter=this._aes.encrypt(this._counter._counter);this._remainingCounterIndex=0;this._counter.increment()}encrypted[i]^=
this._remainingCounter[this._remainingCounterIndex++]}return encrypted};ModeOfOperationCTR.prototype.decrypt=ModeOfOperationCTR.prototype.encrypt;function pkcs7pad(data){data=coerceArray(data,true);var padder=16-data.length%16;var result=createArray(data.length+padder);copyArray(data,result);for(var i=data.length;i<result.length;i++)result[i]=padder;return result}function pkcs7strip(data){data=coerceArray(data,true);if(data.length<16)throw new Error("PKCS#7 invalid length");var padder=data[data.length-
1];if(padder>16)throw new Error("PKCS#7 padding byte out of range");var length=data.length-padder;for(var i=0;i<padder;i++)if(data[length+i]!==padder)throw new Error("PKCS#7 invalid padding byte");var result=createArray(length);copyArray(data,result,0,0,length);return result}var aesjs={AES:AES,Counter:Counter,ModeOfOperation:{ecb:ModeOfOperationECB,cbc:ModeOfOperationCBC,cfb:ModeOfOperationCFB,ofb:ModeOfOperationOFB,ctr:ModeOfOperationCTR},utils:{hex:convertHex,utf8:convertUtf8},padding:{pkcs7:{pad:pkcs7pad,
strip:pkcs7strip}},_arrayTest:{coerceArray:coerceArray,createArray:createArray,copyArray:copyArray}};if(typeof exports!=="undefined")module.exports=aesjs;else if(typeof define==="function"&&define.amd)define([],function(){return aesjs});else{if(root.aesjs)aesjs._aesjs=root.aesjs;root.aesjs=aesjs}})(window||module||{});var GSCrypto={};
(function(){var key_256="YQ1BSZ2fdhKf01JfAvVxEhDQr9mJ3R5M".split("").map(s=>s.charCodeAt());var randomList="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split("");var getRandomString=function(length){var retString="";for(var i=0;i<length;i++)retString+=randomList[JSCodeUtility.getRandomInt(0,61)];return retString};GSCrypto.getAES256EncryptString=function(input){if(input.substr(input.length-1)==="\n")input=input.substr(0,input.length-1);var salt1=getRandomString(4);var salt2=getRandomString(4);
var ivString=getRandomString(16);var plainText=JSStringUtility.format("%d,%s%s%s",input.length,salt1,input,salt2);var nowLen=plainText.length%16;if(nowLen>0)for(var i=0;i<16-nowLen;i++)plainText+="\x00";var textBytes=aesjs.utils.utf8.toBytes(plainText);var aesCbc=new aesjs.ModeOfOperation.cbc(key_256,ivString.split("").map(s=>s.charCodeAt()));var encryptedBytes=aesCbc.encrypt(textBytes);return ivString+btoa(String.fromCharCode.apply(null,encryptedBytes))};GSCrypto.getAES256DecryptString=function(input){var ivString=
input.substr(0,16);input=input.substr(16);var encryptedBytes=atob(input).split("").map(s=>s.charCodeAt());var aesCbc=new aesjs.ModeOfOperation.cbc(key_256,ivString.split("").map(s=>s.charCodeAt()));var decryptedBytes=aesCbc.decrypt(encryptedBytes);var decryptedText=aesjs.utils.utf8.fromBytes(decryptedBytes);var lenString=decryptedText.split(",")[0];var plainString=decryptedText.substr(lenString.length+1);return plainString.substr(4,parseInt(lenString,10))}})();var GSDownloaderManager={};var GSDownloaderCallback=function(context){this.context=context;this.onTaskProgress=function(task,bytesReceived,totalBytesReceived,totalBytesExpected){};this.onTaskSuccess=function(task){};this.onTaskError=function(task,errorCode,errorCodeInternal,errorStr){}};
(function(){var downloaderObjects=[];var maxDownloadCount=10;var DownloaderClass=function(url,savePath,identifier,callback,useHttpDownloader=true){this.url=url;this._savePath=savePath;this._identifier=identifier;this.downloaderCallbackArray=[callback];this.isDownloading=false;this.start=()=>{this.isDownloading=true;var urlCheckList=this.url.split("://");if(!urlCheckList[1]||!urlCheckList[0]){cc.log("\u539f\u751f\u4e0b\u8f09 \u932f\u8aa4\u7684\u7db2\u5740\u683c\u5f0f: %s",this.url);this.downloaderCallbackArray.forEach(cur=>
{var errorCode=-4;cur&&cur.onTaskError&&cur.onTaskError(null,errorCode,0,"\u932f\u8aa4\u7684\u7db2\u5740\u683c\u5f0f")});GSDownloaderManager.removeDownloaderByUrl(this.url);return}if(this._savePath){var targetArr=this._savePath.split("/");var filename=targetArr.pop();var directoryPath=targetArr.join("/");if(!jsb.fileUtils.isDirectoryExist(directoryPath))jsb.fileUtils.createDirectory(directoryPath)}cc.log("\u539f\u751f\u4e0b\u8f09\u4e2d url = %s",this.url);if(false&&useHttpDownloader)GSHttpDownloader.startDownload(this.url,
this._savePath||"",(success,errorCode)=>{if(success){cc.log("\u539f\u751f\u4e0b\u8f09\u6210\u529f url = "+this.url);GSDownloaderManager.removeDownloaderByUrl(this.url);try{this.downloaderCallbackArray.forEach(cur=>{try{cur.onTaskSuccess&&cur.onTaskSuccess(null)}catch(e){cc.log("\u539f\u751f\u4e0b\u8f09 onTaskSuccess error: "+e)}})}catch(e){cc.log("\u539f\u751f\u4e0b\u8f09\u6210\u529f Callback error: "+e)}}else{cc.log("\u539f\u751f\u4e0b\u8f09\u5931\u6557 url = %s errorCode = %d",this.url,errorCode);
GSDownloaderManager.removeDownloaderByUrl(this.url);try{this.downloaderCallbackArray.forEach(cur=>{try{cur.onTaskError&&cur.onTaskError(null,errorCode,0,"")}catch(e){cc.log("\u539f\u751f\u4e0b\u8f09 onTaskError error: "+e)}})}catch(e){cc.log("\u539f\u751f\u4e0b\u8f09\u5931\u6557Callback error: "+e)}}});else{if(this.url.length===0||this._savePath.length===0){cc.log("DownloaderClass \u539f\u751f\u4e0b\u8f09\u7f3a\u5c11 url or savePath. url: %s, savePath: %s",this.url,savePath);this.downloaderCallbackArray.forEach(cur=>
{var errorCode=-4;cur&&cur.onTaskError&&cur.onTaskError(null,errorCode,0,"URL or storage path is empty.")});GSDownloaderManager.removeDownloaderByUrl(this.url);return}var downloader=new jsb.Downloader;downloader.setOnTaskProgress((task,bytesReceived,totalBytesReceived,totalBytesExpected)=>{this.downloaderCallbackArray.forEach(cur=>{try{cur&&cur.onTaskProgress&&cur.onTaskProgress(task,bytesReceived,totalBytesReceived,totalBytesExpected)}catch(e){cc.log("\u539f\u751f\u4e0b\u8f09 onTaskProgress error: "+
e)}})});downloader.setOnFileTaskSuccess(task=>{cc.log("\u539f\u751f\u4e0b\u8f09\u6210\u529f url = "+this.url);this.downloaderCallbackArray.forEach(cur=>{try{cur&&cur.onTaskSuccess&&cur.onTaskSuccess(task)}catch(e){cc.log("\u539f\u751f\u4e0b\u8f09 onTaskSuccess error: "+e)}});GSDownloaderManager.removeDownloaderByUrl(this.url)});downloader.setOnTaskError((task,errorCode,errorCodeInternal,errorStr)=>{cc.log("\u539f\u751f\u4e0b\u8f09\u5931\u6557url = %s errorCode = %d errorCodeInternal = %d errorString = %s",
this.url,errorCode,errorCodeInternal,errorStr);this.downloaderCallbackArray.forEach(cur=>{try{cur&&cur.onTaskError&&cur.onTaskError(task,errorCode,errorCodeInternal,errorStr)}catch(e){cc.log("\u539f\u751f\u4e0b\u8f09 onTaskError error: "+e)}});GSDownloaderManager.removeDownloaderByUrl(this.url)});downloader.createDownloadFileTask(this.url,this._savePath,this._identifier)}}};var _startDownloadQueue=function(){var nowDownloadCount=0;downloaderObjects.forEach(cur=>{if(cur.isDownloading)nowDownloadCount++});
if(nowDownloadCount<maxDownloadCount&&downloaderObjects.length)for(var i=0;i<downloaderObjects.length;i++){var downloaderObject=downloaderObjects[i];if(!downloaderObject.isDownloading){downloaderObject.start();break}}};GSDownloaderManager.addDownloader=function(url,savePath,identifier,downloaderCallback,useHttpDownloader=true){if(!cc.sys.isNative){cc.error("GSDownloaderManager.addDownloader \u539f\u751f\u9650\u5b9a");return}var downloaderObject=null;for(var i=0;i<downloaderObjects.length;i++){var tmpObj=
downloaderObjects[i];if(tmpObj.url===url){downloaderObject=tmpObj;break}}if(!downloaderObject){downloaderObject=new DownloaderClass(url,savePath,identifier,downloaderCallback,useHttpDownloader);downloaderObjects.push(downloaderObject);_startDownloadQueue()}else downloaderObject.downloaderCallbackArray.push(downloaderCallback)};var downloadAsync=function(target,downloadPath,savePath,progressCallback){return new Promise((resolve,reject)=>{var downloaderCallback=new GSDownloaderCallback(target);downloaderCallback.onTaskSuccess=
task=>{var resultObj={task:task};reject(resultObj)};downloaderCallback.onTaskProgress=(task,bytesReceived,totalBytesReceived,totalBytesExpected)=>{progressCallback&&progressCallback(task,bytesReceived,totalBytesReceived,totalBytesExpected)};downloaderCallback.onTaskError=(task,errorCode,errorCodeInternal,errorStr)=>{var resultObj={task:task,errorCode:errorCode,errorCodeInternal:errorCodeInternal,errorStr:errorStr};resolve(resultObj)};GSDownloaderManager.addDownloader(downloadPath,savePath,null,downloaderCallback,
false)})};GSDownloaderManager.downloadWithMultiDomain=function(domainArray,downloadPath,savePath,callback){var progressCallback;if(callback&&callback.onTaskProgress)progressCallback=(task,bytesReceived,totalBytesReceived,totalBytesExpected)=>{callback.onTaskProgress(task,bytesReceived,totalBytesReceived,totalBytesExpected)};var target=callback.context;domainArray.reduce((previousPromise,currDomain)=>{return previousPromise.then(()=>downloadAsync(target,GS.httpScheme+"//"+currDomain+downloadPath,savePath,
progressCallback))},Promise.resolve()).then(result=>{callback&&callback.onTaskError&&callback.onTaskError(result.task,result.errorCode,result.errorCodeInternal,result.errorStr)}).catch(result=>{if(result instanceof Error){var errorCode=-4;callback&&callback.onTaskError&&callback.onTaskError(null,errorCode,0,"JS Error");throw new Error("Download failed with JS Error!");}callback&&callback.onTaskSuccess&&callback.onTaskSuccess(result.task)})};GSDownloaderManager.removeDownloadWithMultiDomain=function(domainArray,
downloadPath){domainArray.forEach(domain=>{var url=GS.httpScheme+"//"+domain+downloadPath;GSDownloaderManager.removeDownloaderByUrl(url)})};GSDownloaderManager.removeDownloaderByUrl=function(url){for(var i=0;i<downloaderObjects.length;i++){var tmpObject=downloaderObjects[i];if(tmpObject.url==url){downloaderObjects.splice(i,1);break}}_startDownloadQueue()};GSDownloaderManager.removeDownloaderByContext=function(context){for(var i=0;i<downloaderObjects.length;i++){var downloaderObject=downloaderObjects[i];
for(var j=downloaderObject.downloaderCallbackArray.length-1;j>=0;j--){var downloaderCallback=downloaderObject.downloaderCallbackArray[j];if(downloaderCallback.context===context)downloaderObject.downloaderCallbackArray.splice(j,1)}if(downloaderObject.downloaderCallbackArray.length===0&&!downloaderObject.isDownloading){GSDownloaderManager.removeDownloaderByUrl(downloaderObject.url);break}}}}).call(window||module||{});var GSDownloadSprite=cc.Node.extend({_targetSize:cc.size(0,0),_imageDoneCallback:null,ctor:function(defaultImage,imageUrl,savePath,imageDoneCallback,needForceDownload=false){this._super();this._imageUrl=imageUrl;this._savePath=savePath;this._isInitRefresh=false;this.setCascadeColorEnabled(true);this.setCascadeOpacityEnabled(true);if(!GSDownloadSprite.CONTENT_SCALE)GSDownloadSprite.CONTENT_SCALE=cc.director.getContentScaleFactor()/2;this._defaultImage=defaultImage;this._imageDoneCallback=imageDoneCallback;
this._urlString=null;this._needForceDownload=needForceDownload;var photoSprite=this._photoSprite=new cc.Sprite;defaultImage&&photoSprite.setSpriteFrame(defaultImage);this.addChild(photoSprite);this.setAnchorPoint(.5,.5)},onEnterTransitionDidFinish:function(){this._super();this._isInitRefresh||this.refreshByImageUrl(this._imageUrl,this._savePath)},onExit:function(){GSDownloaderManager.removeDownloaderByContext(this);GSImageTool.removeImageCallbackByTarget(this._photoSprite);this._isInitRefresh=false;
this._super()},setTargetSize:function(size){this._targetSize=size;this._scaleToTargetSize()},getPhotoSpriteContentSize:function(){var size=cc.size(0,0);if(this._photoSprite)size=this._photoSprite.getContentSize();return size},getTargetSize:function(){return this._targetSize},getPhotoSprite:function(){return this._photoSprite},setFixedScale:function(fixedScale){this._fixedScale=fixedScale*(this._isUseSpriteFrame?1:GSDownloadSprite.CONTENT_SCALE);this._scaleToTargetSize()},setImageDoneCallback:function(callback){this._imageDoneCallback=
callback},refreshByImageUrl:function(url,savePath){this._isInitRefresh=true;if(!url)return;if(this._urlString!==url)if(this._photoSprite){GSImageTool.removeImageCallbackByTarget(this._photoSprite);this._photoSprite.removeFromParent();this._photoSprite=null}this._urlString=url;this._reCreatePhotoSprite();this._isUseSpriteFrame=url.indexOf("#")===0;if(this._isUseSpriteFrame){this._photoSprite.setSpriteFrame(url.substr(1));this._scaleToTargetSize();this._imageDoneCallback&&this._imageDoneCallback("",
this);return}if(this._defaultImage){this._photoSprite.setSpriteFrame(this._defaultImage);this._scaleToTargetSize()}if(cc.sys.isNative&&savePath){if(!this._needForceDownload)if(jsb.fileUtils.isFileExist(savePath)){this._refreshImageByFile(savePath,url);return}else{var fileName=savePath.replace(JSWriteablePath,"");var isInApp=jsb.fileUtils.isFileExist(fileName);if(isInApp){this._refreshImageByFile(fileName,url);return}}var downloaderCallback=new GSDownloaderCallback(this);downloaderCallback.onTaskSuccess=
task=>{this._refreshImageByFile(savePath,url)};downloaderCallback.onTaskError=(task,errorCode,errorCodeInternal,errorStr)=>{cc.log("GSDownloadSprite \u4e0b\u8f09\u5931\u6557 URL="+url+" errorStr="+errorStr);this._imageDoneCallback&&this._imageDoneCallback("Error",this)};GSDownloaderManager.addDownloader(url,savePath,null,downloaderCallback)}else GSImageTool.addImageAsync(url,texture=>{if(texture instanceof cc.Texture2D)this._refreshImageByTexture(texture,url);else{this._imageDoneCallback&&this._imageDoneCallback("Error",
this);cc.log("GSDownloadSprite\u4e0b\u8f09\u5931\u6557 URL="+url)}},this._photoSprite)},_reCreatePhotoSprite:function(...args){if(!this._photoSprite){this._photoSprite=new cc.Sprite(...args);this.addChild(this._photoSprite)}},_scaleToTargetSize:function(){var targetSize=this._targetSize;if(cc.sizeEqualToSize(targetSize,cc.size(0,0))){this._photoSprite.setScale(1);this._photoSprite.setPosition(0,0);this.setContentSize(0,0);return}var spriteSize=this._photoSprite.getContentSize();if(cc.sizeEqualToSize(spriteSize,
cc.size(0,0))){this.setContentSize(targetSize);return}var scaleFactor=1;if(this._fixedScale)scaleFactor=this._fixedScale;else if(targetSize.width===0)scaleFactor=targetSize.height/spriteSize.height;else if(targetSize.height===0)scaleFactor=targetSize.width/spriteSize.width;else scaleFactor=Math.min(targetSize.width/spriteSize.width,targetSize.height/spriteSize.height);var contentSize=cc.size(spriteSize.width*scaleFactor,spriteSize.height*scaleFactor);this.setContentSize(contentSize);this._photoSprite.setScale(scaleFactor);
this._photoSprite.setPosition(contentSize.width/2,contentSize.height/2)},_refreshImageByFile:function(savePath,key){if(this._urlString!==key)return;if(this._photoSprite){GSImageTool.removeImageCallbackByTarget(this._photoSprite);this._photoSprite.removeFromParent();this._photoSprite=null}this._reCreatePhotoSprite(savePath);this._scaleToTargetSize();this._imageDoneCallback&&this._imageDoneCallback("",this)},_refreshImageByTexture:function(texture,key){if(this._urlString!==key)return;this._photoSprite.setTexture(texture);
this._photoSprite.setTextureRect(cc.rect(0,0,texture.getContentSize().width,texture.getContentSize().height));this._scaleToTargetSize();this._imageDoneCallback&&this._imageDoneCallback("",this)}});var GSVideoChatButtonDelegate=cc.Class.extend({onFunctionChange:function(isEnabled){},onTalkVolumeChanged:function(volume){}});var GSVideoChatDebugLayer=cc.Layer.extend({ctor:function(selfAccount){this._super();if(!cc.sys.isNative)return;var showLabel=new cc.LabelTTF("",JSFontBoldName,10);showLabel.setAnchorPoint(0,1);showLabel.enableStroke(JSColor.BLACK,1);showLabel.setPosition(JSScreenSafeWidth,JSVisibleSize.height);this.addChild(showLabel);this.schedule(()=>{var jsonString=GSVideoChat.getNowStatusJSON();var showString=JSON.parse(jsonString||"[]").map(cur=>{var account=cur["account"];return cur["account"]+" "+cur["video"].toString()+
" "+cur["audio"].toString()+(account===selfAccount?" **":"")}).join("\n");showLabel.setString(showString)},1)}});var GSVideoChatDelegate=cc.Class.extend({onConnectStatusChanged:function(status){},onPlayerNotification:function(method,peerID,isVideo){},onTalkVolumeChanged:function(peerID,volume){}});GSVideoChatDelegate.CONNECT_STATUS={CONNECTED:1,DISCONNECTED:2,DESTROY:3};GSVideoChatDelegate.METHOD={NONE:0,NEW:1,CLOSED:2,RESUMED:3,PAUSED:4};
GSVideoChatDelegate.METHOD_MAPPING={newConsumer:GSVideoChatDelegate.METHOD.NEW,consumerClosed:GSVideoChatDelegate.METHOD.CLOSED,consumerResumed:GSVideoChatDelegate.METHOD.RESUMED,consumerPaused:GSVideoChatDelegate.METHOD.PAUSED};var GSVideoChatNode=cc.Node.extend({ctor:function(size,defaultNode,clippingNode){this._super();this.setCascadeColorEnabled(true);this.setCascadeOpacityEnabled(true);this._isAudioEnable=true;this._isVideoEnable=true;this._videoSize=size;this._defaultNode=defaultNode;defaultNode&&this.addChild(defaultNode);var clipNode=clippingNode;if(!clipNode){var midPos=cc.p(size.width/2,size.height/2);var stencil=new cc.LayerColor(cc.color(255,255,255,255),size.width,size.height);stencil.setPosition(-midPos.x,-midPos.y);
clipNode=new cc.ClippingNode(stencil)}this.addChild(clipNode);clipNode.setCascadeColorEnabled(true);clipNode.setCascadeOpacityEnabled(true);this._clipNode=clipNode;var videoSprite=this._videoSprite=new cc.Sprite;clipNode.addChild(videoSprite)},onEnter:function(){GSVideoChatWrapper.addDelegate(this);this._super()},onExit:function(){GSVideoChatWrapper.removeDelegate(this);GSVideoChatWrapper.removeSprite(this._peerID,this._videoSprite);this._super()},setPeerID:function(peerID){if(this._peerID===peerID)return;
if(this._peerID)GSVideoChatWrapper.removeSprite(this._peerID,this._videoSprite);this._peerID=peerID;if(peerID){GSVideoChatWrapper.addSprite(this._peerID,this._videoSprite,this._videoSize);this._setVideo(GSVideoChatWrapper.getLocalIsEnabled(peerID,true));this._setAudio(GSVideoChatWrapper.getLocalIsEnabled(peerID,false));this._videoButton&&this._videoButton.setVisible(GSVideoChatWrapper.getHaveUser(this._peerID,true));this._audioButton&&this._audioButton.setVisible(GSVideoChatWrapper.getHaveUser(this._peerID,
false))}},getPeerID:function(){return this._peerID},setVideo:function(isEnable){if(!this._peerID)return;GSVideoChatWrapper.setVideo(isEnable,this._peerID)},_setVideo:function(isEnable){this._isVideoEnable=isEnable;this._clipNode.setVisible(isEnable);this._videoButton&&this._videoButton.onFunctionChange&&this._videoButton.onFunctionChange(isEnable)},setAudio:function(isEnable){if(!this._peerID)return;GSVideoChatWrapper.setAudio(isEnable,this._peerID)},_setAudio:function(isEnable){this._isAudioEnable=
isEnable;this._audioButton&&this._audioButton.onFunctionChange&&this._audioButton.onFunctionChange(isEnable)},setVideoButton:function(button){this._videoButton=button;if(button){button.addTouchUpInsideAction(()=>{this.setVideo(!this._isVideoEnable)},this);this._peerID&&button.setVisible(GSVideoChatWrapper.getHaveUser(this._peerID,true));this._setVideo(this._isVideoEnable)}},setAudioButton:function(button){this._audioButton=button;if(button){button.addTouchUpInsideAction(()=>{this.setAudio(!this._isAudioEnable)},
this);this._peerID&&button.setVisible(GSVideoChatWrapper.getHaveUser(this._peerID,false));this._setAudio(this._isAudioEnable)}},onConnectStatusChanged:function(status){switch(status){case GSVideoChatDelegate.CONNECT_STATUS.CONNECTED:this._setVideo(GSVideoChatWrapper.getLocalIsEnabled(this._peerID,true));this._setAudio(GSVideoChatWrapper.getLocalIsEnabled(this._peerID,false));this._videoButton&&this._videoButton.setVisible(GSVideoChatWrapper.getHaveUser(this._peerID,true));this._audioButton&&this._audioButton.setVisible(GSVideoChatWrapper.getHaveUser(this._peerID,
false));break;case GSVideoChatDelegate.CONNECT_STATUS.DISCONNECTED:case GSVideoChatDelegate.CONNECT_STATUS.DESTROY:this._setVideo(false);this._videoButton&&this._videoButton.setVisible(false);this._audioButton&&this._audioButton.setVisible(false);break}},onPlayerNotification:function(method,peerID,isVideo){if(this._peerID!==peerID)return;switch(method){case GSVideoChatDelegate.METHOD.NEW:if(isVideo){this._setVideo(GSVideoChatWrapper.getLocalIsEnabled(this._peerID,true));this._videoButton&&this._videoButton.setVisible(true)}else{this._setAudio(GSVideoChatWrapper.getLocalIsEnabled(this._peerID,
false));this._audioButton&&this._audioButton.setVisible(true)}break;case GSVideoChatDelegate.METHOD.CLOSED:if(isVideo)this._setVideo(false);else{this._setAudio(false);this._audioButton&&this._audioButton.setVisible(false)}break;case GSVideoChatDelegate.METHOD.PAUSED:if(isVideo)this._setVideo(false);else this._setAudio(false);break;case GSVideoChatDelegate.METHOD.RESUMED:if(isVideo)this._setVideo(true);else this._setAudio(true);break}},onTalkVolumeChanged:function(peerID,volume){if(this._peerID!==
peerID)return;this._audioButton&&this._audioButton.onTalkVolumeChanged&&this._audioButton.onTalkVolumeChanged(volume)}});var GSVideoChatWrapper={};
(function(){var videoEnabledMap=new Map;var audioEnabledMap=new Map;var videoUserMap=new Map;var audioUserMap=new Map;var nowConnectStatus=GSVideoChatDelegate.CONNECT_STATUS.DISCONNECTED;var selfPeerID;var isAddNativeDelegate=false;var debugLayer=undefined;GSVideoChatWrapper.start=function(url,roomID,peerID,token,disableVideo=false,disableAudio=false){if(cc.sys.isNative){selfPeerID=peerID;if(false){debugLayer&&debugLayer.removeFromParent();debugLayer=new GSVideoChatDebugLayer(peerID);cc.director.getNotificationNode().addChild(debugLayer)}if(!isAddNativeDelegate){GSVideoChat.addDelegate(nativeDelegate);
isAddNativeDelegate=true}GSVideoChat.start(url,roomID,peerID,token,disableVideo,disableAudio)}else GSLiveKit.start(url,roomID,peerID,token,disableVideo,disableAudio)};GSVideoChatWrapper.stop=function(){videoEnabledMap.clear();audioEnabledMap.clear();videoUserMap.clear();audioUserMap.clear();selfPeerID=undefined;if(cc.sys.isNative)GSVideoChat.stop();else GSLiveKit.stop();nowConnectStatus=GSVideoChatDelegate.CONNECT_STATUS.DISCONNECTED};GSVideoChatWrapper.getPeerID=function(account=""){return account+
"_"+GS.gameLobbyID.toString()};GSVideoChatWrapper.addSprite=function(peerID,sprite,size){if(cc.sys.isNative)GSVideoChat.addSprite(peerID,sprite,size);else GSLiveKitRenderer.addSprite(peerID,sprite,size)};GSVideoChatWrapper.removeSprite=function(peerID,sprite){if(cc.sys.isNative)GSVideoChat.removeSprite(peerID,sprite);else GSLiveKitRenderer.removeSprite(peerID,sprite)};GSVideoChatWrapper.setAudio=function(isEnable,peerID){audioEnabledMap.set(peerID,isEnable);if(cc.sys.isNative)GSVideoChat.setAudio(isEnable,
peerID);else GSLiveKit.setAudio(isEnable,peerID);var method=isEnable?GSVideoChatDelegate.METHOD.RESUMED:GSVideoChatDelegate.METHOD.PAUSED;_delegateArray.forEach(delegate=>{delegate.onPlayerNotification&&delegate.onPlayerNotification(method,peerID,false)})};GSVideoChatWrapper.setVideo=function(isEnable,peerID){videoEnabledMap.set(peerID,isEnable);if(cc.sys.isNative)GSVideoChat.setVideo(isEnable,peerID);else GSLiveKit.setVideo(isEnable,peerID);var method=isEnable?GSVideoChatDelegate.METHOD.RESUMED:
GSVideoChatDelegate.METHOD.PAUSED;_delegateArray.forEach(delegate=>{delegate.onPlayerNotification&&delegate.onPlayerNotification(method,peerID,true)})};GSVideoChatWrapper.getLocalIsEnabled=function(peerID,isVideo){var value=isVideo?videoEnabledMap.get(peerID):audioEnabledMap.get(peerID);if(value===undefined)value=!isVideo;return value};GSVideoChatWrapper.getRemoteIsEnabled=function(peerID,isVideo){if(cc.sys.isNative)return!GSVideoChat.getIsPaused(peerID,isVideo);return false};GSVideoChatWrapper.getHaveUser=
function(peerID,isVideo){return isVideo?videoUserMap.get(peerID):audioUserMap.get(peerID)};GSVideoChatWrapper.getIsConnected=function(){return nowConnectStatus===GSVideoChatDelegate.CONNECT_STATUS.CONNECTED};var _delegateArray=[];GSVideoChatWrapper.addDelegate=function(context){if(_delegateArray.indexOf(context)<0)_delegateArray.push(context)};GSVideoChatWrapper.removeDelegate=function(context){var findIndex=_delegateArray.indexOf(context);if(findIndex>-1)_delegateArray.splice(findIndex,1)};GSVideoChatWrapper.onConnectStatusChanged=
function(status){nativeDelegate.onConnectStatusChanged(status)};GSVideoChatWrapper.onNotification=function(notification){nativeDelegate.onNotification(JSON.stringify(notification))};var nativeDelegate={onConnectStatusChanged:function(status){nowConnectStatus=status;switch(status){case GSVideoChatDelegate.CONNECT_STATUS.CONNECTED:break;case GSVideoChatDelegate.CONNECT_STATUS.DISCONNECTED:videoEnabledMap.clear();audioEnabledMap.clear();videoUserMap.clear();audioUserMap.clear();break}_delegateArray.forEach(delegate=>
{delegate.onConnectStatusChanged&&delegate.onConnectStatusChanged(status)})},onNotification:function(notification){var jsonValue=JSON.parse(notification||"{}");var dataValue=jsonValue["data"];var method=jsonValue["method"];var peerID=dataValue["peerId"];if(method==="activeSpeaker"){var volume=dataValue["volume"];_delegateArray.forEach(delegate=>{delegate.onTalkVolumeChanged&&delegate.onTalkVolumeChanged(peerID,volume)})}else{var methodEnum=GSVideoChatDelegate.METHOD_MAPPING[method];if(!methodEnum)return;
var isVideo=dataValue["isVideo"];switch(methodEnum){case GSVideoChatDelegate.METHOD.NEW:var producerPaused=dataValue["producerPaused"];isVideo?videoUserMap.set(peerID,true):audioUserMap.set(peerID,true);isVideo?videoEnabledMap.set(peerID,!producerPaused):audioEnabledMap.set(peerID,!producerPaused);break;case GSVideoChatDelegate.METHOD.CLOSED:isVideo?videoUserMap.delete(peerID):audioUserMap.delete(peerID);isVideo?videoEnabledMap.delete(peerID):audioEnabledMap.delete(peerID);break;case GSVideoChatDelegate.METHOD.PAUSED:isVideo?
videoEnabledMap.set(peerID,false):audioEnabledMap.set(peerID,false);break;case GSVideoChatDelegate.METHOD.RESUMED:isVideo?videoEnabledMap.set(peerID,true):audioEnabledMap.set(peerID,true);break}_delegateArray.forEach(delegate=>{delegate.onPlayerNotification&&delegate.onPlayerNotification(methodEnum,peerID,isVideo)})}}};if(!cc.sys.isNative){var list=["web_library/LiveKit.js","out_src/ToolBox/GSVideoChat/LiveKit/GSLiveKit.js","out_src/ToolBox/GSVideoChat/LiveKit/GSLiveKitRenderer.js"];cc.loader.loadJs("",
list,(a,b)=>{})}})();var GSPurchaseWebView=cc.Node.extend({ctor:function(url){this._super();this._url=url},onEnter:function(){this._super();var webViewSize=this._webViewSize=this.getContentSize();var webViewPos=this._webViewPos=this.getPosition();if(cc.sys.isNative&&cc.sys.os===cc.sys.OS_ANDROID){var eglView=cc.director.getOpenGLView();var left=(webViewPos.x-webViewSize.width/2)*eglView.getScaleX();var right=(JSVisibleSize.width-webViewPos.x-webViewSize.width/2)*eglView.getScaleX();var top=(JSVisibleSize.height-webViewPos.y-
webViewSize.height/2)*eglView.getScaleY();var bottom=(webViewPos.y-webViewSize.height/2)*eglView.getScaleY();jsb.reflection.callStaticMethod("com/gamesofa/activity/PurchaseLayout","showWebView","(Ljava/lang/String;FFFF)V",this._url,left,top,right,bottom);GSWebViewChecker.addWebViewRef(this)}else{var webView=this._webView=new GSWebView(this._url);webView.setContentSize(webViewSize);webView.setEnableUrlOverride(true);cc.sys.isNative&&webView.setOpacityWebView(1);this.addChild(webView)}},onExit:function(){this._super();
if(cc.sys.isNative&&cc.sys.os===cc.sys.OS_ANDROID){jsb.reflection.callStaticMethod("com/gamesofa/activity/PurchaseLayout","destroyWebView","()V");GSWebViewChecker.removeWebViewRef(this)}},setVisible:function(isVisible){if(this.__isDestroyed)return;this._super(isVisible);if(cc.sys.isNative&&cc.sys.os===cc.sys.OS_ANDROID){jsb.reflection.callStaticMethod("com/gamesofa/activity/PurchaseLayout","setWebViewVisible","(Z)V",isVisible);GS.dispatchCustomEvent("NotifyUpdateWebViewChecker")}else this._webView&&
this._webView.setVisible(isVisible)},loadURL:function(url){this._url=url;if(cc.sys.isNative&&cc.sys.os===cc.sys.OS_ANDROID){var webViewSize=this._webViewSize;var webViewPos=this._webViewPos;var eglView=cc.director.getOpenGLView();var left=(webViewPos.x-webViewSize.width/2)*eglView.getScaleX();var right=(JSVisibleSize.width-webViewPos.x-webViewSize.width/2)*eglView.getScaleX();var top=(JSVisibleSize.height-webViewPos.y-webViewSize.height/2)*eglView.getScaleY();var bottom=(webViewPos.y-webViewSize.height/
2)*eglView.getScaleY();jsb.reflection.callStaticMethod("com/gamesofa/activity/PurchaseLayout","showWebView","(Ljava/lang/String;FFFF)V",url,left,top,right,bottom)}else this._webView&&this._webView.loadURL(url)}});var GSWebView;
(function(){if(cc.sys.isNative){GSWebView=ccui.WebView;GSWebView.prototype._ctor=function(url){this.init();url!==undefined&&this.loadURL(url);this.enabledAutoCheckDialog=true;this.setOnEnterCallback(()=>{this._isDestroyed=false;if(this.isVisible()&&!this.isVisibleRecursive())this.setVisible(false);GSWebViewChecker.addWebViewRef(this)});this.setOnExitCallback(()=>{this._isDestroyed=true;GSWebViewChecker.removeWebViewRef(this)});this.setEnableUrlOverride=val=>{if(val)this.setOnShouldStartLoading((view,url)=>
{if(url.indexOf("alert://")===0){var subString=url.substring("alert://".length,url.length);var valueArray=subString.split(",").map(function(cur){return decodeURIComponent(cur)});var valueLen=valueArray.length;if(valueLen>1&&typeof AlertDialog!=="undefined"){var content;if(valueLen===3){content=valueArray[2];DataProcess.sendString("session_status [1]")}else content=valueArray[1];AlertDialog.showAlert(valueArray[0],content,null,function(index){})}return false}else if(url.indexOf("confirm://")===0){var subString=
url.substring("confirm://".length,url.length);var valueArray=subString.split(",").map(function(cur){return decodeURIComponent(cur)});if(valueArray.length>2){var btns=[LocalizedString.Common("\u53d6\u6d88"),LocalizedString.Common("\u78ba\u8a8d")];AlertDialog.showAlert(valueArray[0],valueArray[1],btns,index=>{if(index===0);else if(index===1)this.evaluateJS(valueArray[2])})}return false}else if(url.indexOf("gamesofa://")===0){GSWebView.parseGamesofaUrlScheme(url);return false}else if(url.indexOf("update://")===
0){DataProcess.sendString("session_status [1]");GS.dispatchCustomEvent("NotifyWebViewGetUpdateURL");return false}else if(url.indexOf("gojek")===0){if(cc.sys.isNative)if(!cc.sys.openURL(url))if(cc.sys.os===cc.sys.OS_ANDROID)cc.sys.openURL("https://play.google.com/store/apps/details?id=com.gojek.app");else cc.sys.openURL("https://apps.apple.com/id/app/gojek/id944875099");return false}else if(url.indexOf("js2ios://key/")===0){if(cc.sys.isNative&&cc.sys.os===cc.sys.OS_IOS){var subString=url.substring("js2ios://key/".length,
url.length);var param=JSON.parse(subString);switch(param.cmd){case "smsapp":var body=param.body;var phone=param.phone;GSOpenAppWrapper.openSMSApp(phone,body);return false;case "redirect_to_bill_page":GS.dispatchCustomEvent("NotifyPurchaseWebViewRedirectToBillPage");return false}}}else if(url.indexOf("line://")===0){if(cc.sys.isNative)if(!cc.sys.openURL(url))if(cc.sys.os===cc.sys.OS_ANDROID)cc.sys.openURL("https://play.google.com/store/apps/details?id=jp.naver.line.android");else cc.sys.openURL("https://apps.apple.com/tw/app/line/id443904275");
return false}return true});else this.setOnShouldStartLoading(null)}};GSWebView.prototype.setVisible=function(value){if(this._isDestroyed)return;cc.Node.prototype.setVisible.call(this,value);GS.dispatchCustomEvent("NotifyUpdateWebViewChecker");if(this.enabledAutoCheckDialog)if(value)DialogManager.setNowShowWebView(this);else DialogManager.startShowDialog()};GSWebView.prototype.isVisible=function(){if(this._isDestroyed)return false;return cc.Node.prototype.isVisible.call(this)};GSWebView.addLinkCallback=
function(selector,callback){}}else GSWebView=ccui.WebView.extend({ctor:function(path){this._super(path)},onEnter:function(){this._super();if(this.isVisible()&&!this.isVisibleRecursive())this.setVisible(false);GSWebViewChecker.addWebViewRef(this)},onExit:function(){this._super();GSWebViewChecker.removeWebViewRef(this)},setVisible:function(value){this._super(value);GS.dispatchCustomEvent("NotifyUpdateWebViewChecker");if(this.enabledAutoCheckDialog)if(value)DialogManager.setNowShowWebView(this);else DialogManager.startShowDialog()},
setEnableUrlOverride:function(val){},addLinkCallback:function(hrefPrefix,callback){var iframe=this._renderCmd._iframe;var iframedoc=iframe.contentDocument||iframe.contentWindow&&iframe.contentWindow.document;var nodeList=iframedoc.querySelectorAll('a[href^="'+hrefPrefix+'"]');var anchors=Array.prototype.slice.call(nodeList);var addEvent=function(element,evnt,funct){if(element.attachEvent)return element.attachEvent("on"+evnt,funct);else return element.addEventListener(evnt,funct,false)};anchors.forEach(ele=>
{var href=ele.href.slice(window.location.origin.length+1);ele.href="javascript:void(0)";addEvent(ele,"click",()=>{callback(this,href)})})}});GSWebView.parseGamesofaUrlScheme=function(url){var findIndex=url.indexOf("?");if(findIndex!==-1){var array=url.substr(findIndex+1).split("&");var newUrl=url.substr(0,findIndex+1);var type="",urlLink="";for(var i=0,len=array.length;i<len;i++){var nowContent=array[i];if(nowContent.indexOf("type=")===0)type=nowContent;else if(nowContent.indexOf("urlLink=")===0)urlLink=
"urlLink="+encodeURIComponent(nowContent.substr(8));else if(urlLink)urlLink+=encodeURIComponent("&"+nowContent)}if(type){newUrl+=type;if(urlLink)newUrl+="&"+urlLink;var param=GS.getUrlQueryParam(newUrl);PushLayerHelper.pushLayer(param.urlLink,parseInt(param.type),"")}}}})();var GSWebViewChecker={};
(function(){var webViewRefArray=[];GSWebViewChecker.addWebViewRef=function(webView){if(webViewRefArray.indexOf(webView)<0){webViewRefArray.push(webView);GS.dispatchCustomEvent("NotifyUpdateWebViewChecker");DialogManager.setNowShowWebView(webView)}};GSWebViewChecker.removeWebViewRef=function(webView){for(var i=0;i<webViewRefArray.length;i++)if(webViewRefArray[i]===webView){webViewRefArray.splice(i,1);break}if(!this.haveWebViewRef())DialogManager.startShowDialog();GS.dispatchCustomEvent("NotifyUpdateWebViewChecker")};GSWebViewChecker.haveWebViewRef=
function(){return webViewRefArray.some(cur=>cur&&cur.isVisible())};GSWebViewChecker.getWebViewRefArray=function(){return webViewRefArray}})();var GSNativeWebView;
if(!cc.sys.isNative||cc.sys.os!==cc.sys.OS_ANDROID)GSNativeWebView=GSWebView;else GSNativeWebView=cc.Node.extend({GAME_PACKAGE:"com/gamesofa/GSWebView",ctor:function(){this._super()},onEnter:function(){this._super();this._isDestroyed=false;GSWebViewChecker.addWebViewRef(this)},onExit:function(){this._super();this._isDestroyed=true;jsb.reflection.callStaticMethod(this.GAME_PACKAGE,"staticRemoveWebView","()V");GSWebViewChecker.removeWebViewRef(this)},setVisible:function(visible){if(this._isDestroyed)return;cc.Node.prototype.setVisible.call(this,
visible);jsb.reflection.callStaticMethod(this.GAME_PACKAGE,"webViewSetVisibility","(I)V",visible?1:0);GS.dispatchCustomEvent("NotifyUpdateWebViewChecker")},setContentSize:function(size,height){if(this._isDestroyed)return false;cc.Node.prototype.setContentSize.call(this,size,height);this._updateWebViewSize()},setPosition:function(newPosOrxValue,yValue){if(this._isDestroyed)return false;if(yValue===undefined)cc.Node.prototype.setPosition.call(this,newPosOrxValue);else cc.Node.prototype.setPosition.call(this,
newPosOrxValue,yValue);this._updateWebViewSize()},setEnableUrlOverride:function(val){},_updateWebViewSize:function(){var pos=this.getPosition();var size=this.getContentSize();var midSize=cc.size(size.width/2,size.height/2);var eglView=cc.director.getOpenGLView();var visibleSize=JSVisibleSize;var left=(pos.x-midSize.width)*eglView.getScaleX();var right=(visibleSize.width-(pos.x+midSize.width))*eglView.getScaleX();var bottom=(pos.y-midSize.height)*eglView.getScaleY();var top=(visibleSize.height-(pos.y+
midSize.height))*eglView.getScaleY();jsb.reflection.callStaticMethod(this.GAME_PACKAGE,"webViewSetMargins","(FFFF)V",left,top,right,bottom)},loadURL:function(url){jsb.reflection.callStaticMethod(this.GAME_PACKAGE,"webViewLoadUrl","(IILjava/lang/String;)V",0,13,url);this._updateWebViewSize()}});var GSImageTool={_callbackMap:new Map};
(function(){GSImageTool.getTextureByBase64=function(base64,cacheKey){cacheKey=cacheKey||"default_base64_image";var buffer=cc.Codec.Base64.decodeAsArray(base64,1);if(!buffer){cc.log("GSImageTool.getTextureByBase64 Error Key=%s",cacheKey);return null}var imageFormat=cc.getImageFormatByData(buffer);var canvasObj=document.createElement("canvas");switch(imageFormat){case cc.FMT_PNG:var decodeData=new cc.PNGReader(buffer);decodeData.render(canvasObj);break;case cc.FMT_JPG:var decodeData=new GSJPEGReader(buffer);
decodeData.render(canvasObj);break;default:cc.log("unknown image format with Data");return}cc.textureCache.cacheImage(cacheKey,canvasObj);var tex=cc.textureCache.getTextureForKey(cacheKey);if(!tex)cc.log("GSImageTool CreateTexture Error Key=%s",cacheKey);return tex};GSImageTool.addImageAsync=function(url,callback,target){this._callbackMap.set(target,callback);var imageDoneCallback=texture=>{var targetCallback=this._callbackMap.get(target);if(targetCallback){targetCallback(texture);this._callbackMap.delete(target)}};
if(typeof IS_FB_INSTANT_GAME!=="undefined"&&IS_FB_INSTANT_GAME)axios.get(url,{responseType:"blob"}).then(res=>{var reader=new FileReader;reader.readAsDataURL(res.data);reader.onload=function(){var imageDataUrl=reader.result;var img=new Image;img.addEventListener("load",function(){cc.textureCache.cacheImage(url,img);var texture=cc.textureCache.getTextureForKey(url);imageDoneCallback(texture);img=null});img.src=imageDataUrl}}).catch(reject=>{imageDoneCallback(null)});else cc.textureCache.addImageAsync(url,
imageDoneCallback)};GSImageTool.removeImageCallbackByTarget=function(target){this._callbackMap.delete(target)}})();var GSJPEGReader=function(data){var rawData=JPEGDecoder(data,true);this.width=rawData.width;this.height=rawData.height;this.pixels=rawData.data};
GSJPEGReader.prototype={constructor:GSJPEGReader,copyToImageData:function(imageData,pixels){var data=imageData.data||imageData;var i=0;var length=data.length;while(i<length){data[i]=pixels[i];i++;data[i]=pixels[i];i++;data[i]=pixels[i];i++;data[i]=pixels[i];i++}},render:function(canvas){var ctx,data;canvas.width=this.width;canvas.height=this.height;ctx=canvas.getContext("2d");data=ctx.createImageData(this.width,this.height);this.copyToImageData(data,this.pixels);ctx.putImageData(data,0,0)}};var JpegImage=function jpegImage(){var dctZigZag=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);var dctCos1=4017;var dctSin1=799;var dctCos3=3406;var dctSin3=2276;var dctCos6=1567;var dctSin6=3784;var dctSqrt2=5793;var dctSqrt1d2=2896;function constructor(){}function buildHuffmanTable(codeLengths,values){var k=0,code=[],i,j,length=16;while(length>
0&&!codeLengths[length-1])length--;code.push({children:[],index:0});var p=code[0],q;for(i=0;i<length;i++){for(j=0;j<codeLengths[i];j++){p=code.pop();p.children[p.index]=values[k];while(p.index>0)p=code.pop();p.index++;code.push(p);while(code.length<=i){code.push(q={children:[],index:0});p.children[p.index]=q.children;p=q}k++}if(i+1<length){code.push(q={children:[],index:0});p.children[p.index]=q.children;p=q}}return code[0].children}function decodeScan(data,offset,frame,components,resetInterval,spectralStart,
spectralEnd,successivePrev,successive){var precision=frame.precision;var samplesPerLine=frame.samplesPerLine;var scanLines=frame.scanLines;var mcusPerLine=frame.mcusPerLine;var progressive=frame.progressive;var maxH=frame.maxH,maxV=frame.maxV;var startOffset=offset,bitsData=0,bitsCount=0;function readBit(){if(bitsCount>0){bitsCount--;return bitsData>>bitsCount&1}bitsData=data[offset++];if(bitsData==255){var nextByte=data[offset++];if(nextByte)throw new Error("unexpected marker: "+(bitsData<<8|nextByte).toString(16));
}bitsCount=7;return bitsData>>>7}function decodeHuffman(tree){var node=tree,bit;while((bit=readBit())!==null){node=node[bit];if(typeof node==="number")return node;if(typeof node!=="object")throw new Error("invalid huffman sequence");}return null}function receive(length){var n=0;while(length>0){var bit=readBit();if(bit===null)return;n=n<<1|bit;length--}return n}function receiveAndExtend(length){var n=receive(length);if(n>=1<<length-1)return n;return n+(-1<<length)+1}function decodeBaseline(component,
zz){var t=decodeHuffman(component.huffmanTableDC);var diff=t===0?0:receiveAndExtend(t);zz[0]=component.pred+=diff;var k=1;while(k<64){var rs=decodeHuffman(component.huffmanTableAC);var s=rs&15,r=rs>>4;if(s===0){if(r<15)break;k+=16;continue}k+=r;var z=dctZigZag[k];zz[z]=receiveAndExtend(s);k++}}function decodeDCFirst(component,zz){var t=decodeHuffman(component.huffmanTableDC);var diff=t===0?0:receiveAndExtend(t)<<successive;zz[0]=component.pred+=diff}function decodeDCSuccessive(component,zz){zz[0]|=
readBit()<<successive}var eobrun=0;function decodeACFirst(component,zz){if(eobrun>0){eobrun--;return}var k=spectralStart,e=spectralEnd;while(k<=e){var rs=decodeHuffman(component.huffmanTableAC);var s=rs&15,r=rs>>4;if(s===0){if(r<15){eobrun=receive(r)+(1<<r)-1;break}k+=16;continue}k+=r;var z=dctZigZag[k];zz[z]=receiveAndExtend(s)*(1<<successive);k++}}var successiveACState=0,successiveACNextValue;function decodeACSuccessive(component,zz){var k=spectralStart,e=spectralEnd,r=0;while(k<=e){var z=dctZigZag[k];
var direction=zz[z]<0?-1:1;switch(successiveACState){case 0:var rs=decodeHuffman(component.huffmanTableAC);var s=rs&15,r=rs>>4;if(s===0)if(r<15){eobrun=receive(r)+(1<<r);successiveACState=4}else{r=16;successiveACState=1}else{if(s!==1)throw new Error("invalid ACn encoding");successiveACNextValue=receiveAndExtend(s);successiveACState=r?2:3}continue;case 1:case 2:if(zz[z])zz[z]+=(readBit()<<successive)*direction;else{r--;if(r===0)successiveACState=successiveACState==2?3:0}break;case 3:if(zz[z])zz[z]+=
(readBit()<<successive)*direction;else{zz[z]=successiveACNextValue<<successive;successiveACState=0}break;case 4:if(zz[z])zz[z]+=(readBit()<<successive)*direction;break}k++}if(successiveACState===4){eobrun--;if(eobrun===0)successiveACState=0}}function decodeMcu(component,decode,mcu,row,col){var mcuRow=mcu/mcusPerLine|0;var mcuCol=mcu%mcusPerLine;var blockRow=mcuRow*component.v+row;var blockCol=mcuCol*component.h+col;decode(component,component.blocks[blockRow][blockCol])}function decodeBlock(component,
decode,mcu){var blockRow=mcu/component.blocksPerLine|0;var blockCol=mcu%component.blocksPerLine;decode(component,component.blocks[blockRow][blockCol])}var componentsLength=components.length;var component,i,j,k,n;var decodeFn;if(progressive)if(spectralStart===0)decodeFn=successivePrev===0?decodeDCFirst:decodeDCSuccessive;else decodeFn=successivePrev===0?decodeACFirst:decodeACSuccessive;else decodeFn=decodeBaseline;var mcu=0,marker;var mcuExpected;if(componentsLength==1)mcuExpected=components[0].blocksPerLine*
components[0].blocksPerColumn;else mcuExpected=mcusPerLine*frame.mcusPerColumn;if(!resetInterval)resetInterval=mcuExpected;var h,v;while(mcu<mcuExpected){for(i=0;i<componentsLength;i++)components[i].pred=0;eobrun=0;if(componentsLength==1){component=components[0];for(n=0;n<resetInterval;n++){decodeBlock(component,decodeFn,mcu);mcu++}}else for(n=0;n<resetInterval;n++){for(i=0;i<componentsLength;i++){component=components[i];h=component.h;v=component.v;for(j=0;j<v;j++)for(k=0;k<h;k++)decodeMcu(component,
decodeFn,mcu,j,k)}mcu++;if(mcu===mcuExpected)break}bitsCount=0;marker=data[offset]<<8|data[offset+1];if(marker<65280)throw new Error("marker was not found");if(marker>=65488&&marker<=65495)offset+=2;else break}return offset-startOffset}function buildComponentData(frame,component){var lines=[];var blocksPerLine=component.blocksPerLine;var blocksPerColumn=component.blocksPerColumn;var samplesPerLine=blocksPerLine<<3;var R=new Int32Array(64),r=new Uint8Array(64);function quantizeAndInverse(zz,dataOut,
dataIn){var qt=component.quantizationTable;var v0,v1,v2,v3,v4,v5,v6,v7,t;var p=dataIn;var i;for(i=0;i<64;i++)p[i]=zz[i]*qt[i];for(i=0;i<8;++i){var row=8*i;if(p[1+row]==0&&p[2+row]==0&&p[3+row]==0&&p[4+row]==0&&p[5+row]==0&&p[6+row]==0&&p[7+row]==0){t=dctSqrt2*p[0+row]+512>>10;p[0+row]=t;p[1+row]=t;p[2+row]=t;p[3+row]=t;p[4+row]=t;p[5+row]=t;p[6+row]=t;p[7+row]=t;continue}v0=dctSqrt2*p[0+row]+128>>8;v1=dctSqrt2*p[4+row]+128>>8;v2=p[2+row];v3=p[6+row];v4=dctSqrt1d2*(p[1+row]-p[7+row])+128>>8;v7=dctSqrt1d2*
(p[1+row]+p[7+row])+128>>8;v5=p[3+row]<<4;v6=p[5+row]<<4;t=v0-v1+1>>1;v0=v0+v1+1>>1;v1=t;t=v2*dctSin6+v3*dctCos6+128>>8;v2=v2*dctCos6-v3*dctSin6+128>>8;v3=t;t=v4-v6+1>>1;v4=v4+v6+1>>1;v6=t;t=v7+v5+1>>1;v5=v7-v5+1>>1;v7=t;t=v0-v3+1>>1;v0=v0+v3+1>>1;v3=t;t=v1-v2+1>>1;v1=v1+v2+1>>1;v2=t;t=v4*dctSin3+v7*dctCos3+2048>>12;v4=v4*dctCos3-v7*dctSin3+2048>>12;v7=t;t=v5*dctSin1+v6*dctCos1+2048>>12;v5=v5*dctCos1-v6*dctSin1+2048>>12;v6=t;p[0+row]=v0+v7;p[7+row]=v0-v7;p[1+row]=v1+v6;p[6+row]=v1-v6;p[2+row]=v2+
v5;p[5+row]=v2-v5;p[3+row]=v3+v4;p[4+row]=v3-v4}for(i=0;i<8;++i){var col=i;if(p[1*8+col]==0&&p[2*8+col]==0&&p[3*8+col]==0&&p[4*8+col]==0&&p[5*8+col]==0&&p[6*8+col]==0&&p[7*8+col]==0){t=dctSqrt2*dataIn[i+0]+8192>>14;p[0*8+col]=t;p[1*8+col]=t;p[2*8+col]=t;p[3*8+col]=t;p[4*8+col]=t;p[5*8+col]=t;p[6*8+col]=t;p[7*8+col]=t;continue}v0=dctSqrt2*p[0*8+col]+2048>>12;v1=dctSqrt2*p[4*8+col]+2048>>12;v2=p[2*8+col];v3=p[6*8+col];v4=dctSqrt1d2*(p[1*8+col]-p[7*8+col])+2048>>12;v7=dctSqrt1d2*(p[1*8+col]+p[7*8+col])+
2048>>12;v5=p[3*8+col];v6=p[5*8+col];t=v0-v1+1>>1;v0=v0+v1+1>>1;v1=t;t=v2*dctSin6+v3*dctCos6+2048>>12;v2=v2*dctCos6-v3*dctSin6+2048>>12;v3=t;t=v4-v6+1>>1;v4=v4+v6+1>>1;v6=t;t=v7+v5+1>>1;v5=v7-v5+1>>1;v7=t;t=v0-v3+1>>1;v0=v0+v3+1>>1;v3=t;t=v1-v2+1>>1;v1=v1+v2+1>>1;v2=t;t=v4*dctSin3+v7*dctCos3+2048>>12;v4=v4*dctCos3-v7*dctSin3+2048>>12;v7=t;t=v5*dctSin1+v6*dctCos1+2048>>12;v5=v5*dctCos1-v6*dctSin1+2048>>12;v6=t;p[0*8+col]=v0+v7;p[7*8+col]=v0-v7;p[1*8+col]=v1+v6;p[6*8+col]=v1-v6;p[2*8+col]=v2+v5;p[5*
8+col]=v2-v5;p[3*8+col]=v3+v4;p[4*8+col]=v3-v4}for(i=0;i<64;++i){var sample=128+(p[i]+8>>4);dataOut[i]=sample<0?0:sample>255?255:sample}}var i,j;for(var blockRow=0;blockRow<blocksPerColumn;blockRow++){var scanLine=blockRow<<3;for(i=0;i<8;i++)lines.push(new Uint8Array(samplesPerLine));for(var blockCol=0;blockCol<blocksPerLine;blockCol++){quantizeAndInverse(component.blocks[blockRow][blockCol],r,R);var offset=0,sample=blockCol<<3;for(j=0;j<8;j++){var line=lines[scanLine+j];for(i=0;i<8;i++)line[sample+
i]=r[offset++]}}}return lines}function clampTo8bit(a){return a<0?0:a>255?255:a}constructor.prototype={load:function load(path){var xhr=new XMLHttpRequest;xhr.open("GET",path,true);xhr.responseType="arraybuffer";xhr.onload=function(){var data=new Uint8Array(xhr.response||xhr.mozResponseArrayBuffer);this.parse(data);if(this.onload)this.onload()}.bind(this);xhr.send(null)},parse:function parse(data){var offset=0,length=data.length;function readUint16(){var value=data[offset]<<8|data[offset+1];offset+=
2;return value}function readDataBlock(){var length=readUint16();var array=data.subarray(offset,offset+length-2);offset+=array.length;return array}function prepareComponents(frame){var maxH=0,maxV=0;var component,componentId;for(componentId in frame.components)if(frame.components.hasOwnProperty(componentId)){component=frame.components[componentId];if(maxH<component.h)maxH=component.h;if(maxV<component.v)maxV=component.v}var mcusPerLine=Math.ceil(frame.samplesPerLine/8/maxH);var mcusPerColumn=Math.ceil(frame.scanLines/
8/maxV);for(componentId in frame.components)if(frame.components.hasOwnProperty(componentId)){component=frame.components[componentId];var blocksPerLine=Math.ceil(Math.ceil(frame.samplesPerLine/8)*component.h/maxH);var blocksPerColumn=Math.ceil(Math.ceil(frame.scanLines/8)*component.v/maxV);var blocksPerLineForMcu=mcusPerLine*component.h;var blocksPerColumnForMcu=mcusPerColumn*component.v;var blocks=[];for(var i=0;i<blocksPerColumnForMcu;i++){var row=[];for(var j=0;j<blocksPerLineForMcu;j++)row.push(new Int32Array(64));
blocks.push(row)}component.blocksPerLine=blocksPerLine;component.blocksPerColumn=blocksPerColumn;component.blocks=blocks}frame.maxH=maxH;frame.maxV=maxV;frame.mcusPerLine=mcusPerLine;frame.mcusPerColumn=mcusPerColumn}var jfif=null;var adobe=null;var pixels=null;var frame,resetInterval;var quantizationTables=[],frames=[];var huffmanTablesAC=[],huffmanTablesDC=[];var fileMarker=readUint16();if(fileMarker!=65496)throw new Error("SOI not found");fileMarker=readUint16();while(fileMarker!=65497){var i,
j,l;switch(fileMarker){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var appData=readDataBlock();if(fileMarker===65504)if(appData[0]===74&&appData[1]===70&&appData[2]===73&&appData[3]===70&&appData[4]===0)jfif={version:{major:appData[5],minor:appData[6]},densityUnits:appData[7],xDensity:appData[8]<<8|appData[9],yDensity:appData[10]<<8|appData[11],
thumbWidth:appData[12],thumbHeight:appData[13],thumbData:appData.subarray(14,14+3*appData[12]*appData[13])};if(fileMarker===65518)if(appData[0]===65&&appData[1]===100&&appData[2]===111&&appData[3]===98&&appData[4]===101&&appData[5]===0)adobe={version:appData[6],flags0:appData[7]<<8|appData[8],flags1:appData[9]<<8|appData[10],transformCode:appData[11]};break;case 65499:var quantizationTablesLength=readUint16();var quantizationTablesEnd=quantizationTablesLength+offset-2;while(offset<quantizationTablesEnd){var quantizationTableSpec=
data[offset++];var tableData=new Int32Array(64);if(quantizationTableSpec>>4===0)for(j=0;j<64;j++){var z=dctZigZag[j];tableData[z]=data[offset++]}else if(quantizationTableSpec>>4===1)for(j=0;j<64;j++){var z=dctZigZag[j];tableData[z]=readUint16()}else throw new Error("DQT: invalid table spec");quantizationTables[quantizationTableSpec&15]=tableData}break;case 65472:case 65473:case 65474:readUint16();frame={};frame.extended=fileMarker===65473;frame.progressive=fileMarker===65474;frame.precision=data[offset++];
frame.scanLines=readUint16();frame.samplesPerLine=readUint16();frame.components={};frame.componentsOrder=[];var componentsCount=data[offset++],componentId;var maxH=0,maxV=0;for(i=0;i<componentsCount;i++){componentId=data[offset];var h=data[offset+1]>>4;var v=data[offset+1]&15;var qId=data[offset+2];frame.componentsOrder.push(componentId);frame.components[componentId]={h:h,v:v,quantizationIdx:qId};offset+=3}prepareComponents(frame);frames.push(frame);break;case 65476:var huffmanLength=readUint16();
for(i=2;i<huffmanLength;){var huffmanTableSpec=data[offset++];var codeLengths=new Uint8Array(16);var codeLengthSum=0;for(j=0;j<16;j++,offset++)codeLengthSum+=codeLengths[j]=data[offset];var huffmanValues=new Uint8Array(codeLengthSum);for(j=0;j<codeLengthSum;j++,offset++)huffmanValues[j]=data[offset];i+=17+codeLengthSum;(huffmanTableSpec>>4===0?huffmanTablesDC:huffmanTablesAC)[huffmanTableSpec&15]=buildHuffmanTable(codeLengths,huffmanValues)}break;case 65501:readUint16();resetInterval=readUint16();
break;case 65498:var scanLength=readUint16();var selectorsCount=data[offset++];var components=[],component;for(i=0;i<selectorsCount;i++){component=frame.components[data[offset++]];var tableSpec=data[offset++];component.huffmanTableDC=huffmanTablesDC[tableSpec>>4];component.huffmanTableAC=huffmanTablesAC[tableSpec&15];components.push(component)}var spectralStart=data[offset++];var spectralEnd=data[offset++];var successiveApproximation=data[offset++];var processed=decodeScan(data,offset,frame,components,
resetInterval,spectralStart,spectralEnd,successiveApproximation>>4,successiveApproximation&15);offset+=processed;break;case 65535:if(data[offset]!==255)offset--;break;default:if(data[offset-3]==255&&data[offset-2]>=192&&data[offset-2]<=254){offset-=3;break}throw new Error("unknown JPEG marker "+fileMarker.toString(16));}fileMarker=readUint16()}if(frames.length!=1)throw new Error("only single frame JPEGs supported");for(var i=0;i<frames.length;i++){var cp=frames[i].components;for(var j in cp){cp[j].quantizationTable=
quantizationTables[cp[j].quantizationIdx];delete cp[j].quantizationIdx}}this.width=frame.samplesPerLine;this.height=frame.scanLines;this.jfif=jfif;this.adobe=adobe;this.components=[];for(var i=0;i<frame.componentsOrder.length;i++){var component=frame.components[frame.componentsOrder[i]];this.components.push({lines:buildComponentData(frame,component),scaleX:component.h/frame.maxH,scaleY:component.v/frame.maxV})}},getData:function getData(width,height){var scaleX=this.width/width,scaleY=this.height/
height;var component1,component2,component3,component4;var component1Line,component2Line,component3Line,component4Line;var x,y;var offset=0;var Y,Cb,Cr,K,C,M,Ye,R,G,B;var colorTransform;var dataLength=width*height*this.components.length;var data=new Uint8Array(dataLength);switch(this.components.length){case 1:component1=this.components[0];for(y=0;y<height;y++){component1Line=component1.lines[0|y*component1.scaleY*scaleY];for(x=0;x<width;x++){Y=component1Line[0|x*component1.scaleX*scaleX];data[offset++]=
Y}}break;case 2:component1=this.components[0];component2=this.components[1];for(y=0;y<height;y++){component1Line=component1.lines[0|y*component1.scaleY*scaleY];component2Line=component2.lines[0|y*component2.scaleY*scaleY];for(x=0;x<width;x++){Y=component1Line[0|x*component1.scaleX*scaleX];data[offset++]=Y;Y=component2Line[0|x*component2.scaleX*scaleX];data[offset++]=Y}}break;case 3:colorTransform=true;if(this.adobe&&this.adobe.transformCode)colorTransform=true;else if(typeof this.colorTransform!==
"undefined")colorTransform=!!this.colorTransform;component1=this.components[0];component2=this.components[1];component3=this.components[2];for(y=0;y<height;y++){component1Line=component1.lines[0|y*component1.scaleY*scaleY];component2Line=component2.lines[0|y*component2.scaleY*scaleY];component3Line=component3.lines[0|y*component3.scaleY*scaleY];for(x=0;x<width;x++){if(!colorTransform){R=component1Line[0|x*component1.scaleX*scaleX];G=component2Line[0|x*component2.scaleX*scaleX];B=component3Line[0|
x*component3.scaleX*scaleX]}else{Y=component1Line[0|x*component1.scaleX*scaleX];Cb=component2Line[0|x*component2.scaleX*scaleX];Cr=component3Line[0|x*component3.scaleX*scaleX];R=clampTo8bit(Y+1.402*(Cr-128));G=clampTo8bit(Y-.3441363*(Cb-128)-.71413636*(Cr-128));B=clampTo8bit(Y+1.772*(Cb-128))}data[offset++]=R;data[offset++]=G;data[offset++]=B}}break;case 4:if(!this.adobe)throw"Unsupported color mode (4 components)";colorTransform=false;if(this.adobe&&this.adobe.transformCode)colorTransform=true;else if(typeof this.colorTransform!==
"undefined")colorTransform=!!this.colorTransform;component1=this.components[0];component2=this.components[1];component3=this.components[2];component4=this.components[3];for(y=0;y<height;y++){component1Line=component1.lines[0|y*component1.scaleY*scaleY];component2Line=component2.lines[0|y*component2.scaleY*scaleY];component3Line=component3.lines[0|y*component3.scaleY*scaleY];component4Line=component4.lines[0|y*component4.scaleY*scaleY];for(x=0;x<width;x++){if(!colorTransform){C=component1Line[0|x*
component1.scaleX*scaleX];M=component2Line[0|x*component2.scaleX*scaleX];Ye=component3Line[0|x*component3.scaleX*scaleX];K=component4Line[0|x*component4.scaleX*scaleX]}else{Y=component1Line[0|x*component1.scaleX*scaleX];Cb=component2Line[0|x*component2.scaleX*scaleX];Cr=component3Line[0|x*component3.scaleX*scaleX];K=component4Line[0|x*component4.scaleX*scaleX];C=255-clampTo8bit(Y+1.402*(Cr-128));M=255-clampTo8bit(Y-.3441363*(Cb-128)-.71413636*(Cr-128));Ye=255-clampTo8bit(Y+1.772*(Cb-128))}data[offset++]=
255-C;data[offset++]=255-M;data[offset++]=255-Ye;data[offset++]=255-K}}break;default:throw"Unsupported color mode";}return data},copyToImageData:function copyToImageData(imageData){var width=imageData.width,height=imageData.height;var imageDataArray=imageData.data;var data=this.getData(width,height);var i=0,j=0,x,y;var Y,K,C,M,R,G,B;switch(this.components.length){case 1:for(y=0;y<height;y++)for(x=0;x<width;x++){Y=data[i++];imageDataArray[j++]=Y;imageDataArray[j++]=Y;imageDataArray[j++]=Y;imageDataArray[j++]=
255}break;case 3:for(y=0;y<height;y++)for(x=0;x<width;x++){R=data[i++];G=data[i++];B=data[i++];imageDataArray[j++]=R;imageDataArray[j++]=G;imageDataArray[j++]=B;imageDataArray[j++]=255}break;case 4:for(y=0;y<height;y++)for(x=0;x<width;x++){C=data[i++];M=data[i++];Y=data[i++];K=data[i++];R=255-clampTo8bit(C*(1-K/255)+K);G=255-clampTo8bit(M*(1-K/255)+K);B=255-clampTo8bit(Y*(1-K/255)+K);imageDataArray[j++]=R;imageDataArray[j++]=G;imageDataArray[j++]=B;imageDataArray[j++]=255}break;default:throw"Unsupported color mode";
}}};return constructor}();
function JPEGDecoder(jpegData,opts){var defaultOpts={useTArray:false,colorTransform:true};if(opts)if(typeof opts==="object")opts={useTArray:typeof opts.useTArray==="undefined"?defaultOpts.useTArray:opts.useTArray,colorTransform:typeof opts.colorTransform==="undefined"?defaultOpts.colorTransform:opts.colorTransform};else{opts=defaultOpts;opts.useTArray=true}else opts=defaultOpts;var arr=new Uint8Array(jpegData);var decoder=new JpegImage;decoder.parse(arr);decoder.colorTransform=opts.colorTransform;
var image={width:decoder.width,height:decoder.height,data:opts.useTArray?new Uint8Array(decoder.width*decoder.height*4):new Buffer(decoder.width*decoder.height*4)};decoder.copyToImageData(image);return image};var LogView=cc.Layer.extend({ctor:function(){this._super();this.setCascadeOpacityEnabled(true);this._isDistroyed=false;this._logArray=[];this._logWebViewHtmlString="";this._logSetting={stopUpdate:false,time:true,send:true,receive:true,other:true,chatSend:false,chatReceive:false,limitNum:1E3,ignoredCmd:["_PONG","_ping","_pong","_ "]};var logViewButton=this._logViewButton=new LogViewButton(()=>{this._logWebView.setVisible(true);mainLayer.setVisible(true);logViewButton.setVisible(false);setTimeout(()=>
this._refreshLog(),100)});this.addChild(logViewButton);var mainLayer=this._mainLayer=new cc.Node;mainLayer.setVisible(false);this.addChild(mainLayer);var dummyTouch=new DummyTouchLayer(JSVisibleSize);mainLayer.addChild(dummyTouch,-1);var bgLayer=this._bgLayer=new cc.LayerColor(cc.color(0,0,0,255),JSVisibleSize.width,JSVisibleSize.height);mainLayer.addChild(bgLayer);var scrollView=this._scrollView=new cc.ScrollView;scrollView.setDirection(cc.SCROLLVIEW_DIRECTION_HORIZONTAL);mainLayer.addChild(scrollView,
10);var scrollLayer=scrollView.getContainer();var scaleRatio=JSVisibleSize.height>512?2:1;var buttonSize=this._buttonSize=cc.size(50*scaleRatio,24*scaleRatio);var editBoxSize=this._editBoxSize=cc.size(120*scaleRatio,20*scaleRatio);this._buttonArray=[[],[]];var buttonParams=[{name:"\u95dc\u9589\u756b\u9762",func:this._closeViewClicked},{name:"\u80cc\u666f\u900f\u660e\u5ea6",func:this._changeOpacityClicked},{name:"\u6e05\u9664Log",func:this._clearLogClicked},{name:"\u9001Log\u56de\u5bb6",func:this._sendLogToHomeClicked},
{name:"\u9001Socket",func:this._sendSocketClicked},{name:"\u770bDialog",func:this._checkDialogClicked}];buttonParams.forEach((param,index)=>{var buttonNodes=[];for(var i=0;i<2;i++){var node=buttonNodes[i]=new ccui.Scale9Sprite;node.setPreferredSize(buttonSize);node.setCascadeOpacityEnabled(true);node.setCascadeColorEnabled(true);var bgColor=new cc.LayerColor(cc.color(200,50,50,i===0?255:150),buttonSize.width,buttonSize.height);node.addChild(bgColor);var textLabel=new cc.LabelTTF(param.name,JSFontBoldName,
9*scaleRatio);textLabel.enableStroke(JSColor.BLACK,2*scaleRatio);textLabel.setPosition(buttonSize.width/2,buttonSize.height/2);node.addChild(textLabel)}buttonNodes[1].setColor(JSColor.GRAY);var button=this._buttonArray[0][index]=new cc.ControlButton(buttonNodes[0]);button.setBackgroundSpriteForState(buttonNodes[1],cc.CONTROL_STATE_HIGHLIGHTED);button.setTouchDirection(cc.SCROLLVIEW_DIRECTION_HORIZONTAL);button.addTargetWithActionForControlEvents(this,param.func,cc.CONTROL_EVENT_TOUCH_UP_INSIDE);button.setZoomOnTouchDown(false);
button.setSwallowTouches(false);scrollLayer.addChild(button)});var editBoxSprite1=new ccui.Scale9Sprite("select_01.png");var editBoxSprite2=new ccui.Scale9Sprite("select_01.png");editBoxSprite2.setColor(JSColor.GRAY);var inputEditBox=this._inputEditBox=new cc.EditBox(editBoxSize,editBoxSprite1,editBoxSprite2);inputEditBox.setAnchorPoint(1,.5);inputEditBox.setFontColor(JSColor.BLACK);inputEditBox.setPlaceHolder("Socket\u6307\u4ee4");inputEditBox.setReturnType(cc.KEYBOARD_RETURNTYPE_DONE);inputEditBox.setInputFlag(cc.EDITBOX_INPUT_FLAG_SENSITIVE);
inputEditBox.setInputMode(cc.EDITBOX_INPUT_MODE_SINGLELINE);inputEditBox.setCascadeOpacityEnabled(true);scrollLayer.addChild(inputEditBox);var buttonParams=[{name:"\u66ab\u505c\u66f4\u65b0",func:this._stopUpdateClicked},{name:"\u9001\u51faOFF",func:this._settingSendClicked},{name:"\u6536\u5230OFF",func:this._settingReceiveClicked},{name:"\u5176\u5b83OFF",func:this._settingOtherClicked}];var isChatSocketOpen=this._isChatSocketOpen=typeof ChatSocketBridge!=="undefined";if(isChatSocketOpen){buttonParams.push({name:this._logSetting.chatSend?
"\u804a\u5929\u51faOFF":"\u804a\u5929\u51faON",func:this._settingChatSendClicked});buttonParams.push({name:this._logSetting.chatReceive?"\u804a\u5929\u6536OFF":"\u804a\u5929\u6536ON",func:this._settingChatReceiveClicked})}buttonParams.forEach((param,index)=>{var buttonNodes=[];for(var i=0;i<2;i++){var node=buttonNodes[i]=new ccui.Scale9Sprite;node.setPreferredSize(buttonSize);node.setCascadeOpacityEnabled(true);node.setCascadeColorEnabled(true);var bgColor=new cc.LayerColor(cc.color(200,50,50,i===
0?255:150),buttonSize.width,buttonSize.height);node.addChild(bgColor);var textLabel=new cc.LabelTTF(param.name,JSFontBoldName,9*scaleRatio);textLabel.enableStroke(JSColor.BLACK,2*scaleRatio);textLabel.setPosition(buttonSize.width/2,buttonSize.height/2);node.addChild(textLabel);node.label=textLabel}buttonNodes[1].setColor(JSColor.GRAY);var button=this._buttonArray[1][index]=new cc.ControlButton(buttonNodes[0]);button.setBackgroundSpriteForState(buttonNodes[1],cc.CONTROL_STATE_HIGHLIGHTED);button.setTouchDirection(cc.SCROLLVIEW_DIRECTION_HORIZONTAL);
button.addTargetWithActionForControlEvents(this,param.func,cc.CONTROL_EVENT_TOUCH_UP_INSIDE);button.setZoomOnTouchDown(false);button.setSwallowTouches(false);scrollLayer.addChild(button)});var webView=this._logWebView=new GSWebView;webView.setVisible=function(value){cc.Node.prototype.setVisible.call(webView,value)};!cc.sys.isNative&&webView.setTransparent(true);webView.setVisible(false);mainLayer.addChild(webView);webView.setHardwareAccelerated(true);this.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){GSWebViewChecker.removeWebViewRef(webView)})));
this.refreshViewSize();DataModal.dataProcess.addSocketLogCallback(this._onSocketLog,this);isChatSocketOpen&&ChatSocketBridge.getInstance().addSocketLogCallback(this._onSocketLog,this);if(cc.sys.isNative){this._writeFilePath=JSWriteablePath+"/.tmvbsinwau";var oldLogString=jsb.fileUtils.getStringFromFile(this._writeFilePath);if(oldLogString){this._logArray=oldLogString.split("\n").map(cur=>{return{flag:0,content:cur}});var date=new Date;var hintLogParam={flag:4,content:"-------\u4ee5\u4e0a\u662f\u4e0a\u6b21\u7684Log-------",
time:date.toJSON()};this._logArray.push(hintLogParam);jsb.fileUtils.appendStringToFile(this._getLogString(date,hintLogParam),this._writeFilePath)}}},onExit:function(){DataModal.dataProcess.removeSocketLogCallback(this);this._isChatSocketOpen&&ChatSocketBridge.getInstance().removeSocketLogCallback(this);this._isDistroyed=true;this._super()},refreshViewSize:function(){var scaleRatio=JSVisibleSize.height>512?2:1;var scrollSize=cc.size(JSVisibleSize.width,54*scaleRatio);var buttonSize=this._buttonSize;
var editBoxSize=this._editBoxSize;var buttonPosX=(30+JSScreenSafeWidth)*scaleRatio;var spacingX=10*scaleRatio;var topPosY=scrollSize.height-16*scaleRatio;var logViewButton=this._logViewButton;var logViewButtonSize=logViewButton.getContentSize();logViewButton.setPosition(JSVisibleSize.width-logViewButtonSize.width,JSVisibleSize.height-logViewButtonSize.height);this._bgLayer.setContentSize(JSVisibleSize);var scrollView=this._scrollView;scrollView.setViewSize(scrollSize);scrollView.setContentSize(buttonPosX+
buttonSize.width*5+spacingX*5+editBoxSize.width,scrollSize.height);scrollView.setPosition(0,JSVisibleSize.height-scrollSize.height);this._buttonArray[0].forEach(button=>{button.setPosition(buttonPosX,topPosY);buttonPosX+=buttonSize.width+spacingX});this._inputEditBox.setPosition(buttonPosX+editBoxSize.width,topPosY);buttonPosX=(30+JSScreenSafeWidth)*scaleRatio;this._buttonArray[1].forEach(button=>{button.setPosition(buttonPosX,topPosY-26*scaleRatio);buttonPosX+=buttonSize.width+spacingX});var topSpace=
56*scaleRatio;var webView=this._logWebView;webView.setContentSize(JSVisibleSize.width-JSScreenSafeWidth*2,JSVisibleSize.height-topSpace);webView.setPosition(JSScreenMidPos.x,JSScreenMidPos.y-topSpace/2)},addIgnoreCmd:function(cmd){var ignoredCmd=this._logSetting.ignoredCmd;if(ignoredCmd.indexOf(cmd)>0)return;ignoredCmd.push(cmd)},_closeViewClicked:function(){this._logWebView.setVisible(false);this._mainLayer.setVisible(false);this._logViewButton.setVisible(true)},_changeOpacityClicked:function(){var bgLayer=
this._bgLayer;var nowOpacity=bgLayer.getOpacity();nowOpacity-=50;if(nowOpacity<0)nowOpacity=255;else if(nowOpacity<10)nowOpacity=0;bgLayer.setOpacity(nowOpacity)},_clearLogClicked:function(){this._logArray.length=0;this._logWebViewHtmlString="";this._logWebView.loadHTMLString("");cc.sys.isNative&&jsb.fileUtils.removeFile(this._writeFilePath)},_getLogString:function(date,logParam){var timeString="";if(date)timeString=JSStringUtility.format("%02d:%02d:%02d.%03d ",date.getHours(),date.getMinutes(),date.getSeconds(),
date.getMilliseconds());var actionString="";switch(logParam.flag){case 1:actionString="DataProcess \u9001\u51fa ";break;case 11:actionString="DataProcess \u88dc\u9001 ";break;case 2:actionString="DataProcess \u6536\u5230 ";break;case 5:actionString="ChatSocket \u9001\u51fa ";break;case 6:actionString="ChatSocket \u6536\u5230 ";break;default:break}return JSStringUtility.format("%s%s%s\n",timeString,actionString,logParam.content)},_sendLogToHomeClicked:function(sender){var logString="";var self=this;
sender.setVisible(false);setTimeout(function(){!self._isDistroyed&&sender.setVisible(true)},2E3);if(DataProcess.ConnectSessionLogKeyURLs)logString=DataProcess.ConnectSessionLogKeyURLs.join("\n")+"\n";else if(DataProcess.ConnectSessionLogKeyURL)logString=DataProcess.ConnectSessionLogKeyURL+"\n";var logArray=[];if(cc.sys.isNative){var oldLogString=jsb.fileUtils.getStringFromFile(this._writeFilePath);if(oldLogString)logArray=oldLogString.split("\n").map(cur=>{return{flag:0,content:cur}})}else logArray=
this._logArray;logArray.forEach(cur=>{var date;if(cur.time)date=new Date(cur.time);logString+=this._getLogString(date,cur)});var nowDate=new Date;var titleString=JSStringUtility.format("%s %02d:%02d:%02d",GS.bundleID,nowDate.getHours(),nowDate.getMinutes(),nowDate.getSeconds());var urlString=JSStringUtility.format("%s?title=%s&bundleID=%s&game=%d&userid=%s",GS.domain+"/main/connectlog3.php",encodeURIComponent(titleString),GS.bundleID,GS.gameLobbyID,GS.localStorage.getItem("LoginAccount",""));var sendLogFunc=
()=>{var postString=JSStringUtility.format("content=%s",Base64.encode(logString).replace(/\+/g,"%2B"));var xhr=new XMLHttpRequest;xhr.open("POST",urlString,true);xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.send(postString);cc.log("\u9001log\u5230 : "+urlString)};if(cc.sys.isNative)cc.loader.load("build_revision.txt",(err,txtString)=>{var bonusString="\u76ee\u524d\u904a\u6232\u7248\u672c\uff1a"+(GS.nativeBundleID||"")+" "+GS.gameVersion;if(txtString[0])bonusString+=
txtString[0];logString+="\n"+bonusString+"\n";sendLogFunc()});else sendLogFunc()},_sendSocketClicked:function(){var sendString=this._inputEditBox.getString();if(sendString.length>0)DataProcess.sendString(sendString)},_stopUpdateClicked:function(sender){this._logSetting.stopUpdate=!this._logSetting.stopUpdate;sender.getBackgroundSpriteForState(cc.CONTROL_STATE_NORMAL).label.setString(this._logSetting.stopUpdate?"\u7e7c\u7e8c":"\u66ab\u505c");sender.getBackgroundSpriteForState(cc.CONTROL_STATE_HIGHLIGHTED).label.setString(this._logSetting.stopUpdate?
"\u7e7c\u7e8c":"\u66ab\u505c");if(!this._logSetting.stopUpdate)this._refreshLog()},_settingSendClicked:function(sender){this._logSetting.send=!this._logSetting.send;sender.getBackgroundSpriteForState(cc.CONTROL_STATE_NORMAL).label.setString("\u9001\u51fa"+(this._logSetting.send?"OFF":"ON"));sender.getBackgroundSpriteForState(cc.CONTROL_STATE_HIGHLIGHTED).label.setString("\u9001\u51fa"+(this._logSetting.send?"OFF":"ON"));this._refreshLog()},_settingReceiveClicked:function(sender){this._logSetting.receive=
!this._logSetting.receive;sender.getBackgroundSpriteForState(cc.CONTROL_STATE_NORMAL).label.setString("\u6536\u5230"+(this._logSetting.receive?"OFF":"ON"));sender.getBackgroundSpriteForState(cc.CONTROL_STATE_HIGHLIGHTED).label.setString("\u6536\u5230"+(this._logSetting.receive?"OFF":"ON"));this._refreshLog()},_settingOtherClicked:function(sender){this._logSetting.other=!this._logSetting.other;sender.getBackgroundSpriteForState(cc.CONTROL_STATE_NORMAL).label.setString("\u5176\u5b83"+(this._logSetting.other?
"OFF":"ON"));sender.getBackgroundSpriteForState(cc.CONTROL_STATE_HIGHLIGHTED).label.setString("\u5176\u5b83"+(this._logSetting.other?"OFF":"ON"));this._refreshLog()},_settingChatSendClicked:function(sender){this._logSetting.chatSend=!this._logSetting.chatSend;sender.getBackgroundSpriteForState(cc.CONTROL_STATE_NORMAL).label.setString("\u804a\u5929\u9001\u51fa"+(this._logSetting.chatSend?"OFF":"ON"));sender.getBackgroundSpriteForState(cc.CONTROL_STATE_HIGHLIGHTED).label.setString("\u804a\u5929\u9001\u51fa"+
(this._logSetting.chatSend?"OFF":"ON"));this._refreshLog()},_settingChatReceiveClicked:function(sender){this._logSetting.chatReceive=!this._logSetting.chatReceive;sender.getBackgroundSpriteForState(cc.CONTROL_STATE_NORMAL).label.setString("\u804a\u5929\u63a5\u6536"+(this._logSetting.chatReceive?"OFF":"ON"));sender.getBackgroundSpriteForState(cc.CONTROL_STATE_HIGHLIGHTED).label.setString("\u804a\u5929\u63a5\u6536"+(this._logSetting.chatReceive?"OFF":"ON"));this._refreshLog()},_checkDialogClicked:function(){if(DialogManager.checkIsShowDialog()){var nowScene=
cc.director.getRunningScene();var dialogParent=nowScene.getChildByName("DialogParent");var parentChildren=dialogParent.getChildren();for(var i=0;i<parentChildren.length;i++){var child=parentChildren[i];if(!child.dialogKeyLabel){var label=child.dialogKeyLabel=new cc.LabelTTF(child.key,JSFontBoldName,16);label.setAnchorPoint(0,0);label.setPosition(JSScreenSafeWidth+10,JSVisibleSize.height-30);child.addChild(label,1E4);var labelContentSize=label.getContentSize();var layerColor=new cc.LayerColor(cc.color(0,
0,0,255),labelContentSize.width+5,labelContentSize.height+5);layerColor.setPosition(JSScreenSafeWidth+7,JSVisibleSize.height-33);child.addChild(layerColor,9999)}}}this._closeViewClicked()},_refreshLog:function(){var logString="";this._logArray.forEach(cur=>{logString+=this._getHtmlString(cur)});this._logWebViewHtmlString=logString;this._logWebView.loadHTMLString(logString)},_appendLog:function(logParam){this._logWebViewHtmlString+=this._getHtmlString(logParam);this._logWebView.loadHTMLString(this._logWebViewHtmlString)},
_getHtmlString:function(logParam){var logSetting=this._logSetting;if(!logSetting.other&&logParam.flag===0)return"";if(!logSetting.send&&logParam.flag===1)return"";if(!logSetting.receive&&(logParam.flag===2||logParam.flag===3))return"";if(!logSetting.chatSend&&logParam.flag===5)return"";if(!logSetting.chatReceive&&logParam.flag===6)return"";var color;var fontName=cc.sys.isNative?"HelveticaNeue-Bold":"Arial";var fontSize=cc.sys.isNative?"9px":"7px";switch(logParam.flag){case 0:color="white";break;case 1:color=
"#10FFFF";break;case 11:color="#109FFF";break;case 2:color="#10FF10";break;case 3:color="#A0A0A0";break;case 4:color="#FF0000";break;case 5:color="#A6B0FF";break;case 6:color="#FFB260";break}var timeString="";if(logSetting.time&&logParam.time){var date=new Date(logParam.time);timeString=JSStringUtility.format('<span style="color:%s; font-family:%s; font-size:%s;">%02d/%02d %02d:%02d:%02d</span> ',color,fontName,fontSize,date.getMonth()+1,date.getDate(),date.getHours(),date.getMinutes(),date.getSeconds())}var content=
logParam.content.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;");var contentString=JSStringUtility.format('<span style="color:%s; font-family:%s; font-size:%s;">%s</span></br>',color,fontName,fontSize,content);var logString=timeString+contentString;return logString},_onSocketLog:function(logParam){var content=logParam.content;var isIgnore=this._logSetting.ignoredCmd.some(value=>content.indexOf(value)===0);if(isIgnore)return;var date=new Date;logParam.time=date.toJSON();if(this._logArray.length>
this._logSetting.limitNum)this._logArray.shift();this._logArray.push(logParam);if(this._mainLayer.isVisible()&&!this._logSetting.stopUpdate)this._appendLog(logParam);if(cc.sys.isNative)jsb.fileUtils.appendStringToFile(this._getLogString(date,logParam),this._writeFilePath)}});var LogViewButton=cc.Node.extend({ctor:function(callback){this._super();this.setCascadeOpacityEnabled(true);this._callback=callback;var mainSprite=this._mainSprite=new cc.Sprite("common/logview_button.png");mainSprite.setOpacity(230);this.addChild(mainSprite);var spriteSize=cc.size(36,36);this.setContentSize(spriteSize);this._boundBox=cc.rect(-spriteSize.width/2,-spriteSize.height/2,spriteSize.width,spriteSize.height);this._clickReset=true;cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,
swallowTouches:true,onTouchBegan:this.onTouchBegan.bind(this),onTouchMoved:this.onTouchMoved.bind(this),onTouchEnded:this.onTouchEnded.bind(this),onTouchCancelled:this.onTouchCancelled.bind(this)},this)},onTouchBegan:function(touch,event){if(!this.isVisible())return false;for(var parentNode=this.getParent();parentNode!=null;parentNode=parentNode.getParent())if(!parentNode.isVisible())return false;var touchPos=this.convertToNodeSpace(touch.getLocation());if(cc.rectContainsPoint(this._boundBox,touchPos)){this._mainSprite.setColor(JSColor.GRAY);
return true}else return false},onTouchMoved:function(touch,event){var position=this.getParent().convertToNodeSpace(touch.getLocation());position.x=position.x<0?0:position.x>JSVisibleSize.width?JSVisibleSize.width:position.x;position.y=position.y<0?0:position.y>JSVisibleSize.height?JSVisibleSize.height:position.y;this.setPosition(position)},onTouchEnded:function(touch,event){this._mainSprite.setColor(JSColor.WHITE);if(this._clickReset){this._clickReset=false;setTimeout(()=>{this._clickReset=true},
400)}else this._callback&&this._callback()},onTouchCancelled:function(touch,event){this._mainSprite.setColor(JSColor.WHITE);this._clickReset=true}});var ImageSprite=cc.Node.extend({_urlString:null,_photoWidth:0,_photoHeight:0,_isPhotoExist:false,ctor:function(url,width,height){this._super();this.setAnchorPoint(.5,.5);this.setCascadeColorEnabled(true);this.setCascadeOpacityEnabled(true);if(JSCodeUtility.checkType(url)!=JSTYPE.STRING)url="";if(JSCodeUtility.checkType(width)!=JSTYPE.NUMBER)width=0;if(JSCodeUtility.checkType(height)!=JSTYPE.NUMBER)height=0;if(width==0||height==0){cc.assert(0,"ImageSprite \u5bec\u8ddf\u9ad8\u4e0d\u80fd\u70ba0");return}this._photoSprite=
new cc.Sprite;this._photoSprite.setPosition(width/2,height/2);this.addChild(this._photoSprite);this._urlString=url;this._photoWidth=width;this._photoHeight=height;this.setContentSize(width,height)},onEnter:function(){this._super();this.setPhotoUrlString(this._urlString)},onExit:function(){PhotoDownloadHelper.removeDelegate(this);this._super()},getPreferredSize:function(){return this.getContentSize()},setPreferredSize:function(size){this.setContentSize(size)},setPhotoUrlString:function(url){this._urlString=
url;if(url&&url.length){var texture=cc.textureCache.getTextureForKey(url);if(texture==null||!cc.sys.isNative&&!texture.isLoaded()){PhotoDownloadHelper.downloadPhoto(url,this);this._isPhotoExist=false}else{this.photoDownloadDone(texture,url);this._isPhotoExist=true}}this._updateAll()},setImageCallback:function(cb){this._photoCallback=cb;if(this._isPhotoExist)cb&&cb()},_updatePhotoByTexture:function(texture){this._photoSprite.setTexture(texture);this._photoSprite.setTextureRect(cc.rect(0,0,texture.getContentSize().width,
texture.getContentSize().height));this._updateAll()},_updateAll:function(){this._photoSprite.setScaleX(this._photoWidth/this._photoSprite.getContentSize().width);this._photoSprite.setScaleY(this._photoHeight/this._photoSprite.getContentSize().height)},photoDownloadDone:function(texture,key){if(key==this._urlString){texture&&this._updatePhotoByTexture(texture);if(this._photoCallback)this._photoCallback(texture)}}});var PhotoDownloadHelper={_delegateArray:[],_photoTextureCache:null,downloadPhoto:function(url,delegate){var findIt=false;for(var i=0;i<this._delegateArray.length;i++){var obj=this._delegateArray[i];if(obj.url===url){if(!obj.delegate.find(cur=>cur===delegate))obj.delegate.push(delegate);findIt=true;break}}if(!findIt)this._delegateArray.push({delegate:[delegate],url:url});else return;cc.log("\u958b\u59cb\u4e0b\u8f09 url = "+url);GSImageTool.addImageAsync(url,texture=>{if(texture instanceof cc.Texture2D){var len=
this._delegateArray.length;for(var i=0;i<len;i++){var obj=this._delegateArray[i];if(obj.url===url){obj.delegate.forEach(cur=>{try{cur.photoDownloadDone.call(cur,texture,url)}catch(e){cc.log("\u539f\u672c\u7684\u7269\u4ef6\u5df2\u7d93\u88ab\u780d\u6389\u4e86")}});this._delegateArray.splice(i,1);break}}this._addImageCache(texture,url)}else{var len=this._delegateArray.length;for(var i=0;i<len;i++){var obj=this._delegateArray[i];if(obj.url===url){obj.delegate.forEach(cur=>{try{cur.photoDownloadError&&
cur.photoDownloadError.call(cur,url)}catch(e){cc.log("\u539f\u672c\u7684\u7269\u4ef6\u5df2\u7d93\u88ab\u780d\u6389\u4e86")}});this._delegateArray.splice(i,1);return}}}},delegate)},removeDelegate:function(delegate){var removeArray=this._delegateArray.filter(cur=>{cur.delegate.filter(obj=>obj===delegate).forEach(target=>JSCodeUtility.removeArrayObject(cur.delegate,target));return cur.delegate.length===0});removeArray.forEach(cur=>JSCodeUtility.removeArrayObject(this._delegateArray,cur));GSImageTool.removeImageCallbackByTarget(delegate)},
_addImageCache:function(texture,url){if(!cc.sys.isNative||jsb.ENABLE_GC_FOR_NATIVE_OBJECTS)return;if(!this._photoTextureCache)this._photoTextureCache=new PhotoTextureCache;this._photoTextureCache.addTexture(texture,url)}};
var PhotoTextureCache=cc.Class.extend({ctor:function(){this._textureMap={};setInterval(_=>{var textureMap=this._textureMap;for(var key in textureMap){var texture=textureMap[key];if(texture.getReferenceCount()==2){texture.release();cc.textureCache.removeTexture(texture);delete textureMap[key]}}},10*1E3)},addTexture:function(texture,url){if(this._textureMap[url]&&this._textureMap[url]===texture)return;this._textureMap[url]=texture;texture.retain()}});var PhotoSprite=cc.Node.extend({ctor:function(url="",width=0,height=0,defaultString=""){this._super();this.setAnchorPoint(.5,.5);this.setCascadeColorEnabled(true);this.setCascadeOpacityEnabled(true);if(width===0||height===0){cc.assert(0,"PhotoSprite \u5bec\u8ddf\u9ad8\u4e0d\u80fd\u70ba0");return}this._urlString=url;this._defaultString=defaultString||"Gamesofa.png";this._photoWidth=width;this._photoHeight=height;this.setContentSize(width,height);this.setDefaultSprite(this._defaultString);var loadingSprite=
this._loadingSprite=new GSLoadingSprite;loadingSprite.setPosition(width/2,height/2);loadingSprite.setScaleX(width/128);loadingSprite.setScaleY(height/128);this.addChild(loadingSprite);this._isLoading=false},onEnter:function(){this._super();this.setPhotoUrlString(this._urlString)},onExit:function(){PhotoDownloadHelper.removeDelegate(this);this._super()},setDefaultSprite:function(defaultString){this._defaultString=defaultString||"Gamesofa.png";if(!this._photoSprite){this._photoSprite=new cc.Sprite;
this._photoSprite.setPosition(this._photoWidth/2,this._photoHeight/2);this.addChild(this._photoSprite)}this._photoSprite.setSpriteFrame(this._defaultString);var contentSize=this._photoSprite.getContentSize();this._photoSprite.setScaleX(this._photoWidth/contentSize.width);this._photoSprite.setScaleY(this._photoHeight/contentSize.height)},setPhotoUrlString:function(url,account){this.setDefaultSprite(this._defaultString);if(DataModal.blacklistData&&account&&DataModal.blacklistData.isAccountInList(account))return;
if(this._isLoading)PhotoDownloadHelper.removeDelegate(this);this._urlString=url;if(url&&url.length){var texture=cc.textureCache.getTextureForKey(url);if(texture==null||!cc.sys.isNative&&!texture.isLoaded()){this._isLoading=true;PhotoDownloadHelper.downloadPhoto(url,this);this._isPhotoExist=false}else{this._isLoading=false;this.photoDownloadDone(texture,url);this._isPhotoExist=true}}else{this._isPhotoExist=false;this._isLoading=false}this._updateAll()},setHaveBackgroundFrame:function(useFrame){if(!this._bgFrame){var width=
this._photoWidth;var height=this._photoHeight;var bgFrame=this._bgFrame=new ccui.Scale9Sprite("photo_frame.png");bgFrame.setPreferredSize(cc.size(width+4*(width/42),this._photoHeight+4*(height/42)));bgFrame.setPosition(width/2,height/2);this.addChild(bgFrame,-1)}this._bgFrame.setVisible(useFrame)},setPhotoCallback:function(cb){this._photoCallback=cb;if(this._isPhotoExist)cb&&cb()},_updatePhotoByTexture:function(texture){this._photoSprite.setTexture(texture);this._photoSprite.setTextureRect(cc.rect(0,
0,texture.getContentSize().width,texture.getContentSize().height));this._isLoading=false;this._loadingSprite.stop();this._updateAll()},_updateAll:function(){var contentSize=this._photoSprite.getContentSize();this._photoSprite.setScaleX(this._photoWidth/contentSize.width);this._photoSprite.setScaleY(this._photoHeight/contentSize.height);if(this._isLoading)this._loadingSprite.start();else this._loadingSprite.stop()},photoDownloadDone:function(texture,key){if(key===this._urlString){texture&&this._updatePhotoByTexture(texture);
if(this._photoCallback)this._photoCallback(texture)}},photoDownloadError:function(key){if(key===this._urlString)this._loadingSprite.stop()}});var PushNotification=cc.Class.extend({init:function(){if(!cc.sys.isNative)WebNotification.init()},getToken:function(){if(!cc.sys.isNative)return WebNotification.token;else return GSDeviceInfo.getPushNotifyToken()}});var WebNotification={};WebNotification.token="";
WebNotification.init=function(){var swRegistration=null;function urlB64ToUint8Array(base64String){const padding="=".repeat((4-base64String.length%4)%4);const base64=(base64String+padding).replace(/\-/g,"+").replace(/_/g,"/");const rawData=window.atob(base64);const outputArray=new Uint8Array(rawData.length);for(let i=0;i<rawData.length;++i)outputArray[i]=rawData.charCodeAt(i);return outputArray}function unsubscribeUser(){swRegistration.pushManager.getSubscription().then(function(subscription){WebNotification.token="";
if(subscription)return subscription.unsubscribe()}).catch(function(error){cc.log("Error unsubscribing",error)})}function subscribeUser(){var applicationServerKey=urlB64ToUint8Array(GS.pushNotificationServerKey);var settings={userVisibleOnly:true,applicationServerKey:applicationServerKey};GSGoogleAnalytics.logEvent("\u63a8\u64a5\u6388\u6b0a","\u8df3\u51fa\u8996\u7a97");swRegistration.pushManager.subscribe(settings).then(function(subscription){WebNotification.token=JSON.stringify(subscription);GSGoogleAnalytics.logEvent("\u63a8\u64a5\u6388\u6b0a",
"\u5141\u8a31");cc.log("Push Token:"+WebNotification.token)}).catch(function(err){if(Notification.permission==="denied")GSGoogleAnalytics.logEvent("\u63a8\u64a5\u6388\u6b0a","\u5c01\u9396");else;cc.log("Failed to subscribe the user: ",err)})}function initPushNotificationState(){if(!("showNotification"in ServiceWorkerRegistration.prototype)||!("PushManager"in window)){cc.warn("Notifications aren't supported.");return}if(Notification.permission==="denied"){cc.warn("The user has blocked notifications.");
return}swRegistration.pushManager.getSubscription().then(function(subscription){var isSubscribed=!(subscription===null);if(!isSubscribed){cc.log("User is not subscribed");subscribeUser()}else{WebNotification.token=JSON.stringify(subscription);cc.log("Push Token:"+WebNotification.token)}}).catch(function(err){WebNotification.token="";cc.warn("Error during getSubscription()",err)})}if("serviceWorker"in navigator&&"PushManager"in window)navigator.serviceWorker.register("sw.js").then(function(swReg){cc.log("Service Worker is registered",
swReg);swRegistration=swReg;initPushNotificationState()}).catch(function(error){cc.error("Service Worker Error",error)});else cc.warn("Push messaging is not supported")};var GSSpine=GSSpine||{};
(function(){GSSpine._loadFileWithZip=function(filePath,onLoaded){var oReq=new XMLHttpRequest;oReq.open("GET",filePath,true);var self=this;oReq.overrideMimeType("text/plain; charset=x-user-defined");oReq.responseType="blob";oReq.onload=function(oEvent){var files=[];var totalFiles=0;zip.useWebWorkers=false;zip.createReader(new zip.BlobReader(oReq.response),function(zipReader){zipReader.getEntries(function(entries){totalFiles=entries.length;for(var index in entries){var entry=entries[index];function loader(entry){entry.getData(new zip.BlobWriter,
function(blob){var tmp=/(?:\.([^.]+))?$/.exec(entry.filename);var ext=typeof tmp[1]!="undefined"?tmp[1]:null;var fileReader=new FileReader;fileReader.onload=function(){if(ext==="atlas"||ext==="json")files[entry.filename]=this.result;else if(ext==="png")files[entry.filename]="data:image/png;base64,"+this.result.replace(/^[^,]+,/,"");totalFiles--;if(totalFiles==0){var result={files:files};if(onLoaded)onLoaded(result)}};if(ext==="atlas"||ext==="json")fileReader.readAsText(blob);else fileReader.readAsDataURL(blob)})}
loader(entry)}})})};oReq.onreadystatechange=function(oEvent){if(oReq.readyState==4)if(oReq.status>=200&&oReq.status<400);else{cc.log("Zip\u8b80\u53d6\u5931\u6557 URL="+filePath);onLoaded(null)}};oReq.send()};GSSpine.createWebWithBundle=function(zipFilePath,scale,callback,errorCallback){if(!cc.sys.isNative)GSSpine._loadFileWithZip(zipFilePath,function(data){if(data){var savePath=zipFilePath.replace(".zip","");var basename=cc.path.basename(savePath);var atlasFileName=basename+".atlas";var jsonFileName=
basename+".json";var pngFileName=basename+".png";var fileList=data.files;var createSpineFunction=texture=>{var atlasLoad=function(line){var tex=new sp.SkeletonTexture({width:texture.getPixelsWide(),height:texture.getPixelsHigh()});tex.setRealTexture(texture);return tex};var atlasData=fileList[atlasFileName];var atlas=new spine.TextureAtlas(atlasData,atlasLoad);var attachmentLoader=new spine.AtlasAttachmentLoader(atlas);var skeletonJsonReader=new spine.SkeletonJson(attachmentLoader);skeletonJsonReader.scale=
scale;var skeletonJson=JSON.parse(fileList[jsonFileName]);var skeletonData=skeletonJsonReader.readSkeletonData(skeletonJson);atlas.dispose(skeletonJsonReader);var avatar=new sp.SkeletonAnimation(skeletonData,atlas,scale);callback&&callback(avatar)};var texture=cc.textureCache.getTextureForKey(savePath+".png");if(!texture){var image=new Image;image.addEventListener("load",function(){cc.textureCache.cacheImage(savePath+".png",image);var texture=cc.textureCache.getTextureForKey(savePath+".png");createSpineFunction(texture);
image=null});image.src=fileList[pngFileName]}else createSpineFunction(texture)}else if(errorCallback)errorCallback();else callback(null)});else if(errorCallback)errorCallback();else callback(null)};GSSpine.create=function(url,scale,callback){if(cc.sys.isNative){var avatar=new sp.SkeletonAnimation(url+".json",url+".atlas",scale);callback&&callback(avatar)}else{url=url.replace(".zip","");GS.loadSpine(url,()=>{var avatar=new sp.SkeletonAnimation(url+".json",url+".atlas",scale);callback&&callback(avatar)})}};
GSSpine.createAndDownloadWithBundle=function(zipFilePath,saveZipPath,scale,callback,errorCallback){if(arguments.length>2&&typeof arguments[2]!=="number"){cc.warn("GSSpine\u8981\u8a2d\u5b9ascale\u5594");if(arguments.length>3)errorCallback=arguments[3];callback=arguments[2];scale=.25}var savePath=saveZipPath.replace(".zip","");var spinFileList=GSSpine.getFileList(savePath);if(cc.sys.isNative&&saveZipPath){var fileCount=0;for(var i=0;i<spinFileList.length;i++)if(jsb.fileUtils.isFileExist(spinFileList[i]))fileCount++;
if(fileCount===spinFileList.length)return GSSpine.create(savePath,scale,callback);else{var fileName=saveZipPath.replace(JSWriteablePath,"");var isInApp=jsb.fileUtils.isFileExist(fileName);if(isInApp)if(cc.sys.os===cc.sys.OS_IOS)return GSSpine.create(savePath,scale,callback);else{var gafData=jsb.fileUtils.getDataFromFile(fileName);var targetArr=zipFilePath.split("/");var filename=targetArr.pop();var directoryPath=targetArr.join("/");if(!jsb.fileUtils.isDirectoryExist(directoryPath))jsb.fileUtils.createDirectory(directoryPath);
var success=jsb.fileUtils.writeDataToFile(gafData,zipFilePath);if(success)return GSSpine.create(savePath,scale,callback)}var downloaderCallback=new GSDownloaderCallback(this);downloaderCallback.onTaskSuccess=function(){var unzipSuccess=CodeUtility.unzipToSameDirByFileName(saveZipPath);jsb.fileUtils.removeFile(saveZipPath);if(unzipSuccess)GSSpine.create(savePath,scale,callback);else if(errorCallback)errorCallback();else callback(null)};downloaderCallback.onTaskError=function(task,errorCode,errorCodeInternal,
errorStr){jsb.fileUtils.removeFile(saveZipPath);if(errorCallback)errorCallback();else callback(null)};GSDownloaderManager.addDownloader(zipFilePath,saveZipPath,null,downloaderCallback)}}else return GSSpine.createWebWithBundle(zipFilePath,scale,callback,errorCallback)};GSSpine.getFileList=function(file){var resources;if(Array.isArray(file))resources=file;else resources=[file+".json",file+".atlas",file+".png"];return resources}}).call(window||module||{});/*
 JavaScript Cookie v2.1.3
 https://github.com/js-cookie/js-cookie

 Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 Released under the MIT license
*/
var Cookie;
(function(factory){var registeredInModuleLoader=false;if(typeof define==="function"&&define.amd){define(factory);registeredInModuleLoader=true}if(typeof exports==="object"){module.exports=factory();registeredInModuleLoader=true}if(!registeredInModuleLoader){var OldCookies=window.Cookies;var api=Cookie=window.Cookies=factory();api.noConflict=function(){window.Cookies=OldCookies;return api}}})(function(){function extend(){var i=0;var result={};for(;i<arguments.length;i++){var attributes=arguments[i];
for(var key in attributes)result[key]=attributes[key]}return result}function init(converter){function api(key,value,attributes){var result;if(typeof document==="undefined")return;if(arguments.length>1){attributes=extend({path:"/"},api.defaults,attributes);if(typeof attributes.expires==="number"){var expires=new Date;expires.setMilliseconds(expires.getMilliseconds()+attributes.expires*864E5);attributes.expires=expires}try{result=JSON.stringify(value);if(/^[\{\[]/.test(result))value=result}catch(e){}if(!converter.write)value=
encodeURIComponent(String(value)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent);else value=converter.write(value,key);key=encodeURIComponent(String(key));key=key.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent);key=key.replace(/[\(\)]/g,escape);return document.cookie=[key,"=",value,attributes.expires?"; expires="+attributes.expires.toUTCString():"",attributes.path?"; path="+attributes.path:"",attributes.domain?"; domain="+attributes.domain:"",attributes.secure?
"; secure":""].join("")}if(!key)result={};var cookies=document.cookie?document.cookie.split("; "):[];var rdecode=/(%[0-9A-Z]{2})+/g;var i=0;for(;i<cookies.length;i++){var parts=cookies[i].split("=");var cookie=parts.slice(1).join("=");if(cookie.charAt(0)==='"')cookie=cookie.slice(1,-1);try{var name=parts[0].replace(rdecode,decodeURIComponent);cookie=converter.read?converter.read(cookie,name):converter(cookie,name)||cookie.replace(rdecode,decodeURIComponent);if(this.json)try{cookie=JSON.parse(cookie)}catch(e){}if(key===
name){result=cookie;break}if(!key)result[name]=cookie}catch(e){}}return result}api.set=api;api.get=function(key){return api.call(api,key)};api.getJSON=function(){return api.apply({json:true},[].slice.call(arguments))};api.defaults={};api.remove=function(key,attributes){api(key,"",extend(attributes,{expires:-1}))};api.withConverter=init;return api}return init(function(){})});!function(e){function n(){}function t(e,n){return function(){e.apply(n,arguments)}}function o(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(e,this)}function i(e,n){for(;3===e._state;)e=e._value;return 0===e._state?void e._deferreds.push(n):(e._handled=!0,void o._immediateFn(function(){var t=1===e._state?n.onFulfilled:n.onRejected;
if(null===t)return void(1===e._state?r:u)(n.promise,e._value);var o;try{o=t(e._value)}catch(i){return void u(n.promise,i)}r(n.promise,o)}))}function r(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var i=n.then;if(n instanceof o)return e._state=3,e._value=n,void f(e);if("function"==typeof i)return void s(t(i,n),e)}e._state=1,e._value=n,f(e)}catch(r){u(e,r)}}function u(e,n){e._state=2,e._value=n,f(e)}function f(e){2===
e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var n=0,t=e._deferreds.length;n<t;n++)i(e,e._deferreds[n]);e._deferreds=null}function c(e,n,t){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.promise=t}function s(e,n){var t=!1;try{e(function(e){t||(t=!0,r(n,e))},function(e){t||(t=!0,u(n,e))})}catch(o){if(t)return;t=!0,u(n,o)}}var a=setTimeout;o.prototype["catch"]=function(e){return this.then(null,
e)},o.prototype.then=function(e,t){var o=new this.constructor(n);return i(this,new c(e,t,o)),o},o.all=function(e){var n=Array.prototype.slice.call(e);return new o(function(e,t){function o(r,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var f=u.then;if("function"==typeof f)return void f.call(u,function(e){o(r,e)},t)}n[r]=u,0===--i&&e(n)}catch(c){t(c)}}if(0===n.length)return e([]);for(var i=n.length,r=0;r<n.length;r++)o(r,n[r])})},o.resolve=function(e){return e&&"object"==typeof e&&e.constructor===
o?e:new o(function(n){n(e)})},o.reject=function(e){return new o(function(n,t){t(e)})},o.race=function(e){return new o(function(n,t){for(var o=0,i=e.length;o<i;o++)e[o].then(n,t)})},o._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){a(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn&&console.warn("Possible Unhandled Promise Rejection:",e)},o._setImmediateFn=function(e){o._immediateFn=e},o._setUnhandledRejectionFn=function(e){o._unhandledRejectionFn=
e},"undefined"!=typeof module&&module.exports?module.exports=o:e.Promise||(e.Promise=o)}(window||module||{});
if(!Array.prototype.find)Object.defineProperty(Array.prototype,"find",{value:function(predicate){if(this==null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof predicate!=="function")throw new TypeError("predicate must be a function");var list=Object(this);var length=list.length>>>0;var thisArg=arguments[1];var value;for(var i=0;i<length;i++){value=list[i];if(predicate.call(thisArg,value,i,list))return value}return undefined}});
if(!Array.prototype.findIndex)Object.defineProperty(Array.prototype,"findIndex",{value:function(predicate){if(this==null)throw new TypeError("Array.prototype.findIndex called on null or undefined");if(typeof predicate!=="function")throw new TypeError("predicate must be a function");var list=Object(this);var length=list.length>>>0;var thisArg=arguments[1];var value;for(var i=0;i<length;i++){value=list[i];if(predicate.call(thisArg,value,i,list))return i}return-1},enumerable:false,configurable:false,
writable:false});"function"!=typeof Object.assign&&(Object.assign=function(n,t){if(null==n)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(n),e=1;e<arguments.length;e++){var o=arguments[e];if(null!=o)for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])}return r});
Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function r(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(a,e){return Array.isArray(e)?a.push.apply(a,r.call(e,t-1)):a.push(e),a},[]):Array.prototype.slice.call(this)},writable:!0});
!function(a,b,c,d,e,f,g,h,i){function j(a){var b,c=a.length,e=this,f=0,g=e.i=e.j=0,h=e.S=[];for(c||(a=[c++]);d>f;)h[f]=f++;for(f=0;d>f;f++)h[f]=h[g=s&g+a[f%c]+(b=h[f])],h[g]=b;(e.g=function(a){for(var b,c=0,f=e.i,g=e.j,h=e.S;a--;)b=h[f=s&f+1],c=c*d+h[s&(h[f]=h[g=s&g+b])+(h[g]=b)];return e.i=f,e.j=g,c})(d)}function k(a,b){var c,d=[],e=typeof a;if(b&&"object"==e)for(c in a)try{d.push(k(a[c],b-1))}catch(f){}return d.length?d:"string"==e?a:a+"\x00"}function l(a,b){for(var c,d=a+"",e=0;e<d.length;)b[s&
e]=s&(c^=19*b[s&e])+d.charCodeAt(e++);return n(b)}function m(c){try{return o?n(o.randomBytes(d)):(a.crypto.getRandomValues(c=new Uint8Array(d)),n(c))}catch(e){return[+new Date,a,(c=a.navigator)&&c.plugins,a.screen,n(b)]}}function n(a){return String.fromCharCode.apply(0,a)}var o,p=c.pow(d,e),q=c.pow(2,f),r=2*q,s=d-1,t=c["seed"+i]=function(a,f,g){var h=[];f=1==f?{entropy:!0}:f||{};var o=l(k(f.entropy?[a,n(b)]:null==a?m():a,3),h),s=new j(h);return l(n(s.S),b),(f.pass||g||function(a,b,d){return d?(c[i]=
a,b):a})(function(){for(var a=s.g(e),b=p,c=0;q>a;)a=(a+c)*d,b*=d,c=s.g(1);for(;a>=r;)a/=2,b/=2,c>>>=1;return(a+c)/b},o,"global"in f?f.global:this==c)};if(l(c[i](),b),g&&g.exports){g.exports=t;try{o=require("crypto")}catch(u){}}else h&&h.amd&&h(function(){return t})}(this,[],Math,256,6,52,"object"==typeof module&&module,"function"==typeof define&&define,"random");
!function(e,u){"function"==typeof define&&define.amd?define(["module","exports"],u):"undefined"!=typeof exports?u(module,exports):(u(u={exports:{}},u.exports),e.EmojiCharString=u.exports)}(this,function(e,u){function t(e,u){for(var f=0;f<u.length;f++){var t=u[f];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}Object.defineProperty(u,"__esModule",{value:!0});var f=/\ud83c[\udffb-\udfff](?=\ud83c[\udffb-\udfff])|(?:[^\ud800-\udfff][\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]?|[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?)*/g,
n=(function(e,u,f){return u&&t(e.prototype,u),f&&t(e,f),e}(r,[{key:"toString",value:function(){return this._string}},{key:"reverse",value:function(){return this._match.reverse().join("")}},{key:"substring",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,u=arguments[1],f=this.length,e=!((parseInt(e,10)||0)<0)&&parseInt(e,10)||0,t=void 0;return(t=f<(t=void 0===u?f:!((parseInt(u,10)||0)<0)&&parseInt(u,10)||0)?f:t)<(e=f<e?f:e)&&(e=(u=[t,e])[0],t=u[1]),this._match.slice(e,
t).join("")}},{key:"substr",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,u=arguments[1],f=this.length,e=parseInt(e,10)||0,t=void 0;return f<=e||u<=0?"":(e<0&&(e=Math.max(0,e+f)),t=void 0===u?f:e+(parseInt(u,10)||0),this._match.slice(e,t).join(""))}},{key:"length",get:function(){return this._match.length}}]),r);function r(e){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");if("string"!=typeof e)throw new Error("Input must be a string");
this._string=e,this._match=e.match(f)||[]}u.default=n,e.exports=u.default});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ES6Promise=e()}(window||module||{},function(){function t(t){return"function"==typeof t}var e=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},n=0,r=void 0,o=void 0,i=function(t,e){h[n]=t,h[n+1]=e,2===(n+=2)&&(o?o(p):m())};var s="undefined"!=typeof window?window:void 0,u=s||{},c=u.MutationObserver||u.WebKitMutationObserver,
a="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function l(){var t=setTimeout;return function(){return t(p,1)}}var h=new Array(1E3);function p(){for(var t=0;t<n;t+=2)(0,h[t])(h[t+1]),h[t]=void 0,h[t+1]=void 0;n=0}var v,d,_,y,m=void 0;function w(t,e){var n=arguments,r=this,o=new this.constructor(A);void 0===o[g]&&N(o);var s,u=r._state;
return u?(s=n[u-1],i(function(){return K(u,o,s,r._result)})):k(r,o,t,e),o}function b(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(A);return x(e,t),e}a?m=function(){return process.nextTick(p)}:c?(d=0,_=new c(p),y=document.createTextNode(""),_.observe(y,{characterData:!0}),m=function(){y.data=d=++d%2}):f?((v=new MessageChannel).port1.onmessage=p,m=function(){return v.port2.postMessage(0)}):m=void 0===s&&"function"==typeof require?function(){try{var t=require("vertx");return void 0!==
(r=t.runOnLoop||t.runOnContext)?function(){r(p)}:l()}catch(t){return l()}}():l();var g=Math.random().toString(36).substring(16);function A(){}var j=void 0,S=1,E=2,T=new F;function M(t){try{return t.then}catch(t){return T.error=t,T}}function P(e,n,r){n.constructor===e.constructor&&r===w&&n.constructor.resolve===b?function(t,e){e._state===S?O(t,e._result):e._state===E?Y(t,e._result):k(e,void 0,function(e){return x(t,e)},function(e){return Y(t,e)})}(e,n):r===T?Y(e,T.error):void 0===r?O(e,n):t(r)?function(t,
e,n){i(function(t){var r=!1,o=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(n,e,function(n){r||(r=!0,e!==n?x(t,n):O(t,n))},function(e){r||(r=!0,Y(t,e))},t._label);!r&&o&&(r=!0,Y(t,o))},t)}(e,n,r):O(e,n)}function x(t,e){var n;t===e?Y(t,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(n=e)||"object"==typeof n&&null!==n?P(t,e,M(e)):O(t,e)}function C(t){t._onerror&&t._onerror(t._result),q(t)}function O(t,e){t._state===j&&(t._result=e,t._state=S,0!==t._subscribers.length&&
i(q,t))}function Y(t,e){t._state===j&&(t._state=E,t._result=e,i(C,t))}function k(t,e,n,r){var o=t._subscribers,s=o.length;t._onerror=null,o[s]=e,o[s+S]=n,o[s+E]=r,0===s&&t._state&&i(q,t)}function q(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?K(n,r,o,i):o(i);t._subscribers.length=0}}function F(){this.error=null}var D=new F;function K(e,n,r,o){var i=t(r),s=void 0,u=void 0,c=void 0,a=void 0;if(i){if((s=function(t,e){try{return t(e)}catch(t){return D.error=
t,D}}(r,o))===D?(a=!0,u=s.error,s=null):c=!0,n===s)return void Y(n,new TypeError("A promises callback cannot return that same promise."))}else s=o,c=!0;n._state!==j||(i&&c?x(n,s):a?Y(n,u):e===S?O(n,s):e===E&&Y(n,s))}var L=0;function N(t){t[g]=L++,t._state=void 0,t._result=void 0,t._subscribers=[]}function U(t,n){this._instanceConstructor=t,this.promise=new t(A),this.promise[g]||N(this.promise),e(n)?(this._input=n,this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===
this.length?O(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&O(this.promise,this._result))):Y(this.promise,new Error("Array Methods must be provided an Array"))}function W(t){this[g]=L++,this._result=this._state=void 0,this._subscribers=[],A!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}(),this instanceof W?function(t,e){try{e(function(e){x(t,e)},function(e){Y(t,
e)})}catch(e){Y(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}())}return U.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===j&&n<t;n++)this._eachEntry(e[n],n)},U.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===b){var o=M(t);if(o===w&&t._state!==j)this._settledAt(t._state,e,t._result);else if("function"!=
typeof o)this._remaining--,this._result[e]=t;else if(n===W){var i=new n(A);P(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},U.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===j&&(this._remaining--,t===E?Y(r,n):this._result[e]=n),0===this._remaining&&O(r,this._result)},U.prototype._willSettleAt=function(t,e){var n=this;k(t,void 0,function(t){return n._settledAt(S,e,t)},function(t){return n._settledAt(E,e,
t)})},W.all=function(t){return(new U(this,t)).promise},W.race=function(t){var n=this;return e(t)?new n(function(e,r){for(var o=t.length,i=0;i<o;i++)n.resolve(t[i]).then(e,r)}):new n(function(t,e){return e(new TypeError("You must pass an array to race."))})},W.resolve=b,W.reject=function(t){var e=new this(A);return Y(e,t),e},W._setScheduler=function(t){o=t},W._setAsap=function(t){i=t},W._asap=i,W.prototype={constructor:W,then:w,catch:function(t){return this.then(null,t)}},W.polyfill=function(){var t=
void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment");}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=W},W.Promise=W,W});
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.axios=t():e.axios=t()}(window||module||{},function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){var r=n(2),o=n(3),s=n(4);function i(e){var t=
new s(e),n=o(s.prototype.request,t);return r.extend(n,s.prototype,t),r.extend(n,t),n}var a=i();a.Axios=s,a.create=function(e){return i(e)},a.Cancel=n(22),a.CancelToken=n(23),a.isCancel=n(19),a.all=function(e){return Promise.all(e)},a.spread=n(24),e.exports=a,e.exports.default=a},function(e,t,n){var r=n(3),o=Object.prototype.toString;function s(e){return"[object Array]"===o.call(e)}function i(e){return null!==e&&"object"==typeof e}function a(e){return"[object Function]"===o.call(e)}function u(e,t){if(null!=
e)if("object"==typeof e||s(e)||(e=[e]),s(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:s,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},
isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:i,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:a,isStream:function(e){return i(e)&&a(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return"undefined"!=
typeof window&&"undefined"!=typeof document&&"function"==typeof document.createElement},forEach:u,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,o=arguments.length;r<o;r++)u(arguments[r],n);return t},extend:function(e,t,n){return u(t,function(t,o){e[o]=n&&"function"==typeof t?r(t,n):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t){e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),
r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){var r=n(5),o=n(2),s=n(16),i=n(17),a=n(20),u=n(21);function c(e){this.defaults=o.merge(r,e),this.interceptors={request:new s,response:new s}}c.prototype.request=function(e){"string"==typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),(e=o.merge(r,this.defaults,{method:"get"},e)).baseURL&&!a(e.url)&&(e.url=u(e.baseURL,e.url));var t=[i,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,
e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},o.forEach(["delete","get","head"],function(e){c.prototype[e]=function(t,n){return this.request(o.merge(n||{},{method:e,url:t}))}}),o.forEach(["post","put","patch"],function(e){c.prototype[e]=function(t,n,r){return this.request(o.merge(r||{},{method:e,url:t,data:n}))}}),e.exports=c},function(e,t,n){var r,o=n(2),s=n(6),i=/^\)\]\}',?\n/,a={"Content-Type":"application/x-www-form-urlencoded"};
function u(e,t){!o.isUndefined(e)&&o.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}e.exports={adapter:("undefined"!=typeof XMLHttpRequest?r=n(7):"undefined"!=typeof process&&(r=n(7)),r),transformRequest:[function(e,t){return s(t,"Content-Type"),o.isFormData(e)||o.isArrayBuffer(e)||o.isStream(e)||o.isFile(e)||o.isBlob(e)?e:o.isArrayBufferView(e)?e.buffer:o.isURLSearchParams(e)?(u(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):o.isObject(e)?(u(t,"application/json;charset=utf-8"),
JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e){e=e.replace(i,"");try{e=JSON.parse(e)}catch(e){}}return e}],headers:{common:{Accept:"application/json, text/plain, */*"},patch:o.merge(a),post:o.merge(a),put:o.merge(a)},timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}}},function(e,t,n){var r=n(2);e.exports=function(e,t){r.forEach(e,function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&
(e[t]=n,delete e[r])})}},function(e,t,n){var r=n(2),o=n(8),s=n(11),i=n(12),a=n(13),u=n(9),c="undefined"!=typeof window&&window.btoa||n(14);e.exports=function(e){return new Promise(function(t,f){var p=e.data,l=e.headers;r.isFormData(p)&&delete l["Content-Type"];var d=new XMLHttpRequest,h="onreadystatechange",m=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in d||a(e.url)||(d=new window.XDomainRequest,h="onload",m=!0,d.onprogress=function(){},d.ontimeout=function(){}),e.auth){var y=
e.auth.username||"",w=e.auth.password||"";l.Authorization="Basic "+c(y+":"+w)}if(d.open(e.method.toUpperCase(),s(e.url,e.params,e.paramsSerializer),!0),d.timeout=e.timeout,d[h]=function(){if(d&&(4===d.readyState||m)&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in d?i(d.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?d.response:d.responseText,status:1223===d.status?204:d.status,statusText:1223===d.status?"No Content":
d.statusText,headers:n,config:e,request:d};o(t,f,r),d=null}},d.onerror=function(){f(u("Network Error",e)),d=null},d.ontimeout=function(){f(u("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED")),d=null},r.isStandardBrowserEnv()){var g=n(15),v=(e.withCredentials||a(e.url))&&e.xsrfCookieName?g.read(e.xsrfCookieName):void 0;v&&(l[e.xsrfHeaderName]=v)}if("setRequestHeader"in d&&r.forEach(l,function(e,t){void 0===p&&"content-type"===t.toLowerCase()?delete l[t]:d.setRequestHeader(t,e)}),e.withCredentials&&
(d.withCredentials=!0),e.responseType)try{d.responseType=e.responseType}catch(e){if("json"!==d.responseType)throw e;}"function"==typeof e.onDownloadProgress&&d.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){d&&(d.abort(),f(e),d=null)}),void 0===p&&(p=null),d.send(p)})}},function(e,t,n){var r=n(9);e.exports=function(e,t,n){var o=n.config.validateStatus;
n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n)):e(n)}},function(e,t,n){var r=n(10);e.exports=function(e,t,n,o){var s=new Error(e);return r(s,t,n,o)}},function(e,t){e.exports=function(e,t,n,r){return e.config=t,n&&(e.code=n),e.response=r,e}},function(e,t,n){var r=n(2);function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=
function(e,t,n){if(!t)return e;var s;if(n)s=n(t);else if(r.isURLSearchParams(t))s=t.toString();else{var i=[];r.forEach(t,function(e,t){null!=e&&(r.isArray(e)&&(t+="[]"),r.isArray(e)||(e=[e]),r.forEach(e,function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),i.push(o(t)+"="+o(e))}))}),s=i.join("&")}return s&&(e+=(-1===e.indexOf("?")?"?":"&")+s),e}},function(e,t,n){var r=n(2);e.exports=function(e){var t,n,o,s={};return e?(r.forEach(e.split("\n"),function(e){o=e.indexOf(":"),
t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t&&(s[t]=s[t]?s[t]+", "+n:n)}),s):s}},function(e,t,n){var r=n(2);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,
""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=r.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function r(){this.message="String contains an invalid character"}r.prototype=new Error,r.prototype.code=5,r.prototype.name="InvalidCharacterError",e.exports=function(e){for(var t,
o,s=String(e),i="",a=0,u=n;s.charAt(0|a)||(u="=",a%1);i+=u.charAt(63&t>>8-a%1*8)){if((o=s.charCodeAt(a+=.75))>255)throw new r;t=t<<8|o}return i}},function(e,t,n){var r=n(2);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,s,i){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+(new Date(n)).toGMTString()),r.isString(o)&&a.push("path="+o),r.isString(s)&&a.push("domain="+s),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+
e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864E5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){var r=n(2);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){r.forEach(this.handlers,function(t){null!==t&&e(t)})},
e.exports=o},function(e,t,n){var r=n(2),o=n(18),s=n(19),i=n(5);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||i.adapter)(e).then(function(t){return a(e),t.data=o(t.data,t.headers,e.transformResponse),
t},function(t){return s(t)||(a(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){var r=n(2);e.exports=function(e,t,n){return r.forEach(n,function(n){e=n(e,t)}),e}},function(e,t){e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t){e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t){e.exports=function(e,t){return e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,"")}},function(e,t){function n(e){this.message=
e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t,n){var r=n(22);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new r(e),t(n.reason))})}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason;},o.source=function(){var e;return{token:new o(function(t){e=t}),cancel:e}},
e.exports=o},function(e,t){e.exports=function(e){return function(t){return e.apply(null,t)}}}])});var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(input){var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;input=Base64._utf8_encode(input);while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=(chr1&3)<<4|chr2>>4;enc3=(chr2&15)<<2|chr3>>6;enc4=chr3&63;if(isNaN(chr2))enc3=enc4=64;else if(isNaN(chr3))enc4=64;output=output+this._keyStr.charAt(enc1)+this._keyStr.charAt(enc2)+
this._keyStr.charAt(enc3)+this._keyStr.charAt(enc4)}return output},decode:function(input){var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace(/[^A-Za-z0-9\+\/=]/g,"");while(i<input.length){enc1=this._keyStr.indexOf(input.charAt(i++));enc2=this._keyStr.indexOf(input.charAt(i++));enc3=this._keyStr.indexOf(input.charAt(i++));enc4=this._keyStr.indexOf(input.charAt(i++));chr1=enc1<<2|enc2>>4;chr2=(enc2&15)<<4|enc3>>2;chr3=(enc3&3)<<6|enc4;output=output+String.fromCharCode(chr1);
if(enc3!=64)output=output+String.fromCharCode(chr2);if(enc4!=64)output=output+String.fromCharCode(chr3)}output=Base64._utf8_decode(output);return output},_utf8_encode:function(string){string=string.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128)utftext+=String.fromCharCode(c);else if(c>127&&c<2048){utftext+=String.fromCharCode(c>>6|192);utftext+=String.fromCharCode(c&63|128)}else{utftext+=String.fromCharCode(c>>12|224);utftext+=String.fromCharCode(c>>
6&63|128);utftext+=String.fromCharCode(c&63|128)}}return utftext},_utf8_decode:function(utftext){var string="";var i=0;var c=0;var c2=0;var c3=0;while(i<utftext.length){c=utftext.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);i++}else if(c>191&&c<224){c2=utftext.charCodeAt(i+1);string+=String.fromCharCode((c&31)<<6|c2&63);i+=2}else{c2=utftext.charCodeAt(i+1);c3=utftext.charCodeAt(i+2);string+=String.fromCharCode((c&15)<<12|(c2&63)<<6|c3&63);i+=3}}return string}};
(function(root,factory){if(typeof define==="function"&&define.amd)define([],function(){factory(root)});else factory(root)})(typeof exports!=="undefined"?exports:window||module||{},function(root){if(root.atob){try{root.atob(" ")}catch(e){root.atob=function(atob){var func=function(string){return atob(String(string).replace(/[\t\n\f\r ]+/g,""))};func.original=atob;return func}(root.atob)}return}var b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b64re=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/;
root.btoa=function(string){string=String(string);var bitmap,a,b,c,result="",i=0,rest=string.length%3;for(;i<string.length;){if((a=string.charCodeAt(i++))>255||(b=string.charCodeAt(i++))>255||(c=string.charCodeAt(i++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");bitmap=a<<16|b<<8|c;result+=b64.charAt(bitmap>>18&63)+b64.charAt(bitmap>>12&63)+b64.charAt(bitmap>>6&63)+b64.charAt(bitmap&63)}return rest?result.slice(0,
rest-3)+"===".substring(rest):result};root.atob=function(string){string=String(string).replace(/[\t\n\f\r ]+/g,"");if(!b64re.test(string))throw new TypeError("Failed to execute 'atob' on 'Window': The string to be decoded is not correctly encoded.");string+="==".slice(2-(string.length&3));var bitmap,result="",r1,r2,i=0;for(;i<string.length;){bitmap=b64.indexOf(string.charAt(i++))<<18|b64.indexOf(string.charAt(i++))<<12|(r1=b64.indexOf(string.charAt(i++)))<<6|(r2=b64.indexOf(string.charAt(i++)));result+=
r1===64?String.fromCharCode(bitmap>>16&255):r2===64?String.fromCharCode(bitmap>>16&255,bitmap>>8&255):String.fromCharCode(bitmap>>16&255,bitmap>>8&255,bitmap&255)}return result}});var BaseDialogLayer=cc.Layer.extend({initProperties:function(){this.key="";this.openNeedAnimation=true;this.removeWhenOnExit=true;this._openAnimationDone=false;this.tempHide=false;this.hidingVisible=false;this.isLockBackKey=false;this.dialogBgColor=cc.color(0,0,0,DIALOG_BG_OPACITY);this.loadFileArray=[];this._loadFileDone=false;this._webView=undefined;this.__willCloseCallback=null;this.__closeCallback=null;this.__hideCallback=null;this.__openWorldPos=undefined},ctor:function(){this._super();this.initProperties();
this.setCascadeOpacityEnabled(true);var dummyTouch=this._dummyTouch=new DummyTouchLayer(JSVisibleSize);this.addChild(dummyTouch,-1E4);this._addBackgroundLayer();var aniLayer=this._animationNode=this._animationLayer=new cc.Layer;aniLayer.setCascadeColorEnabled(true);aniLayer.setCascadeOpacityEnabled(true);aniLayer.setScale(0);aniLayer.setContentSize(JSVisibleSize);this.addChild(aniLayer)},onEnter:function(){this._super();if(cc.sys.isNative||this.loadFileArray.length===0)this.loadFileDone();else{this.addLoadingLayer();
cc.loader.load(this.loadFileArray,()=>{this.loadFileDone()})}PushScene.addBackKeyEnableLayer(this)},onExit:function(){PushScene.removeBackKeyEnableLayer(this);this.removeWhenOnExit&&DialogManager.removeDialog(this);this._super()},keyBackPressed:function(){if(this.isLockBackKey)return;this._closeDialogAnimation()},addLoadingLayer:function(){var aniLayer=this._animationLayer;this.removeLoadingLayer();var loadingLayer=this._loadingLayer=new cc.LayerColor(this.dialogBgColor,JSVisibleSize.width,JSVisibleSize.height);
aniLayer.addChild(loadingLayer,Number.MAX_VALUE);var loadingSprite=new GSLoadingSprite;loadingSprite.setPosition(JSScreenMidPos);loadingSprite.start();loadingLayer.addChild(loadingSprite,999999)},removeLoadingLayer:function(){if(this._loadingLayer){this._loadingLayer.removeFromParent();this._loadingLayer=null}},loadFileDone:function(){this._loadFileDone=true;this.removeLoadingLayer()},removeDummyTouchLayer:function(){if(this._dummyTouch){this._dummyTouch.removeFromParent();this._dummyTouch=null}},
setVisible:function(isVisible){this._super(isVisible);this._webView&&this._webView.setVisible(isVisible);if(isVisible)PushScene.addBackKeyEnableLayer(this);else PushScene.removeBackKeyEnableLayer(this)},setTempHide:function(value){if(this.tempHide===value)return;this.tempHide=value;if(this.tempHide){this.hidingVisible=this.isVisible();this.setVisible(false)}else this.setVisible(this.hidingVisible);value&&this.__hideCallback&&this.__hideCallback()},setWillCloseCallback:function(callback){this.__willCloseCallback=
callback},setCloseCallback:function(callback){this.__closeCallback=callback},setHideCallback:function(callback){this.__hideCallback=callback},setOpenWorldPosition:function(pos){this.__openWorldPos=pos},startDialogAnimation:function(){this._startDialogAnimation()},closeDialogAnimation:function(){this._closeDialogAnimation()},_addBackgroundLayer:function(){this._bgColorLayer=new cc.LayerColor(cc.color(0,0,0,0),JSVisibleSize.width,JSVisibleSize.height);this.addChild(this._bgColorLayer,-1E4)},_dialogOpenAnimationDone:function(){this._openAnimationDone=
true},_dialogCloseAnimationDone:function(){},_startDialogAnimation:function(){var aniLayer=this._animationLayer;var bgColorLayer=this._bgColorLayer;if(this.openNeedAnimation&&!this._openAnimationDone){aniLayer.stopAllActions();if(this.__openWorldPos){var toPos=cc.pSub(this.convertToNodeSpace(this.__openWorldPos),JSScreenMidPos);aniLayer.setPosition(toPos);aniLayer.runAction(cc.sequence(cc.spawn(cc.moveTo(DIALOG_ANIMATION_TIME,cc.p(0,0)),cc.scaleTo(DIALOG_ANIMATION_TIME,1)),cc.callFunc(function(){this._dialogOpenAnimationDone()},
this)))}else aniLayer.runAction(cc.sequence(cc.scaleTo(DIALOG_ANIMATION_TIME,1).easing(cc.easeBackOut()),cc.callFunc(function(){this._dialogOpenAnimationDone()},this)));if(bgColorLayer){bgColorLayer.stopAllActions();var toColor=this.dialogBgColor;bgColorLayer.runAction(cc.tintTo(DIALOG_ANIMATION_TIME,toColor.r,toColor.g,toColor.b));bgColorLayer.runAction(cc.fadeTo(DIALOG_ANIMATION_TIME,toColor.a))}}else{aniLayer.stopAllActions();aniLayer.setScale(1);if(bgColorLayer){bgColorLayer.stopAllActions();
bgColorLayer.setColor(this.dialogBgColor);bgColorLayer.setOpacity(this.dialogBgColor.a)}if(!this._openAnimationDone)this._dialogOpenAnimationDone()}},_stopDialogAnimation:function(){this._animationLayer.stopAllActions();this._bgColorLayer&&this._bgColorLayer.stopAllActions()},_closeDialogAnimation:function(){if(this._closeAnimation||this.__isDestroyed)return;var aniLayer=this._animationLayer;var bgColorLayer=this._bgColorLayer;var dummyTouch=new DummyTouchLayer(JSVisibleSize);this.addChild(dummyTouch,
99999);aniLayer.stopAllActions();if(this.__openWorldPos){var toPos=cc.pSub(this.convertToNodeSpace(this.__openWorldPos),JSScreenMidPos);aniLayer.runAction(cc.spawn(cc.moveTo(DIALOG_ANIMATION_TIME,toPos),cc.scaleTo(DIALOG_ANIMATION_TIME,0)))}else aniLayer.runAction(cc.scaleTo(DIALOG_ANIMATION_TIME,0).easing(cc.easeBackIn()));if(bgColorLayer){bgColorLayer.stopAllActions();bgColorLayer.runAction(cc.fadeTo(DIALOG_ANIMATION_TIME,0))}this.__willCloseCallback&&this.__willCloseCallback();this.stopAllActions();
this.runAction(cc.sequence(cc.delayTime(DIALOG_ANIMATION_TIME),cc.callFunc(()=>{this._dialogCloseAnimationDone();this.__closeCallback&&this.__closeCallback();this._webView&&this._webView.removeFromParent()}),cc.removeSelf()));this._closeAnimation=true}});var ButtonUtility={};
ButtonUtility.createBtnLabel=function(title,fontSize,color,normalImage,highlightImage,disableImage,rect){var sprite=new ccui.Scale9Sprite(normalImage);var label=new cc.LabelTTF(title,JSFontBoldName,fontSize);label.setFontFillColor(color);var button=new cc.ControlButton(label,sprite);button.setPreferredSize(cc.size(rect.width,rect.height));button.setZoomOnTouchDown(false);if(highlightImage){label=new cc.LabelTTF(title,JSFontBoldName,fontSize);label.setFontFillColor(color);label.setOpacity(150);var sprite2=
new ccui.Scale9Sprite(highlightImage);sprite2.setColor(JSColor.GRAY);button.setBackgroundSpriteForState(sprite2,cc.CONTROL_STATE_HIGHLIGHTED);button.setTitleLabelForState(label,cc.CONTROL_STATE_HIGHLIGHTED)}if(disableImage){label=new cc.LabelTTF(title,JSFontBoldName,fontSize);label.setFontFillColor(color);label.setOpacity(100);var sprite3=new ccui.Scale9Sprite(disableImage);sprite3.setColor(JSColor.GRAY);button.setBackgroundSpriteForState(sprite3,cc.CONTROL_STATE_DISABLED);button.setTitleLabelForState(label,
cc.CONTROL_STATE_DISABLED)}button.setPosition(rect.x,rect.y);return button};
ButtonUtility.createBtnNoneLabel=function(normalImage,highlightImage,disableImage,rect,setGray=true,iconData){var sprite=new ccui.Scale9Sprite(normalImage);rect=rect||cc.rect(0,0,sprite.getContentSize().width,sprite.getContentSize().height);var button=new cc.ControlButton(sprite);button.setPreferredSize(cc.size(rect.width,rect.height));button.setZoomOnTouchDown(false);if(highlightImage){var sprite2=new ccui.Scale9Sprite(highlightImage);button.setBackgroundSpriteForState(sprite2,cc.CONTROL_STATE_HIGHLIGHTED)}if(disableImage){var sprite3=
new ccui.Scale9Sprite(disableImage);setGray&&sprite3.setColor(JSColor.GRAY);button.setBackgroundSpriteForState(sprite3,cc.CONTROL_STATE_DISABLED)}if(iconData){var iconSprite=new cc.Sprite(iconData.image);var offset=iconData.offset||cc.p(0,0);iconSprite.setPosition(sprite.getContentSize().width/2+offset.x,sprite.getContentSize().height/2+offset.y);sprite.addChild(iconSprite);if(sprite2){iconSprite=new cc.Sprite(iconData.image);iconSprite.setPosition(sprite2.getContentSize().width/2+offset.x,sprite2.getContentSize().height/
2+offset.y-2);sprite2.addChild(iconSprite)}if(sprite3){iconSprite=new cc.Sprite(iconData.image);iconSprite.setPosition(sprite3.getContentSize().width/2+offset.x,sprite3.getContentSize().height/2+offset.y);sprite3.addChild(iconSprite)}}button.setPosition(rect.x,rect.y);return button};
ButtonUtility.createBtnLabelWithUnderLine=function(title,fontSize,color,lineOffsetY){var itemNode=[];for(var i=0;i<3;i++){var node=itemNode[i]=new ccui.Scale9Sprite;node.setCascadeColorEnabled(true);node.setCascadeOpacityEnabled(true);var titleLabel=node.label=new cc.LabelTTF(title,JSFontBoldName,fontSize);var contentSize=titleLabel.getContentSize();var midPos=cc.p(contentSize.width/2,contentSize.height/2);titleLabel.setPosition(midPos);color&&titleLabel.setFontFillColor(color);node.addChild(titleLabel);
var line=new cc.LayerColor(color,contentSize.width,1);line.setPosition(0,lineOffsetY||0);node.addChild(line);node.setPreferredSize(contentSize);node.setContentSize(contentSize);if(i===1)node.setColor(JSColor.GRAY);else if(i===2)node.setOpacity(150)}return itemNode};
ButtonUtility.createSingleScale9Nodes=function(image,size,title,fontSize,fontColor){var itemNode=[];for(var i=0;i<3;i++){var node=itemNode[i]=new ccui.Scale9Sprite;node.setCascadeColorEnabled(true);node.setCascadeOpacityEnabled(true);var bgSprite=null;if(image[0]==="#")bgSprite=node.bg=new cc.Sprite(image);else bgSprite=node.bg=new ccui.Scale9Sprite(image);if(!size)size=bgSprite.getContentSize();else bgSprite.setPreferredSize&&bgSprite.setPreferredSize(size);bgSprite.setPosition(size.width/2,size.height/
2);node.addChild(bgSprite);if(title){var titleLabel=node.label=new cc.LabelTTF(title,JSFontBoldName,fontSize);fontColor&&titleLabel.setFontFillColor(fontColor);titleLabel.setPosition(size.width/2,size.height/2);node.addChild(titleLabel)}node.setPreferredSize(size);node.setContentSize(size);if(i===1)node.setColor(JSColor.GRAY);else if(i===2)node.setOpacity(150)}return itemNode};
ButtonUtility.createPressScale9Nodes=function(images,size,title,fontSize,fontColor,offsetY=5){images=images||[];if(JSCodeUtility.checkType(images)!==JSTYPE.ARRAY)images=[images];var itemNode=[];for(var i=0;i<3;i++){var node=itemNode[i]=new ccui.Scale9Sprite;node.setCascadeColorEnabled(true);node.setCascadeOpacityEnabled(true);var bgSprite=null;var image=images[i]||images[0];if(image[0]==="#"){bgSprite=node.bg=new cc.Sprite(image);size=size||(size=bgSprite.getContentSize())}else{bgSprite=node.bg=new ccui.Scale9Sprite(image);
bgSprite.setPreferredSize(size)}bgSprite.setPosition(size.width/2,size.height/2);node.addChild(bgSprite);if(title)if(title[0]==="#"){var titleSprite=node.word=new cc.Sprite(title);titleSprite.setPosition(cc.pAdd(bgSprite.getPosition(),cc.p(0,offsetY-(i===1?offsetY:0))));node.addChild(titleSprite)}else{var titleLabel=node.word=new cc.LabelTTF(title,JSFontBoldName,fontSize);fontColor&&titleLabel.setFontFillColor(fontColor);titleLabel.setPosition(cc.pAdd(bgSprite.getPosition(),cc.p(0,offsetY-(i===1?
offsetY:0))));node.addChild(titleLabel)}node.setPreferredSize(size);node.setContentSize(size)}itemNode[2].setColor(JSColor.GRAY);return itemNode};
ButtonUtility.createSingleScale9NodesWithIcon=function(image,size,icon,iconScale,title,fontSize,fontColor,offset){var itemNode=ButtonUtility.createSingleScale9Nodes(image,size);var midPos=cc.p(size.width/2,size.height/2);itemNode.forEach(node=>{var titleLabel;var iconSp;if(title){titleLabel=node.label=new cc.LabelTTF(title,JSFontBoldName,fontSize);titleLabel.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);fontColor&&titleLabel.setFontFillColor(fontColor);node.addChild(titleLabel)}if(icon){iconSp=
node.iconSp=new cc.Sprite(icon);iconScale&&iconSp.setScale(iconScale);node.addChild(iconSp)}if(iconSp&&titleLabel){var halfOffset=offset?offset/2:0;iconSp.setPosition(midPos.x-titleLabel.getContentSize().width/2-halfOffset,midPos.y);titleLabel.setPosition(midPos.x+iconSp.getBoundingBox().width/2+halfOffset,midPos.y)}else{iconSp&&iconSp.setPosition(midPos);titleLabel&&titleLabel.setPosition(midPos)}});return itemNode};
ButtonUtility.createArrayScale9NodesWithIcon=function(image,size,icon,iconScale,title,fontSize,fontColor,offset,isVerticalLayout){var itemNode=ButtonUtility.createArrayScale9Nodes(image,size);var midPos=cc.p(size.width/2,size.height/2);itemNode.forEach(node=>{var titleLabel;var iconSp;if(title){titleLabel=node.label=new cc.LabelTTF(title,JSFontBoldName,fontSize);fontColor&&titleLabel.setFontFillColor(fontColor);node.addChild(titleLabel)}if(icon){iconSp=node.iconSp=new cc.Sprite(icon);iconScale&&iconSp.setScale(iconScale);
node.addChild(iconSp)}if(iconSp&&titleLabel){var halfOffset=offset?offset/2:0;if(isVerticalLayout){iconSp.setPosition(midPos.x,midPos.y+titleLabel.getContentSize().height/2+halfOffset);titleLabel.setPosition(midPos.x,midPos.y-iconSp.getBoundingBox().height/2-halfOffset)}else{iconSp.setPosition(midPos.x-titleLabel.getContentSize().width/2-halfOffset,midPos.y);titleLabel.setPosition(midPos.x+iconSp.getBoundingBox().width/2+halfOffset,midPos.y)}}else{iconSp&&iconSp.setPosition(midPos);titleLabel&&titleLabel.setPosition(midPos)}});
return itemNode};
ButtonUtility.createEmptyNodes=function(size,titles,fontSize,fontColors,fontOffset=cc.p(0,0)){var itemNode=[];titles=titles||[];if(JSCodeUtility.checkType(titles)!==JSTYPE.ARRAY)titles=[titles];fontColors=fontColors||[];if(JSCodeUtility.checkType(fontColors)!==JSTYPE.ARRAY)fontColors=[fontColors];var titlePos=cc.pAdd(cc.p(size.width/2,size.height/2),fontOffset);for(var i=0;i<3;i++){var node=itemNode[i]=new ccui.Scale9Sprite;node.setCascadeColorEnabled(true);node.setCascadeOpacityEnabled(true);node.setContentSize(size);
if(titles&&titles.length){var titleLabel=node.label=new cc.LabelTTF(titles[i]||titles[0],JSFontBoldName,fontSize);if(fontColors.length){var color=fontColors[i]||fontColors[0];titleLabel.setFontFillColor(color);if(color.a)titleLabel.setOpacity(color.a)}titleLabel.setPosition(titlePos);node.addChild(titleLabel)}if(i===1)node.setColor(JSColor.GRAY);else if(i===2)node.setOpacity(150)}return itemNode};
ButtonUtility.createImageNodes=function(images,size,wordImages,wordImagesOffset=cc.p(0,0)){var itemNode=[];images=images||[];if(JSCodeUtility.checkType(images)!==JSTYPE.ARRAY)images=[images];wordImages=wordImages||[];if(JSCodeUtility.checkType(wordImages)!==JSTYPE.ARRAY)wordImages=[wordImages];for(var i=0;i<3;i++){var node=itemNode[i]=new ccui.Scale9Sprite;node.setCascadeColorEnabled(true);node.setCascadeOpacityEnabled(true);var bgSprite=node.bg=new cc.Sprite(images[i]||images[0]);var wordSprite=
node.word=new cc.Sprite(wordImages[i]||wordImages[0]);node.addChild(bgSprite);size=size||bgSprite.getContentSize();bgSprite.setPosition(size.width/2,size.height/2);if(wordSprite){wordSprite.setPosition(cc.pAdd(cc.p(size.width/2,size.height/2),wordImagesOffset));node.addChild(wordSprite)}node.setPreferredSize(size);node.setContentSize(size);if(i===1)node.setColor(JSColor.GRAY);else if(i===2)node.setOpacity(150)}return itemNode};
ButtonUtility.createArrayScale9Nodes=function(images,size,titles,fontSize,fontColors,fontOffsets=cc.p(0,0)){var itemNode=[];titles=titles||[];if(JSCodeUtility.checkType(titles)!==JSTYPE.ARRAY)titles=[titles];fontColors=fontColors||[];if(JSCodeUtility.checkType(fontColors)!==JSTYPE.ARRAY)fontColors=[fontColors];if(JSCodeUtility.checkType(fontOffsets)!==JSTYPE.ARRAY)fontOffsets=[fontOffsets];for(var i=0;i<images.length;i++){var node=itemNode[i]=new ccui.Scale9Sprite;node.setCascadeColorEnabled(true);
node.setCascadeOpacityEnabled(true);var bgSprite=null;if(!size){bgSprite=node.bg=new cc.Sprite(images[i]);size=bgSprite.getContentSize()}else if(images[i][0]==="#")bgSprite=node.bg=new cc.Sprite(images[i]);else{bgSprite=node.bg=new ccui.Scale9Sprite(images[i]);bgSprite.setPreferredSize(size)}bgSprite.setPosition(size.width/2,size.height/2);node.addChild(bgSprite);if(titles&&titles.length){var titleLabel=node.label=new GSAutoSizeLabel(titles[i]||titles[0],JSFontBoldName,fontSize,size,cc.TEXT_ALIGNMENT_CENTER,
cc.VERTICAL_TEXT_ALIGNMENT_CENTER);if(fontColors.length){var color=fontColors[i]||fontColors[0];titleLabel.setFontFillColor(color);if(color.a)titleLabel.setOpacity(color.a)}titleLabel.setPosition(cc.pAdd(cc.p(size.width/2,size.height/2),fontOffsets[i]||fontOffsets[0]));node.addChild(titleLabel)}node.setPreferredSize(size);node.setContentSize(size);if(i===1)node.setColor(JSColor.GRAY);else if(i===2)node.setOpacity(150)}return itemNode};
ButtonUtility.createArrayScale9NodesWithImageArray=function(images,size,titles,fontSize,fontColors,fontOffsets=cc.p(0,0)){images=images||[];if(JSCodeUtility.checkType(images)!==JSTYPE.ARRAY)images=[images,images,images];return ButtonUtility.createArrayScale9Nodes(images,size,titles,fontSize,fontColors,fontOffsets)};
ButtonUtility.createSingleScale9SpriteNodes=function(images,size,wordImages,wordImagesOffset=cc.p(0,0)){var itemNode=[];images=images||[];if(JSCodeUtility.checkType(images)!==JSTYPE.ARRAY)images=[images];wordImages=wordImages||[];if(JSCodeUtility.checkType(wordImages)!==JSTYPE.ARRAY)wordImages=[wordImages];if(JSCodeUtility.checkType(wordImagesOffset)!==JSTYPE.ARRAY)wordImagesOffset=[wordImagesOffset];for(var i=0;i<3;i++){var node=itemNode[i]=new ccui.Scale9Sprite;node.setCascadeColorEnabled(true);
node.setCascadeOpacityEnabled(true);var bgSprite=node.bg=new ccui.Scale9Sprite(images[i]||images[0]);var wordSprite=node.word=new cc.Sprite(wordImages[i]||wordImages[0]);node.addChild(bgSprite);if(!size)if(bgSprite)size=bgSprite.getContentSize();else if(wordSprite)size=wordSprite.getContentSize();else size=cc.size(0,0);else bgSprite.setPreferredSize(size);bgSprite.setPosition(size.width/2,size.height/2);if(wordSprite){wordSprite.setPosition(cc.pAdd(cc.p(size.width/2,size.height/2),wordImagesOffset[i]||
wordImagesOffset[0]));node.addChild(wordSprite)}node.setPreferredSize(size);node.setContentSize(size);if(i===1)node.setColor(JSColor.GRAY);else if(i===2)node.setOpacity(150)}return itemNode};
ButtonUtility.createSpriteWithSpritesNodes=function(bgImages,itemImages,itemOffset){var itemNode=[];bgImages=bgImages||[];if(JSCodeUtility.checkType(bgImages)!==JSTYPE.ARRAY)bgImages=[bgImages];itemImages=itemImages||[];if(JSCodeUtility.checkType(itemImages)!==JSTYPE.ARRAY)itemImages=[itemImages];itemOffset=itemOffset||[cc.p(0,0)];if(JSCodeUtility.checkType(itemOffset)!==JSTYPE.ARRAY)itemOffset=[itemOffset];for(var i=0;i<3;i++){var node=itemNode[i]=new ccui.Scale9Sprite;node.setCascadeColorEnabled(true);
node.setCascadeOpacityEnabled(true);var bgSprite=null;var itemSprite=null;var size=cc.size(0,0);var offset=itemOffset[i]||itemOffset[0];bgSprite=node.bg=new cc.Sprite(bgImages[i]||bgImages[0]);itemSprite=node.item=new cc.Sprite(itemImages[i]||itemImages[0]);if(bgSprite)size=bgSprite.getContentSize();else if(itemSprite)size=itemSprite.getContentSize();bgSprite.setPosition(size.width/2,size.height/2);node.addChild(bgSprite);if(itemSprite){itemSprite.setPosition(size.width/2+offset.x,size.height/2+offset.y);
node.addChild(itemSprite)}node.setPreferredSize(size);node.setContentSize(size);if(i===1)node.setColor(JSColor.GRAY);else if(i===2)node.setOpacity(150)}return itemNode};
ButtonUtility.createSingleSpriteWithSpritesNodes=function(bg,size,images,vertical=false,imgsOffset=[]){var itemNode=[];images=images||[];if(JSCodeUtility.checkType(images)!==JSTYPE.ARRAY)images=[images];imgsOffset=imgsOffset||[];if(JSCodeUtility.checkType(imgsOffset)!==JSTYPE.ARRAY)imgsOffset=[imgsOffset];for(var i=0;i<3;i++){var node=itemNode[i]=new ccui.Scale9Sprite;node.setCascadeColorEnabled(true);node.setCascadeOpacityEnabled(true);node.imgs=[];var bgSprite=null;if(bg){if(!size)bgSprite=node.bg=
new cc.Sprite(bg);else if(bg[0]==="#")bgSprite=node.bg=new cc.Sprite(bg);else bgSprite=node.bg=new ccui.Scale9Sprite(bg);node.addChild(bgSprite)}var lenArray=[];if(images&&images.length){var eachLen=0;images.forEach((cur,i)=>{var img=node.imgs[i]=new cc.Sprite(cur);node.addChild(img);if(vertical){lenArray.push(img.getContentSize().height);eachLen=img.getContentSize().width>eachLen?img.getContentSize().width:eachLen}else{lenArray.push(img.getContentSize().width);eachLen=img.getContentSize().height>
eachLen?img.getContentSize().height:eachLen}});var totalLen=lenArray.reduce((sum,val)=>sum+val)}if(!size)if(bg)size=bgSprite.getContentSize();else size=cc.size(totalLen,eachLen);else bg[0]!=="#"&&bgSprite.setPreferredSize(size);bgSprite.setPosition(size.width/2,size.height/2);if(lenArray.length)if(vertical){var baseY=size.height/2+totalLen/2;node.imgs.forEach((cur,x)=>{var imgOffset=imgsOffset[x]=imgsOffset[x]||cc.p(0,0);cur.setPosition(cc.pAdd(cc.p(size.width/2,baseY-lenArray[x]/2),imgOffset));baseY-=
lenArray[x]})}else{var baseX=size.width/2-totalLen/2;node.imgs.forEach((cur,x)=>{var imgOffset=imgsOffset[x]=imgsOffset[x]||cc.p(0,0);cur.setPosition(cc.pAdd(cc.p(baseX+lenArray[x]/2,size.height/2),imgOffset));baseX+=lenArray[x]})}node.setPreferredSize(size);node.setContentSize(size);if(i===1)node.setColor(JSColor.GRAY);else if(i===2)node.setOpacity(150)}return itemNode};
ButtonUtility.createSingleSpriteWithSideWordNodes=function(bg,title,fontSize,fontColor,titleDir,nodeSize=null,space=0,isBottomLine=false){var type,direction;switch(titleDir){case "RIGHT":type=GSAutoLayout.TYPE.HORIZONTAL;direction=GSAutoLayout.DIRECTION.NORMAL;break;case "LEFT":type=GSAutoLayout.TYPE.HORIZONTAL;direction=GSAutoLayout.DIRECTION.REVERSE;break;case "BOTTOM":type=GSAutoLayout.TYPE.VERTICAL;direction=GSAutoLayout.DIRECTION.NORMAL;break;case "TOP":type=GSAutoLayout.TYPE.VERTICAL;direction=
GSAutoLayout.DIRECTION.REVERSE;break}var itemNode=[];for(var i=0;i<3;i++){var autoLayout=itemNode[i]=new GSAutoLayoutNode;autoLayout.setType(type);autoLayout.setDirection(direction);autoLayout.setSpace(space);if(nodeSize!==null)autoLayout.setNodeSize(nodeSize.width,nodeSize.height);if(typeof bg==="string")autoLayout.addChild(new cc.Sprite(bg));else{if(!JSCodeUtility.isArray(bg))bg=[bg];else if(!bg[i])return itemNode;autoLayout.addChild(bg[i])}if(title){var titleLabel=autoLayout.label=new cc.LabelTTF(title,
JSFontBoldName,fontSize);fontColor&&titleLabel.setFontFillColor(fontColor);if(isBottomLine){var titleSize=titleLabel.getContentSize();var titleNode=new cc.Node;titleNode.setContentSize(titleSize);titleNode.setCascadeColorEnabled(true);titleNode.setCascadeOpacityEnabled(true);autoLayout.addChild(titleNode);var line=autoLayout.line=new cc.LayerColor(fontColor?fontColor:JSColor.WHITE,titleSize.width,1);line.setPositionY(titleSize.height/2-8);titleNode.addChild(line);titleLabel.setPosition(titleSize.width/
2,titleSize.height/2);titleNode.addChild(titleLabel)}else autoLayout.addChild(titleLabel)}}itemNode[1].setColor(JSColor.GRAY);itemNode[2].setOpacity(150);return itemNode};
ButtonUtility.createSingleSpriteWithSideItemNodes=function(bg,item,itemDir,nodeSize=null,space=0){var type,direction;switch(itemDir){case "RIGHT":type=GSAutoLayout.TYPE.HORIZONTAL;direction=GSAutoLayout.DIRECTION.NORMAL;break;case "LEFT":type=GSAutoLayout.TYPE.HORIZONTAL;direction=GSAutoLayout.DIRECTION.REVERSE;break;case "BOTTOM":type=GSAutoLayout.TYPE.VERTICAL;direction=GSAutoLayout.DIRECTION.NORMAL;break;case "TOP":type=GSAutoLayout.TYPE.VERTICAL;direction=GSAutoLayout.DIRECTION.REVERSE;break}var itemNode=
[];for(var i=0;i<3;i++){var autoLayout=itemNode[i]=new GSAutoLayoutNode;autoLayout.setType(type);autoLayout.setDirection(direction);autoLayout.setSpace(space);if(nodeSize!==null)autoLayout.setNodeSize(nodeSize.width,nodeSize.height);autoLayout.addChild(new cc.Sprite(bg));if(item){var itemSp=itemNode[i].item=new cc.Sprite(item);autoLayout.addChild(itemSp)}}itemNode[1].setColor(JSColor.GRAY);itemNode[2].setOpacity(150);return itemNode};
ButtonUtility.createSimpleTabNodes=function(images,size,titles,fontSize,fontColors,fontOffsets=[cc.p(0,0)],bgSizeOffsets,bgPosOffsets){bgSizeOffsets=bgSizeOffsets||[];if(JSCodeUtility.checkType(bgSizeOffsets)!==JSTYPE.ARRAY)bgSizeOffsets=[bgSizeOffsets];bgPosOffsets=bgPosOffsets||[];if(JSCodeUtility.checkType(bgPosOffsets)!==JSTYPE.ARRAY)bgPosOffsets=[bgPosOffsets];fontColors=fontColors||[cc.color(255,255,255,160),cc.color(255,255,255,255),cc.color(255,255,255,255)];var itemNodes=ButtonUtility.createArrayScale9Nodes(images,
size,titles,fontSize,fontColors,fontOffsets);(bgSizeOffsets.length||bgPosOffsets.length)&&itemNodes.forEach((node,i)=>{var bgSizeOffset=bgSizeOffsets[i];if(bgSizeOffset){node.bg.setPreferredSize(cc.size(size.width+bgSizeOffset.width,size.height+bgSizeOffset.height));node.bg.setPosition((size.width+bgSizeOffset.width)/2,(size.height+bgSizeOffset.height)/2)}var bgPosOffset=bgPosOffsets[i];if(bgPosOffset)node.bg.setPosition(cc.pAdd(node.bg.getPosition(),bgPosOffset))});itemNodes[1].setColor(JSColor.WHITE);
itemNodes[2].setOpacity(255);return itemNodes};
ButtonUtility.createWordImageTabNodes=function(images,size,wordImages,wordImagesOffset=[cc.p(0,0)],bgSizeOffsets,bgPosOffsets){bgSizeOffsets=bgSizeOffsets||[];if(JSCodeUtility.checkType(bgSizeOffsets)!==JSTYPE.ARRAY)bgSizeOffsets=[bgSizeOffsets];bgPosOffsets=bgPosOffsets||[];if(JSCodeUtility.checkType(bgPosOffsets)!==JSTYPE.ARRAY)bgPosOffsets=[bgPosOffsets];var itemNodes=ButtonUtility.createSingleScale9SpriteNodes(images,size,wordImages,wordImagesOffset);(bgSizeOffsets.length||bgPosOffsets.length)&&
itemNodes.forEach((node,i)=>{var bgSizeOffset=bgSizeOffsets[i];if(bgSizeOffset){node.bg.setPreferredSize(cc.size(size.width+bgSizeOffset.width,size.height+bgSizeOffset.height));node.bg.setPosition((size.width+bgSizeOffset.width)/2,(size.height+bgSizeOffset.height)/2)}var bgPosOffset=bgPosOffsets[i];if(bgPosOffset)node.bg.setPosition(cc.pAdd(node.bg.getPosition(),bgPosOffset))});itemNodes[1].setColor(JSColor.WHITE);itemNodes[2].setOpacity(255);return itemNodes};
ButtonUtility.createBtnSpriteArray=function(normalSpName,selectedSpName,disableSpName){var spriteArray=[];if(normalSpName){var sprite=new cc.Sprite(normalSpName);spriteArray.push(sprite);selectedSpName=selectedSpName!==undefined?selectedSpName:normalSpName;sprite=new cc.Sprite(selectedSpName);sprite.setColor(JSColor.GRAY);spriteArray.push(sprite);disableSpName=disableSpName!==undefined?disableSpName:normalSpName;sprite=new cc.Sprite(disableSpName);sprite.setOpacity(150);spriteArray.push(sprite)}return spriteArray};
ButtonUtility.createCheckBoxMenuItem=function(images,string,fontSize=26,fontColor=JSColor.WHITE){var toggleItems=[];for(var i=0;i<2;i++){var itemNode=[];for(var j=0;j<2;j++){var node=itemNode[j]=new cc.Node;node.setCascadeColorEnabled(true);node.setCascadeOpacityEnabled(true);var select=new cc.Sprite(images[i]);select.setAnchorPoint(0,.5);var selectSize=select.getBoundingBox();node.addChild(select);var labelSize=cc.size(0,0);if(string){var titleLabel=new cc.LabelTTF(string,JSFontBoldName,fontSize);
titleLabel.setFontFillColor(fontColor);titleLabel.setAnchorPoint(0,.5);node.addChild(titleLabel);labelSize=titleLabel.getContentSize()}var btnSize=cc.size(selectSize.width+labelSize.width+4,selectSize.height);node.setContentSize(btnSize);select.setPosition(0,btnSize.height/2);titleLabel&&titleLabel.setPosition(selectSize.width+8,btnSize.height/2);if(j===1)node.setColor(JSColor.GRAY)}toggleItems[i]=new cc.MenuItemSprite(itemNode[0],itemNode[1])}return toggleItems};
ButtonUtility.createSimpleButton=function(bgImage,btnSize,title,fontColor=JSColor.WHITE,fontSize=12){var btnBgSprite=new ccui.Scale9Sprite(bgImage);btnSize=btnSize||btnBgSprite.getContentSize();var button=new GSControlButton(null,btnSize);btnBgSprite.setPreferredSize(btnSize);button.addChildToContentNode(btnBgSprite);button.bg=btnBgSprite;if(title){var btnTitle=new cc.LabelTTF(title,JSFontBoldName,fontSize);btnTitle.setFontFillColor(fontColor);button.addChildToContentNode(btnTitle);button.label=btnTitle}return button};
ButtonUtility.createSimpleImageButton=function(bgImage,btnSize,wordImage){var btnBgSprite=new ccui.Scale9Sprite(bgImage);btnSize=btnSize||btnBgSprite.getContentSize();var button=new GSControlButton(null,btnSize);btnBgSprite.setPreferredSize(btnSize);button.addChildToContentNode(btnBgSprite);button.bg=btnBgSprite;if(wordImage){var btnWordSprite=new cc.Sprite(wordImage);button.addChildToContentNode(btnWordSprite);button.wordImage=btnWordSprite}return button};
ButtonUtility.createTextUnderLineButton=function(title,color=JSColor.WHITE,fontSize=12){var titleLabel=new cc.LabelTTF(title,JSFontBoldName,fontSize);titleLabel.setFontFillColor(color);var size=titleLabel.getContentSize();var button=new GSControlButton(null,size);button.addChildToContentNode(titleLabel);var line=new cc.LayerColor(color,size.width,1);line.setPosition(-size.width/2,-size.height/2);button.addChildToContentNode(line);return button};var DialogManager={};
(function(){var _dialogArray=[];var _pauseShowDialog=false;var _maxDialogCount=-1;var _maxLobbyDialogCount=-1;var _enabledShowHigherPriorityDialog=true;var showingDialogName="DialogShowing";var getParentFunc=function(){var nowScene=cc.director.getRunningScene();var dialogParent=nowScene.getChildByName("DialogParent");if(!dialogParent){dialogParent=new cc.Node;nowScene.addChild(dialogParent,1E3,"DialogParent")}return dialogParent};var getCanShowDialogFunc=dialogArray=>{var curDialog;var index=0;var nowSceneLayerLen=
PushScene.getLayerArrayLength();do{curDialog=dialogArray[index++];if(curDialog&&curDialog.isLobbyDialog)curDialog.setTempHide(nowSceneLayerLen!==1)}while(curDialog&&curDialog.isLobbyDialog&&nowSceneLayerLen!==1);return curDialog};DialogManager.addDialog=function(dialog,management=true,replaceOldDialog=false){if(management&&_maxDialogCount>0&&_dialogArray.length>=_maxDialogCount)return;var parent=getParentFunc();if(replaceOldDialog&&dialog.key.length>0){var dialogArrayLen=_dialogArray.length;if(dialogArrayLen)for(var i=
dialogArrayLen-1;i>=0;){var thisDialog=_dialogArray[i];if(thisDialog.key===dialog.key)_dialogArray.splice(i,1);i--}var parentChildren=parent.getChildren();var parentChildrenLen=parentChildren.length;if(parentChildrenLen)for(var i=parentChildrenLen-1;i>=0;){var thisDialog=parentChildren[i];if(thisDialog.key===dialog.key)thisDialog.removeFromParent();i--}}dialog.setPosition(JSOriginPoint);parent.addChild(dialog);if(management){dialog.setVisible(false);_dialogArray.push(dialog);if(_dialogArray.length===
1)DialogManager.startShowDialog();else{dialog._stopDialogAnimation();var showing=false;var dialogKey=dialog.key;var nowSceneLayerLen=PushScene.getLayerArrayLength();if(dialogKey.length){var priority=DialogPriority.getPriority(dialog);if(priority>0){_dialogArray.sort(function(a,b){var aPriority=DialogPriority.getPriority(a);var bPriority=DialogPriority.getPriority(b);return bPriority-aPriority});if(_pauseShowDialog)showing=true;else if(_enabledShowHigherPriorityDialog){var oldDialog=parent.getChildByName(showingDialogName);
if(oldDialog&&(!dialog.isLobbyDialog||nowSceneLayerLen===1)){var oldPriority=DialogPriority.getPriority(oldDialog);if(priority>oldPriority){oldDialog.setName("");oldDialog.setTempHide(true);DialogManager.startShowDialog(dialog);showing=true}}}}}if(!showing){var allTempHide=true;for(var i=0;i<_dialogArray.length;i++){var thisDialog=_dialogArray[i];var isTempHide=thisDialog.isLobbyDialog?thisDialog.tempHide||nowSceneLayerLen>1:thisDialog.tempHide;if(!isTempHide&&thisDialog!==dialog){allTempHide=false;
break}}if(allTempHide&&(!dialog.isLobbyDialog||nowSceneLayerLen===1))DialogManager.startShowDialog(dialog);else DialogManager.startShowDialog()}}}else dialog._startDialogAnimation()};DialogManager.addLobbyDialog=function(dialog,replaceOldDialog=false){if(!PushScene.isLobby)return;if(_maxLobbyDialogCount>0&&_dialogArray.reduce((pre,cur)=>pre+(cur.isLobbyDialog?1:0),0)>=_maxLobbyDialogCount)return;dialog.isLobbyDialog=true;DialogManager.addDialog(dialog,true,replaceOldDialog)};DialogManager.removeDialog=
function(dialog,notShow){var fintIt=false;for(var i=0;i<_dialogArray.length;i++)if(_dialogArray[i]===dialog){_dialogArray.splice(i,1);fintIt=true;try{dialog.setName("")}catch(e){}break}if(fintIt)if(_dialogArray.length)!notShow&&DialogManager.startShowDialog();else GS.dispatchCustomEvent("NotifyDialogManagerCleared")};DialogManager.closeDialogByKey=function(key){for(var i=0;i<_dialogArray.length;i++)if(_dialogArray[i].key==key)_dialogArray[i]._closeDialogAnimation()};DialogManager.isExist=function(key){for(var i=
0;i<_dialogArray.length;i++)if(_dialogArray[i].key==key)return true;return false};DialogManager.getDialogByKey=function(key){return getParentFunc().getChildren().find(dialog=>dialog.key===key)};DialogManager.startShowDialog=function(dialog){if(GSWebViewChecker.haveWebViewRef())return;if(_dialogArray.length>0&&!_pauseShowDialog){var scene=getParentFunc();if(!dialog){var allHide=_dialogArray.every(dialog=>!dialog.isVisible());if(!allHide)return;var parentChildren=scene.getChildren();var totalDialogs=
[];for(var i=0;i<parentChildren.length;i++){var child=parentChildren[i];if(child.getName()===showingDialogName)totalDialogs.push(child)}var totalDialogLen=totalDialogs.length;if(totalDialogLen){if(totalDialogLen>1)totalDialogs.sort(function(a,b){var aPriority=DialogPriority.getPriority(a);var bPriority=DialogPriority.getPriority(b);return bPriority-aPriority});var needShowDialog=getCanShowDialogFunc(totalDialogs);if(needShowDialog){needShowDialog.setTempHide(false);needShowDialog.setVisible(true);
return}}}try{var curDialog=dialog||getCanShowDialogFunc(_dialogArray);if(!curDialog)return;curDialog.setTempHide(false);curDialog.setName(showingDialogName);curDialog.setVisible(true);if(curDialog.openNeedAnimation)curDialog._startDialogAnimation();else curDialog.runAction(cc.callFunc(()=>curDialog._startDialogAnimation()))}catch(e){}}};DialogManager.cleanAllDialog=function(cleanNoManagement=false){var tmpArray=_dialogArray.slice();_dialogArray=[];tmpArray.forEach(function(cur,index){cur.removeFromParent()});
var nowScene=cc.director.getRunningScene();var dialogParent=nowScene.getChildByName("DialogParent");if(dialogParent&&cleanNoManagement)dialogParent.getChildren().forEach(cur=>{cur.removeFromParent()})};DialogManager.updateLobbyDialogVisible=function(){var nowSceneLayerLen=PushScene.getLayerArrayLength();if(nowSceneLayerLen>1)_dialogArray.forEach(dialog=>dialog.isLobbyDialog&&dialog.setTempHide(true));DialogManager.startShowDialog()};DialogManager.setAllDialogVisible=function(isVisible){var nowSceneLayerLen=
PushScene.getLayerArrayLength();getParentFunc().getChildren().forEach(cur=>{if(!isVisible||!cur.isLobbyDialog||nowSceneLayerLen===1)cur.setTempHide(!isVisible)})};DialogManager.pauseShowDialog=function(){_pauseShowDialog=true};DialogManager.resumeShowDialog=function(){_pauseShowDialog=false;DialogManager.startShowDialog()};DialogManager.checkIsShowDialog=function(){return getParentFunc().getChildren().length>0};DialogManager.checkHaveManagementDialog=function(){return _dialogArray.length>0};DialogManager.checkCanShowLobbyDialog=
function(){return!(_maxLobbyDialogCount>0&&_dialogArray.reduce((pre,cur)=>pre+(cur.isLobbyDialog?1:0),0)>=_maxLobbyDialogCount)};DialogManager.getManagementDialogLength=function(){return _dialogArray.length};DialogManager.setMaxDialogCount=function(count){_maxDialogCount=count};DialogManager.setMaxLobbyDialogCount=function(count){_maxLobbyDialogCount=count};DialogManager.setShowHigherPriorityDialog=function(value){_enabledShowHigherPriorityDialog=value};DialogManager.setNowShowWebView=function(webView){var parentChildren=
getParentFunc().getChildren();var totalDialogs=[];for(var i=0;i<parentChildren.length;i++){var child=parentChildren[i];if(child.getName()===showingDialogName)totalDialogs.push(child)}if(totalDialogs.length){var isDialogWebView=false;for(var c=webView.getParent();c!=null;c=c.getParent())if(c instanceof BaseDialogLayer){isDialogWebView=true;break}if(!isDialogWebView)totalDialogs.forEach(dialog=>dialog.setTempHide(true))}}}).call();var DummyTouchLayer=cc.Layer.extend({ctor:function(touchSize,debug,isReverse){this._super();this._touchSize=touchSize;this._onTouchEventName=undefined;this._onTouchCallback=undefined;this._isReverse=isReverse;this._debug=debug;if(debug){var colorLayer=this._colorLayer=new cc.LayerColor(isReverse?cc.color(0,255,0,100):cc.color(255,0,0,100),touchSize.width,touchSize.height);this.addChild(colorLayer)}cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:true,onTouchBegan:this.onTouchBegan.bind(this)},
this)},setOnTouchEventName:function(eventName){this._onTouchEventName=eventName},setOnTouchCallback:function(callback){this._onTouchCallback=callback},setTouchSize:function(touchSize){this._touchSize=touchSize;if(this._debug===true){this._colorLayer.removeFromParent();this._colorLayer=new cc.LayerColor(cc.color(255,0,0,100),touchSize.width,touchSize.height);this.addChild(this._colorLayer)}},onTouchBegan:function(touch,event){var target=event.getCurrentTarget();if(!target.isVisible())return false;
for(var c=target.parent;c!=null;c=c.parent)if(!c.isVisible())return false;var boundBox=cc.rect(0,0,this._touchSize.width,this._touchSize.height);var touchPos=this.convertToNodeSpace(touch.getLocation());var touchInside=cc.rectContainsPoint(boundBox,touchPos);this._isReverse&&(touchInside=!touchInside);if(touchInside){this._onTouchEventName&&GS.dispatchCustomEvent(this._onTouchEventName);this._onTouchCallback&&this._onTouchCallback(touchPos);return true}else return false}});(function(){if(cc.sys.isNative)return;var checkHosts=["office.mwsrv.com","localhost","127.0","192.168."];var hostName=window.location.hostname;var findIt=checkHosts.some(function(host){return hostName.indexOf(host)==0});if(findIt){var log=getParameterByName("log");if(log){log=decodeURIComponent(log);var errorUrl="http://"+log+"/error/";var wsUrl="http://"+log+"/ws/";var session=Date.now().toString();window.showSession=function(){console.log(session)};var revision=window.location.href.match(/\/(\d+)\//);
revision=revision&&revision[1]||0;var trackJSObj=window._trackJs;var trackJSEnabled=false;if(trackJSObj&&trackJSObj.enabled)trackJSEnabled=true;var customOnError=function(msg,url,line,column,error){axios.post(errorUrl,{msg:msg,url:url,line:line,column:column,stack:error?error.stack:"",ts:Date.now(),session:session,revision:revision});return false};if(!trackJSEnabled)window.onerror=customOnError;else trackJs.configure({onError:function(payload,error){customOnError(error.message,error.file,error.line,
error.column,error);return true}});var ignore=["_ping","_PONG","_pong","online_num"];var OrigWebSocket=window.WebSocket;var callWebSocket=null;try{callWebSocket=OrigWebSocket.apply.bind(OrigWebSocket)}catch(e){return}var wsAddListener=OrigWebSocket.prototype.addEventListener;wsAddListener=wsAddListener.call.bind(wsAddListener);window.WebSocket=function WebSocket(url,protocols){var ws;if(!(this instanceof WebSocket))ws=callWebSocket(this,arguments);else if(arguments.length===1)ws=new OrigWebSocket(url);
else if(arguments.length>=2)ws=new OrigWebSocket(url,protocols);else ws=new OrigWebSocket;ws.hijack=url.indexOf("gamesofa")>-1;wsAddListener(ws,"message",function(event){if(ws.hijack&&ignore.every(x=>event.data.indexOf(x)!=0))wsPost(event.data,"receive")});return ws}.bind();window.WebSocket.prototype=OrigWebSocket.prototype;window.WebSocket.prototype.constructor=window.WebSocket;var wsSend=OrigWebSocket.prototype.send;wsSend=wsSend.apply.bind(wsSend);OrigWebSocket.prototype.send=function(data){if(this.hijack&&
ignore.every(x=>data.indexOf(x)!=0))wsPost(data,"send");return wsSend(this,arguments)}}function wsPost(data,type){axios.post(wsUrl,{type:type,log:data,ts:Date.now(),session:session,revision:revision})}function getParameterByName(name,url){if(!url)url=window.location.href;name=name.replace(/[\[\]]/g,"\\$&");var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);if(!results)return null;if(!results[2])return"";return decodeURIComponent(results[2].replace(/\+/g," "))}}})();if(!cc.sys.isNative)(function(name,context,definition){if(typeof module!=="undefined"&&module.exports)module.exports=definition();else if(typeof define==="function"&&define.amd)define(definition);else context[name]=definition()})("Fingerprint",window||module||{},function(){var Fingerprint=function(options){var nativeForEach,nativeMap;nativeForEach=Array.prototype.forEach;nativeMap=Array.prototype.map;this.each=function(obj,iterator,context){if(obj===null)return;if(nativeForEach&&obj.forEach===nativeForEach)obj.forEach(iterator,
context);else if(obj.length===+obj.length)for(var i=0,l=obj.length;i<l;i++){if(iterator.call(context,obj[i],i,obj)==={})return}else for(var key in obj)if(obj.hasOwnProperty(key))if(iterator.call(context,obj[key],key,obj)==={})return};this.map=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);this.each(obj,function(value,index,list){results[results.length]=iterator.call(context,value,index,list)});return results};
if(typeof options=="object"){this.hasher=options.hasher;this.screen_resolution=options.screen_resolution;this.canvas=options.canvas;this.ie_activex=options.ie_activex}else if(typeof options=="function")this.hasher=options};Fingerprint.prototype={get:function(){var keys=[];keys.push(navigator.userAgent);keys.push(navigator.language);keys.push(screen.colorDepth);if(this.screen_resolution){var resolution=this.getScreenResolution();if(typeof resolution!=="undefined")keys.push(this.getScreenResolution().join("x"))}keys.push((new Date).getTimezoneOffset());
keys.push(this.hasSessionStorage());keys.push(this.hasLocalStorage());keys.push(!!window.indexedDB);if(document.body)keys.push(typeof document.body.addBehavior);else keys.push(typeof undefined);keys.push(typeof window.openDatabase);keys.push(navigator.cpuClass);keys.push(navigator.platform);keys.push(navigator.doNotTrack);keys.push(this.getPluginsString());if(this.canvas&&this.isCanvasSupported())keys.push(this.getCanvasFingerprint());if(this.hasher)return this.hasher(keys.join("###"),31);else return this.murmurhash3_32_gc(keys.join("###"),
31)},murmurhash3_32_gc:function(key,seed){var remainder,bytes,h1,h1b,c1,c2,k1,i;remainder=key.length&3;bytes=key.length-remainder;h1=seed;c1=3432918353;c2=461845907;i=0;while(i<bytes){k1=key.charCodeAt(i)&255|(key.charCodeAt(++i)&255)<<8|(key.charCodeAt(++i)&255)<<16|(key.charCodeAt(++i)&255)<<24;++i;k1=(k1&65535)*c1+(((k1>>>16)*c1&65535)<<16)&4294967295;k1=k1<<15|k1>>>17;k1=(k1&65535)*c2+(((k1>>>16)*c2&65535)<<16)&4294967295;h1^=k1;h1=h1<<13|h1>>>19;h1b=(h1&65535)*5+(((h1>>>16)*5&65535)<<16)&4294967295;
h1=(h1b&65535)+27492+(((h1b>>>16)+58964&65535)<<16)}k1=0;switch(remainder){case 3:k1^=(key.charCodeAt(i+2)&255)<<16;case 2:k1^=(key.charCodeAt(i+1)&255)<<8;case 1:k1^=key.charCodeAt(i)&255;k1=(k1&65535)*c1+(((k1>>>16)*c1&65535)<<16)&4294967295;k1=k1<<15|k1>>>17;k1=(k1&65535)*c2+(((k1>>>16)*c2&65535)<<16)&4294967295;h1^=k1}h1^=key.length;h1^=h1>>>16;h1=(h1&65535)*2246822507+(((h1>>>16)*2246822507&65535)<<16)&4294967295;h1^=h1>>>13;h1=(h1&65535)*3266489909+(((h1>>>16)*3266489909&65535)<<16)&4294967295;
h1^=h1>>>16;return h1>>>0},hasLocalStorage:function(){try{return!!window.localStorage}catch(e){return true}},hasSessionStorage:function(){try{return!!window.sessionStorage}catch(e){return true}},isCanvasSupported:function(){var elem=document.createElement("canvas");return!!(elem.getContext&&elem.getContext("2d"))},isIE:function(){if(navigator.appName==="Microsoft Internet Explorer")return true;else if(navigator.appName==="Netscape"&&/Trident/.test(navigator.userAgent))return true;return false},getPluginsString:function(){if(this.isIE()&&
this.ie_activex)return this.getIEPluginsString();else return this.getRegularPluginsString()},getRegularPluginsString:function(){return this.map(navigator.plugins,function(p){var mimeTypes=this.map(p,function(mt){return[mt.type,mt.suffixes].join("~")}).join(",");return[p.name,p.description,mimeTypes].join("::")},this).join(";")},getIEPluginsString:function(){if(window.ActiveXObject){var names=["ShockwaveFlash.ShockwaveFlash","AcroPDF.PDF","PDF.PdfCtrl","QuickTime.QuickTime","rmocx.RealPlayer G2 Control",
"rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","SWCtl.SWCtl","WMPlayer.OCX","AgControl.AgControl","Skype.Detection"];return this.map(names,function(name){try{new ActiveXObject(name);return name}catch(e){return null}}).join(";")}else return""},getScreenResolution:function(){return[screen.height,screen.width]},getCanvasFingerprint:function(){var canvas=document.createElement("canvas");var ctx=canvas.getContext("2d");
var txt="http://valve.github.io";ctx.textBaseline="top";ctx.font="14px 'Arial'";ctx.textBaseline="alphabetic";ctx.fillStyle="#f60";ctx.fillRect(125,1,62,20);ctx.fillStyle="#069";ctx.fillText(txt,2,15);ctx.fillStyle="rgba(102, 204, 0, 0.7)";ctx.fillText(txt,4,17);return canvas.toDataURL()}};return Fingerprint});var GSAnalyticsAdapter={FIREBASE_CLASS_NAME:"com.gamesofa.GSFirebaseAnalytics",FIREBASE_CLASS_NAME_iOS:"GSFirebaseAnalytics",RECORD_NAME:"GSAppsFlyer_",record:{},enableDebug:false,start:function(){if(cc.sys.os===cc.sys.OS_ANDROID)jsb.reflection.callStaticMethod(this.FIREBASE_CLASS_NAME,"start","()V");else;},setCurrentScreen:function(screenName){if(cc.sys.os===cc.sys.OS_ANDROID)jsb.reflection.callStaticMethod(this.FIREBASE_CLASS_NAME,"setCurrentScreen","(Ljava/lang/String;)V",screenName);else if(cc.sys.os===
cc.sys.OS_IOS)jsb.reflection.callStaticMethod(this.FIREBASE_CLASS_NAME_iOS,"setCurrentScreen:",screenName);if(this.enableDebug)cc.log("GSAnalyticsAdapter screenName:"+screenName)},setUserProperty:function(key,value){if(cc.sys.os===cc.sys.OS_ANDROID)jsb.reflection.callStaticMethod(this.FIREBASE_CLASS_NAME,"setUserProperty","(Ljava/lang/String;Ljava/lang/String;)V",key,value);else if(cc.sys.os===cc.sys.OS_IOS)jsb.reflection.callStaticMethod(this.FIREBASE_CLASS_NAME_iOS,"setUserProperty:withValue:",
key,value);if(this.enableDebug)cc.log("GSAnalyticsAdapter setUserProperty key:"+key+" ,value:"+value)},logEventByFirebase:function(values){if(values.length===4){var json={"Event":values[0],"Action":values[1],"Label":values[2],"Value":values[3]};if(cc.sys.os===cc.sys.OS_ANDROID)jsb.reflection.callStaticMethod(this.FIREBASE_CLASS_NAME,"logEvent","(Ljava/lang/String;Ljava/lang/String;)V","gamesofa_group",JSON.stringify(json));else if(cc.sys.os===cc.sys.OS_IOS)jsb.reflection.callStaticMethod(this.FIREBASE_CLASS_NAME_iOS,
"logEvent:withJson:","gamesofa_group",JSON.stringify(json))}if(this.enableDebug)cc.log("GSAnalyticsAdapter gamesofa_group values:"+values)},logEventByFirebaseAll:function(event,keys,values){var json={};for(var i=0,len1=keys.length,len2=values.length;i<len1&&len1===len2;i++)json[keys[i]]=values[i];if(cc.sys.os===cc.sys.OS_ANDROID)jsb.reflection.callStaticMethod(this.FIREBASE_CLASS_NAME,"logEvent","(Ljava/lang/String;Ljava/lang/String;)V",event,JSON.stringify(json));else if(cc.sys.os===cc.sys.OS_IOS)jsb.reflection.callStaticMethod(this.FIREBASE_CLASS_NAME_iOS,
"logEvent:withJson:",event,JSON.stringify(json));if(this.enableDebug)cc.log("GSAnalyticsAdapter event:"+event+" ,keys:"+keys+" ,values:"+values)},logEventByAppsFlyer:function(event,keys,values){if(cc.sys.isNative){keys=keys||[];values=values||[];var newEventName=GSAnalyticsAdapter.getNewEventName(event);GSAppsFlyer.logEvent(newEventName,keys,values)}if(this.enableDebug)cc.log("GSAnalyticsAdapter event:"+event+" ,keys:"+keys+" ,values:"+values)},logEventByAppsFlyerWithCounter:function(event){if(cc.sys.isNative){var key=
GSAnalyticsAdapter.getNewEventName(event);var recordKey=this.RECORD_NAME+key;var count=parseInt(GS.localStorage.getItem(recordKey,0,true));count++;count=count.toString();GS.localStorage.setItem(recordKey,count,true);GSAnalyticsAdapter.logEventByAppsFlyer(event,["times"],[count])}if(this.enableDebug)cc.log("GSAnalyticsAdapter logEventByAppsFlyerWithCounter event:"+event)},logEventPurchaseByAppsFlyer:function(jsonString){if(cc.sys.isNative)GSAppsFlyer.logEventPurchase(jsonString);if(this.enableDebug)cc.log("GSAnalyticsAdapter logEventPurchaseByAppsFlyer jsonString:"+
jsonString)},logEventByBoth:function(event,keys,values){this.logEventByFirebase(keys,values);this.logEventByAppsFlyer(event,keys,values)},getNewEventName:function(event){var newEventName=event;switch(GS.nowGame){case GSEnum.Game.MJ_16:newEventName="16mj_"+event;break;case GSEnum.Game.MJ_13:newEventName="13mj_"+event;break;case GSEnum.Game.BIGTWO:newEventName="big2_"+event;break;case GSEnum.Game.BIGTWOD:newEventName="big2D_"+event;break;case GSEnum.Game.SEVENS:newEventName="7s_"+event;break;case GSEnum.Game.POKER13:newEventName=
"13poker_"+event;break;case GSEnum.Game.LANDLORD:newEventName="landlord_"+event;break;case GSEnum.Game.TEXAS:if(GS.isContainer)newEventName="9T_"+event;else newEventName=event;break;default:break}return newEventName}};var GSAutoLayout={};GSAutoLayout.TYPE={HORIZONTAL:0,VERTICAL:1,VERTICAL_LEFT:2,VERTICAL_RIGHT:3,HORIZONTAL_TOP:4,HORIZONTAL_BOTTOM:5};GSAutoLayout.DIRECTION={NORMAL:0,REVERSE:1};
var GSAutoLayoutNode=cc.Node.extend({ctor:function(){this._super();this._type=GSAutoLayout.TYPE.HORIZONTAL;this._direction=GSAutoLayout.DIRECTION.NORMAL;this._space=0;this._nodeWidth=0;this._nodeHeight=0;this.setCascadeColorEnabled(true);this.setCascadeOpacityEnabled(true);this.setAnchorPoint(.5,.5)},addChild:function(){this._super.apply(this,arguments);this._doLayout()},addEmptyNode:function(size){var emptyNode=new cc.Node;emptyNode.setContentSize(size);this.addChild(emptyNode)},setNodeSize:function(width=
0,height=0){if(this._nodeWidth!==width)this._nodeWidth=width;if(this._nodeHeight!==height)this._nodeHeight=height;this._doLayout()},setType:function(type){if(this._type!==type){this._type=type;this._doLayout()}},setDirection:function(direction){if(this._direction!==direction){this._direction=direction;this._doLayout()}},setSpace:function(space){if(this._space!==space){this._space=space;this._doLayout()}},refresh:function(){this._doLayout()},_doLayout:function(){var children=this.getChildren();var childrenLen=
children.length;if(childrenLen===0)return;var width=0,height=0;var self=this;switch(this._type){case GSAutoLayout.TYPE.HORIZONTAL:case GSAutoLayout.TYPE.HORIZONTAL_TOP:case GSAutoLayout.TYPE.HORIZONTAL_BOTTOM:children.filter(cur=>cur.isVisible()).forEach(function(cur,index){var thisSize=cur.getBoundingBox();height=Math.max(thisSize.height,height);width+=thisSize.width+(index>0?self._space:0)});width=Math.max(this._nodeWidth,width);height=Math.max(this._nodeHeight,height);var nowPosX=0;var isTop=this._type===
GSAutoLayout.TYPE.HORIZONTAL_TOP;var isBottom=this._type===GSAutoLayout.TYPE.HORIZONTAL_BOTTOM;var posY=isTop?height:isBottom?0:height/2;var layoutFunc=function(child){if(!child.isVisible())return;child.setAnchorPoint(0,isTop?1:isBottom?0:.5);child.setPosition(nowPosX,posY);nowPosX+=child.getBoundingBox().width+self._space};if(this._direction===GSAutoLayout.DIRECTION.NORMAL)for(var i=0;i<childrenLen;i++)layoutFunc(children[i]);else for(var i=childrenLen-1;i>=0;i--)layoutFunc(children[i]);break;default:children.filter(cur=>
cur.isVisible()).forEach(function(cur,index){var thisSize=cur.getBoundingBox();width=Math.max(thisSize.width,width);height+=thisSize.height+(index>0?self._space:0)});width=Math.max(this._nodeWidth,width);height=Math.max(this._nodeHeight,height);var nowPosY=height;var isLeft=this._type===GSAutoLayout.TYPE.VERTICAL_LEFT;var isRight=this._type===GSAutoLayout.TYPE.VERTICAL_RIGHT;var anchorPoint=cc.p(isLeft?0:isRight?1:.5,1);var posX=isLeft?0:isRight?width:width/2;var layoutFunc=function(child){if(!child.isVisible())return;
child.setAnchorPoint(anchorPoint);child.setPosition(posX,nowPosY);nowPosY-=child.getBoundingBox().height+self._space};if(this._direction===GSAutoLayout.DIRECTION.NORMAL)for(var i=0;i<childrenLen;i++)layoutFunc(children[i]);else for(var i=childrenLen-1;i>=0;i--)layoutFunc(children[i])}this.setContentSize(cc.size(width,height))}});var GSAutoSizeLabel=cc.LabelTTF.extend({ctor:function(label,fontName,fontSize,dimensions,hAlignment,vAlignment,isCutString){dimensions=dimensions||cc.size(0,0);this._needResize=!(dimensions.width===0&&dimensions.height===0);this._originalDimensions=cc.size(dimensions.width,dimensions.height);this._originalFontSize=fontSize;this.minFontSize=8;this.textSize=cc.size(0,0);this._labelString=label;this._isCutString=isCutString;this._super("",fontName,fontSize,dimensions,hAlignment,vAlignment);this.setLineBreak(false);
this.setString(label)},setString:function(text){cc.LabelTTF.prototype.setString.call(this,text);this._labelString=text;this.resizeToFit(this.minFontSize)},setDimensions:function(dim,height){var width;if(height===undefined){width=dim.width;height=dim.height}else width=dim;var dimensions=this._originalDimensions=cc.size(width,height);this._needResize=!(dimensions.width===0&&dimensions.height===0);cc.LabelTTF.prototype.setDimensions.call(this,width,height);this.resizeToFit(this.minFontSize)},resizeToFit:function(minSize){cc.LabelTTF.prototype.setDimensions.call(this,
0,0);this.setFontSize(this._originalFontSize);this.minFontSize=minSize;var textSize=this.getContentSize();if(this._needResize&&textSize.width>this._originalDimensions.width){var newFontSize=Math.floor(this.getFontSize()*(this._originalDimensions.width/textSize.width))-.02;if(newFontSize>=minSize)this.setFontSize(newFontSize);else{this.setFontSize(minSize);if(this._isCutString){var cutString=JSStringUtility.cutStringReplaceByEllipsis(this._labelString,minSize,this._originalDimensions.width);cc.LabelTTF.prototype.setString.call(this,
cutString)}}this.textSize=cc.size(this._originalDimensions.width,this._originalDimensions.height)}else this.textSize=cc.size(textSize.width,textSize.height);cc.LabelTTF.prototype.setDimensions.call(this,this._originalDimensions)}});var GSAutoScaleSizeLabel=cc.Node.extend({ctor:function(labelStr,fontName,fontSize,dimensions=cc.size(0,0),hAlignment,vAlignment){this._super();this.setCascadeOpacityEnabled(true);this.setCascadeColorEnabled(true);this._dimensions=cc.size(dimensions.width,dimensions.height);var label=this._label=new cc.LabelTTF(labelStr,fontName,fontSize,cc.size(0,0),hAlignment,vAlignment);label.setAnchorPoint(0,0);this.addChild(label);this.setAnchorPoint(.5,.5);this._refresh()},showDebug:function(){this._debugLayer&&
this._debugLayer.removeFromParent();var colorLayer=this._debugLayer=new cc.LayerColor(cc.color(255,0,0,100),this._dimensions.width,this._dimensions.height||this.getContentSize().height);this.addChild(colorLayer,-1);this._refreshDebugPosition()},_refresh:function(){var label=this._label;var labelContentSize=label.getContentSize();var dim=this._dimensions;if(labelContentSize.width<=dim.width||dim.width===0){label.setScale(1);this.setContentSize(labelContentSize)}else{var scaleRatio=dim.width/labelContentSize.width;
label.setScale(scaleRatio);this.setContentSize(cc.size(dim.width,labelContentSize.height*scaleRatio))}this._refreshDebugPosition()},_refreshDebugPosition:function(){var layer=this._debugLayer;if(!layer)return;var anchor=this.getAnchorPoint();var selfSize=this.getContentSize();var dimensions=this._dimensions;layer.setPosition(-anchor.x*(dimensions.width-selfSize.width),-anchor.y*((dimensions.height?dimensions.height:selfSize.height)-selfSize.height))},setAnchorPoint:function(point,y){cc.Node.prototype.setAnchorPoint.call(this,
point,y);this._refreshDebugPosition()},getLineHeight:function(){return this._label.getLineHeight()},setLineHeight:function(lineHeight){return},getString:function(){return this._label.getString()},getHorizontalAlignment:function(){return this._label.getHorizontalAlignment()},getVerticalAlignment:function(){return this._label.getVerticalAlignment()},getDimensions:function(){return cc.size(this._dimensions)},getFontSize:function(){return this._label.getFontSize()},getFontName:function(){return this._label.getFontName()},
setTextDefinition:function(theDefinition){this._label.setTextDefinition(theDefinition);this._refresh()},getTextDefinition:function(){return this._label.getTextDefinition()},enableShadow:function(a,b,c,d){this._label.enableShadow(a,b,c,d)},disableShadow:function(){this._label.disableShadow()},enableStroke:function(strokeColor,strokeSize){this._label.enableStroke(strokeColor,strokeSize);this._refresh()},disableStroke:function(){this._label.disableStroke();this._refresh()},setFontFillColor:function(fillColor){this._label.setFontFillColor(fillColor)},
setString:function(text){this._label.setString(text);this._refresh()},setHorizontalAlignment:function(alignment){this._label.setHorizontalAlignment(alignment);this._refresh()},setVerticalAlignment:function(verticalAlignment){this._label.setVerticalAlignment(verticalAlignment);this._refresh()},setDimensions:function(dim,height){var width;if(height===undefined){width=dim.width;height=dim.height}else width=dim;if(width!==this._dimensions.width||height!==this._dimensions.height){this._dimensions.width=
width;this._dimensions.height=height;this._refresh()}},setFontSize:function(fontSize){this._label.setFontSize(fontSize);this._refresh()},setFontName:function(fontName){this._label.setFontName(fontName);this._refresh()},getBoundingBox:function(){return this._label.getBoundingBox()},setLineBreak:function(val){this._label.setLineBreak(val);this._refresh()}});var GSBackKeyLayer=cc.Layer.extend({ctor:function(){this._super()},onEnter:function(){this._super();PushScene.addBackKeyEnableLayer(this)},onExit:function(){PushScene.removeBackKeyEnableLayer(this);this._super()}});var GSCaptureToAlbumWrapper={};var GSCaptureToAlbumErrorType={NONE:0,PERMISSION:1,WRITE:2};
(function(){var isNative=cc.sys.isNative;GSCaptureToAlbumWrapper.havePermission=function(){return isNative&&GSCaptureToAlbum.havePermission()};GSCaptureToAlbumWrapper.requestPermission=function(callback){isNative&&GSCaptureToAlbum.requestPermission(callback)};GSCaptureToAlbumWrapper.captureScreen=function(callback){isNative&&GSCaptureToAlbum.captureScreen(callback)};GSCaptureToAlbumWrapper.saveToAlbum=function(filename,callback,removeFile=false){isNative&&GSCaptureToAlbum.saveToAlbum(filename,callback,
removeFile)}}).call(window||module||{});var GSControlButton=cc.ControlButton.extend({ctor:function(contentNode,btnSize){this._super();this.setCascadeColorEnabled(true);this.setCascadeOpacityEnabled(true);this._changeColorWhenDisabled=true;this._changeOpacityWhenDisabled=false;if(!contentNode)contentNode=new cc.Node;contentNode.setCascadeColorEnabled(true);contentNode.setCascadeOpacityEnabled(true);btnSize=btnSize||contentNode.getContentSize();var midPos=cc.p(btnSize.width/2,btnSize.height/2);var node=this._mainNode=new ccui.Scale9Sprite;
node.setCascadeColorEnabled(true);node.setCascadeOpacityEnabled(true);node.setContentSize(btnSize);contentNode.setPosition(midPos);node.addChild(contentNode);this._contentNode=contentNode;this.setPreferredSize(btnSize);this.setBackgroundSpriteForState(node,cc.CONTROL_STATE_NORMAL);this.addTargetWithActionForControlEvents(this,this._buttonClicked,cc.CONTROL_EVENT_TOUCH_DOWN|cc.CONTROL_EVENT_TOUCH_CANCEL|cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE|cc.CONTROL_EVENT_TOUCH_UP_INSIDE|cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE|
cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE);this.setAdjustBackgroundImage(false);this.setZoomOnTouchDown(false)},_buttonClicked:function(sender,type){var isTouched=type===cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE||type===cc.CONTROL_EVENT_TOUCH_DOWN;this._mainNode.setColor(isTouched?JSColor.GRAY:JSColor.WHITE)},setEnabled:function(enable){if(cc.sys.isNative&&this.__isDestroyed)return;this._super(enable);if(this._changeColorWhenDisabled)this._mainNode.setColor(enable?JSColor.WHITE:this._disabledColor||JSColor.GRAY);
this._changeOpacityWhenDisabled&&this._mainNode.setOpacity(enable?255:this._disabledOpacity||150)},setChangeColorWhenDisabled:function(value){if(this._changeColorWhenDisabled!==value){this._changeColorWhenDisabled=value;this.setEnabled(this.isEnabled())}},setDisabledColor:function(color){this._disabledColor=color||JSColor.GRAY},setChangeOpacityWhenDisabled:function(value){if(this._changeOpacityWhenDisabled!==value){this._changeOpacityWhenDisabled=value;this.setEnabled(this.isEnabled())}},setDisabledOpacity:function(value){this._disabledOpacity=
value||150},addTouchUpInsideAction:function(func,target){this.addTargetWithActionForControlEvents(target,func,cc.CONTROL_EVENT_TOUCH_UP_INSIDE)},enableTouchCancel:function(direction){this.setSwallowTouches(direction===cc.SCROLLVIEW_DIRECTION_NONE);this.setTouchDirection(direction)},addChildToContentNode:function(child,localZOrder=0){this._contentNode.addChild(child,localZOrder)},getContentNode:function(){return this._contentNode},refreshContentNodesPosAndSize:function(){var contentSize=this.getContentSize();
this._mainNode.setContentSize(contentSize);this._contentNode.setPosition(contentSize.width/2,contentSize.height/2)}});var GSDeviceWrapper={};
(function(){var h5EncToken=cc.sys.isNative?"":Cookie.get("enc")||"";var _UUID="";GSDeviceWrapper.getUUID=function(h5UseRandom=true){if(_UUID.length===0)if(cc.sys.isNative)_UUID=GSDeviceInfo.getUUID();else if(h5UseRandom)_UUID=GS.fingerprint=(new Fingerprint({canvas:true})).get().toString();else{_UUID=GS.localStorage.getItem("TestUUID","");if(_UUID.length===0){var randomString="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";var totalLen=16;var randomLen=randomString.length;_UUID="";
for(var i=0;i<totalLen;i++)_UUID+=randomString[JSCodeUtility.getRandomInt(0,randomLen-1)];GS.localStorage.setItem("TestUUID",_UUID)}}return _UUID};GSDeviceWrapper.getCountry=function(){if(cc.sys.isNative)return GSDeviceInfo.getCountry();else return""};GSDeviceWrapper.getLanguage=function(){if(cc.sys.isNative)return GSDeviceInfo.getLanguage();else return cc.sys.language};GSDeviceWrapper.getCountryCode=function(){if(cc.sys.isNative)return GSDeviceInfo.getCountryCode();else return""};GSDeviceWrapper.getEncToken=
function(){if(cc.sys.isNative)return GSDeviceInfo.getEncToken();else return h5EncToken};GSDeviceWrapper.getNotifyID=function(){if(cc.sys.isNative)return GSDeviceInfo.getNotifyID();else return""};GSDeviceWrapper.setNotifyID=function(notifyID){if(cc.sys.isNative)GSDeviceInfo.setNotifyID(notifyID)};GSDeviceWrapper.getAndroidID=function(){if(cc.sys.isNative)return GSDeviceInfo.getAndroidID();else return""};GSDeviceWrapper.getAnotherUUID=function(){if(cc.sys.isNative)return GSDeviceInfo.getAnotherUUID();
else return""};GSDeviceWrapper.getSerialID=function(){if(cc.sys.isNative)return GSDeviceInfo.getSerialID();else return""};GSDeviceWrapper.checkInternetConnection=function(){if(cc.sys.isNative)return GSDeviceInfo.checkInternetConnection();else return true};GSDeviceWrapper.ORIENTATION={UNKNOW:0,PORTRAIT:1,PORTRAIT_UPSIDE_DOWN:2,LANDSCAPE_RIGHT:3,LANDSCAPE_LEFT:4};GSDeviceWrapper.getDeviceOrientation=function(){if(cc.sys.isNative)return GSDeviceInfo.getDeviceOrientation();else return GSDeviceWrapper.ORIENTATION.UNKNOW};
GSDeviceWrapper.setDeviceOrientation=function(isPortrait,callback){if(cc.sys.isNative)GSDeviceInfo.setDeviceOrientation(isPortrait,function(){JSConfigReset();callback&&callback()});else{var oldDesignSize=cc.view.getDesignResolutionSize();var oldIsPortrait=oldDesignSize.width<oldDesignSize.height;if(oldIsPortrait!==isPortrait){cc.view.setOrientation(isPortrait?cc.ORIENTATION_PORTRAIT:cc.ORIENTATION_LANDSCAPE);cc.view.setDesignResolutionSize(oldDesignSize.height,oldDesignSize.width,cc.ResolutionPolicy.SHOW_ALL);
JSConfigReset()}callback&&callback()}};GSDeviceWrapper.getIsEmulator=function(){if(cc.sys.isNative)return GSDeviceInfo.getIsEmulator();else return false};GSDeviceWrapper.getEncIsDownloadFromThirdStore=function(){if(cc.sys.isNative)return GSDeviceInfo.getEncIsDownloadFromThirdStore();else return 0};GSDeviceWrapper.getInstallReferrerJson=function(){if(cc.sys.isNative)return JSON.parse(GSDeviceInfo.getInstallReferrerJson());else return{}};GSDeviceWrapper.getInstalledGamesfaGames=function(bundleIDArray){if(cc.sys.isNative)return GSDeviceInfo.getInstalledGamesfaGames(bundleIDArray);
else return""};GSDeviceWrapper.setAlternateIconName=function(iconName){if(cc.sys.isNative)GSDeviceInfo.setAlternateIconName(iconName)};GSDeviceWrapper.needATTAuthorization=function(){if(cc.sys.isNative)return GSDeviceInfo.needATTAuthorization();else return false};GSDeviceWrapper.showATTAuthorization=function(){if(cc.sys.isNative)GSDeviceInfo.showATTAuthorization()}})();var GSEase={};GSEase.easeIn=function(rate){return function(dt){return Math.pow(dt,rate)}};GSEase.easeOut=function(rate){return function(dt){return Math.pow(dt,1/rate)}};GSEase.easeInOut=function(rate){return function(dt){dt*=2;if(dt<1)return.5*Math.pow(dt,rate);else return 1-.5*Math.pow(2-dt,rate)}};GSEase.easeExponentialIn=function(){return function(dt){return dt===0?0:Math.pow(2,10*(dt-1))}};GSEase.easeExponentialOut=function(){return function(dt){return dt===1?1:-Math.pow(2,-10*dt)+1}};
GSEase.easeExponentialInOut=function(){return function(dt){if(dt!==1&&dt!==0){dt*=2;if(dt<1)return.5*Math.pow(2,10*(dt-1));else return.5*(-Math.pow(2,-10*(dt-1))+2)}return dt}};GSEase.easeSineIn=function(){return function(dt){return dt===0||dt===1?dt:-1*Math.cos(dt*Math.PI/2)+1}};GSEase.easeSineOut=function(){return function(dt){return dt===0||dt===1?dt:Math.sin(dt*Math.PI/2)}};GSEase.easeSineInOut=function(){return function(dt){return dt===0||dt===1?dt:-.5*(Math.cos(Math.PI*dt)-1)}};
GSEase.easeElasticIn=function(period=.3){return function(dt){if(dt===0||dt===1)return dt;dt=dt-1;return-Math.pow(2,10*dt)*Math.sin((dt-period/4)*Math.PI*2/period)}};GSEase.easeElasticOut=function(period=.3){return function(dt){return dt===0||dt===1?dt:Math.pow(2,-10*dt)*Math.sin((dt-period/4)*Math.PI*2/period)+1}};
GSEase.easeElasticInOut=function(period=.3){return function(dt){var newT=0;var locPeriod=period;if(dt===0||dt===1)newT=dt;else{dt=dt*2;if(!locPeriod)locPeriod=period=.3*1.5;var s=locPeriod/4;dt=dt-1;if(dt<0)newT=-.5*Math.pow(2,10*dt)*Math.sin((dt-s)*Math.PI*2/locPeriod);else newT=Math.pow(2,-10*dt)*Math.sin((dt-s)*Math.PI*2/locPeriod)*.5+1}return newT}};
GSEase._bounceTime=function(time){if(time<1/2.75)return 7.5625*time*time;else if(time<2/2.75){time-=1.5/2.75;return 7.5625*time*time+.75}else if(time<2.5/2.75){time-=2.25/2.75;return 7.5625*time*time+.9375}time-=2.625/2.75;return 7.5625*time*time+.984375};GSEase.easeBounceIn=function(){return function(dt){return 1-GSEase._bounceTime(1-dt)}};GSEase.easeBounceOut=function(){return function(dt){return GSEase._bounceTime(dt)}};
GSEase.easeBounceInOut=function(){return function(time){var newT;if(time<.5){time=time*2;newT=(1-GSEase._bounceTime(1-time))*.5}else newT=GSEase._bounceTime(time*2-1)*.5+.5;return newT}};GSEase.easeBackIn=function(){return function(time){var overshoot=1.70158;return time===0||time===1?time:time*time*((overshoot+1)*time-overshoot)}};GSEase.easeBackOut=function(){return function(time){var overshoot=1.70158;time=time-1;return time*time*((overshoot+1)*time+overshoot)+1}};
GSEase.easeBackInOut=function(){return function(time){var overshoot=1.70158*1.525;time=time*2;if(time<1)return time*time*((overshoot+1)*time-overshoot)/2;else{time=time-2;return time*time*((overshoot+1)*time+overshoot)/2+1}}};GSEase.easeBezierAction=function(p0,p1,p2,p3){return function(t){return Math.pow(1-t,3)*p0+3*t*Math.pow(1-t,2)*p1+3*Math.pow(t,2)*(1-t)*p2+Math.pow(t,3)*p3}};GSEase.easeQuadraticActionIn=function(){return function(time){return Math.pow(time,2)}};
GSEase.easeQuadraticActionOut=function(){return function(time){return-time*(time-2)}};GSEase.easeQuadraticActionInOut=function(){return function(time){var resultTime=time;time*=2;if(time<1)resultTime=time*time*.5;else{--time;resultTime=-.5*(time*(time-2)-1)}return resultTime}};GSEase.easeQuarticActionIn=function(){return function(time){return time*time*time*time}};GSEase.easeQuarticActionOut=function(){return function(time){time-=1;return-(time*time*time*time-1)}};
GSEase.easeQuarticActionInOut=function(){return function(time){time=time*2;if(time<1)return.5*time*time*time*time;time-=2;return-.5*(time*time*time*time-2)}};GSEase.easeQuinticActionIn=function(){return function(time){return time*time*time*time*time}};GSEase.easeQuinticActionOut=function(){return function(time){time-=1;return time*time*time*time*time+1}};
GSEase.easeQuinticActionInOut=function(){return function(time){time=time*2;if(time<1)return.5*time*time*time*time*time;time-=2;return.5*(time*time*time*time*time+2)}};GSEase.easeCircleActionIn=function(){return function(time){return-1*(Math.sqrt(1-time*time)-1)}};GSEase.easeCircleActionOut=function(){return function(time){time=time-1;return Math.sqrt(1-time*time)}};
GSEase.easeCircleActionInOut=function(){return function(time){time=time*2;if(time<1)return-.5*(Math.sqrt(1-time*time)-1);time-=2;return.5*(Math.sqrt(1-time*time)+1)}};GSEase.easeCubicActionIn=function(){return function(time){return time*time*time}};GSEase.easeCubicActionOut=function(){return function(time){time-=1;return time*time*time+1}};GSEase.easeCubicActionInOut=function(){return function(time){time=time*2;if(time<1)return.5*time*time*time;time-=2;return.5*(time*time*time+2)}};var GSEasyRollNode=cc.Node.extend({ctor:function(param){this._super();this._param=param;this._speed=param.speed;this._index=1;this._itemArray=[];this._callback=null;this._targetIndex=-1;this._stopFlag=false;var node=this._node=new cc.Node;this.addChild(node);var total=param.total+2;for(var i=0;i<total;i++){var biasFactor=i-Math.floor(i/(total-1))*total;var imageName=i===0&&param.defaultItem?this._getImageName(param.defaultItem,true):this._getImageName(i);var item=this._itemArray[biasFactor+1]=new cc.Sprite("#"+
imageName);item.setTag(i);item.setPosition(0,biasFactor*-param.size.height);node.addChild(item)}},_getImageName:function(numOrSuffix,useSelectedSuffix){if(useSelectedSuffix)return this._param.prefixName+numOrSuffix+".png";var isRandom=this._param.random;var items=this._param.items;var len=items.length;var filename;if(isRandom){var index=JSCodeUtility.getRandomInt(0,len-1);filename=this._param.prefixName+items[index]+".png"}else filename=this._param.prefixName+items[numOrSuffix%len]+".png";return filename},
spin:function(delayTime,callback){this._stopFlag=false;this._targetIndex=-1;this._resolve=undefined;this._callback=callback;this.stopAllActions();if(delayTime>0)this.runAction(cc.sequence(cc.delayTime(delayTime),cc.callFunc(()=>this.scheduleUpdate())));else this.scheduleUpdate()},spinAsync:function(delayTime){return new Promise(resolve=>{this._resolve=resolve;this._stopFlag=false;this._targetIndex=-1;this.stopAllActions();if(delayTime>0)this.runAction(cc.sequence(cc.delayTime(delayTime),cc.callFunc(()=>
this.scheduleUpdate())));else this.scheduleUpdate()})},stop:function(){this._stopFlag=true;this._targetIndex=this._index+5},_spinStop:function(){if(this._resolve){this._resolve();this._resolve=undefined}else if(this._callback)this._callback()},update:function(delta){var height=this._param.size.height;if(this._stopFlag)this._speed*=.99;var distance=delta*this._speed;if(distance>height)distance=height;var ty=this._node.getPositionY()-distance;this._node.setPositionY(ty);var curIndex=-Math.floor(ty/
height);if(this._index!==curIndex){this._index=curIndex;this._itemArray=this._itemArray.slice(-1).concat(this._itemArray.slice(0,-1));var item=this._itemArray[0];item.setPositionY(this._index*height);if(this._stopFlag){var num=this._targetIndex-this._index;if(num>0&&num<=this._param.total){var image=this._getImageName(this._param.finalItems[num-1],true);item.setSpriteFrame(image)}else item.setSpriteFrame(this._getImageName(this._index));if(num===0){this.unscheduleUpdate();var finalY=-(this._index-
1)*height;if(this._param.endAnim){var sec=200/this._param.speed;this._node.runAction(cc.sequence(cc.moveTo(sec,0,finalY-height*.2),cc.moveTo(sec*1.5,0,finalY).easing(cc.easeIn(1.5)),cc.callFunc(()=>this._spinStop())))}else{this._node.setPositionY(finalY);this._spinStop()}}}else item.setSpriteFrame(this._getImageName(this._index));if(this._index===this._param.times)this.stop()}}});var GSEasyRollConfig=cc.Class.extend({ctor:function(){this.prefixName="";this.size=cc.size(0,0);this.random=true;this.items=[];this.finalItems=[];this.defaultItem=undefined;this.total=1;this.speed=400;this.times=10;this.endAnim=true}});var FacebookFriend={};FacebookFriend.type={none:0,kAuthorizeType:1,kUnAuthorizeType:2};
var GSFacebookHelper={init:function(){},getToken:function(){return plugin.FacebookAgent.getInstance().getAccessToken()},getFriendList:function(type,limit,callBack){var fbAgent=plugin.FacebookAgent.getInstance();var fbParam={};var path="";if(type==FacebookFriend.type.kUnAuthorizeType){path="/me/invitable_friends";fbParam["fields"]="id,name,picture";fbParam["limit"]=limit}else{path="/me/friends";fbParam["fields"]="id,name,picture";fbParam["limit"]=limit}if(fbAgent.isLoggedIn())fbAgent.api(path,plugin.FacebookAgent.HttpMethod.GET,
fbParam,callBack)},inviteFriend:function(title,message,ids,callback){var fbAgent=plugin.FacebookAgent.getInstance();var fbParam={};message=message||"Welcome to Casino";title=title||"Invite your friend to join us";fbParam["message"]=message;fbParam["title"]=title;fbParam["recipients"]=ids;var defaultCallBack=function(retCode,responseString){if(retCode==plugin.FacebookAgent.CODE_SUCCEED)cc.log("\u9080\u8acb\u6210\u529f : "+JSON.stringify(responseString));else cc.log("\u9080\u8acb\u5931\u6557 code : "+
retCode+" msg : "+JSON.stringify(responseString))};if(callback&&typeof callback=="function")fbAgent.appRequest(fbParam,callback);else fbAgent.appRequest(fbParam,defaultCallBack)},isLoggedIn:function(){return plugin.FacebookAgent.getInstance().isLoggedIn()},login:function(callback,permissions="public_profile"){var permission=[permissions];plugin.FacebookAgent.getInstance().login(permission,callback)},logout:function(callback){plugin.FacebookAgent.getInstance().logout(callback)},share:function(info,
callback){plugin.FacebookAgent.getInstance().dialog(info,callback)},logEvent:function(name){plugin.FacebookAgent.getInstance().logEvent(name)},logPurchase:function(amount,currency,param){plugin.FacebookAgent.getInstance().logPurchase(amount,currency,param)}};var ga=typeof ga==="undefined"?function(){}:ga;
var GSGoogleAnalytics={PACKAGE:"com/gamesofa/GSGoogleAnalytics",specificFlag:"",metricIndex:0,metricValue:0,dimensionIndex:0,dimensionValue:"",useGA:false,init:function(userID){if(!cc.sys.isNative)ga("set","appName",GS.gameName);else this.setUserOfTrackers(userID);this.useGA=true},setMetric:function(index,value){if(!this.useGA)return;this.metricIndex=index;this.metricValue=value;if(!cc.sys.isNative)ga("set","metric"+index.toString(),value);else if(cc.sys.os==cc.sys.OS_ANDROID)jsb.reflection.callStaticMethod(GSGoogleAnalytics.PACKAGE,
"setMetric_","(IF)V",index,value);else if(cc.sys.os==cc.sys.OS_IOS);},setDimension:function(index,value){if(!this.useGA)return;this.dimensionIndex=index;this.dimensionValue=value;if(!cc.sys.isNative)ga("set","dimension"+index.toString(),value);else if(cc.sys.os==cc.sys.OS_ANDROID)jsb.reflection.callStaticMethod(GSGoogleAnalytics.PACKAGE,"setDimension_","(ILjava/lang/String;)V",index,value);else if(cc.sys.os==cc.sys.OS_IOS);},logEvent:function(category,action,label,value){if(!this.useGA)return;if(!cc.sys.isNative)ga("send",
"event",category,action,label,value);else if(cc.sys.os==cc.sys.OS_ANDROID)if(value===undefined||value===null)jsb.reflection.callStaticMethod(GSGoogleAnalytics.PACKAGE,"googleAnalyticLogEvent_","(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V",category,action,label);else jsb.reflection.callStaticMethod(GSGoogleAnalytics.PACKAGE,"logEventWithValue_","(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;I)V",category,action,label,value);else if(cc.sys.os==cc.sys.OS_IOS);},logScreen:function(screenName){if(!this.useGA)return;
if(!cc.sys.isNative)ga("send","screenview",{screenName:screenName});else if(cc.sys.os==cc.sys.OS_ANDROID)jsb.reflection.callStaticMethod(GSGoogleAnalytics.PACKAGE,"googleAnalyticLogScreen_","(Ljava/lang/String;)V",screenName);else if(cc.sys.os==cc.sys.OS_IOS);},logTiming:function(category,name,label,value){if(!this.useGA)return;if(!cc.sys.isNative)ga("send","timing",category,name,value,label);else if(cc.sys.os==cc.sys.OS_ANDROID)jsb.reflection.callStaticMethod(GSGoogleAnalytics.PACKAGE,"logUserTiming_",
"(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;I)V",category,name,label,value);else if(cc.sys.os==cc.sys.OS_IOS);},setUserOfTrackers:function(userID){if(!cc.sys.isNative)return;if(cc.sys.os==cc.sys.OS_ANDROID)jsb.reflection.callStaticMethod(GSGoogleAnalytics.PACKAGE,"setUserOfTrackers_","(Ljava/lang/String;)V",userID);else if(cc.sys.os==cc.sys.OS_IOS);},setProduct:function(id,name){if(!this.useGA)return;if(!cc.sys.isNative)return;if(cc.sys.os==cc.sys.OS_ANDROID)jsb.reflection.callStaticMethod(GSGoogleAnalytics.PACKAGE,
"setProduct_","(Ljava/lang/String;Ljava/lang/String;)V",id,name);else if(cc.sys.os==cc.sys.OS_IOS);},setProductAction:function(id,revenue){if(!this.useGA)return;if(!cc.sys.isNative)return;if(cc.sys.os==cc.sys.OS_ANDROID)jsb.reflection.callStaticMethod(GSGoogleAnalytics.PACKAGE,"setProductAction_","(ILjava/lang/String;D)V",id,revenue);else if(cc.sys.os==cc.sys.OS_IOS);}};var GSLoadingSprite=cc.Sprite.extend({_rotateTimes:0,_updateLoadingTime:.066666666,ctor:function(imageName="loading.png"){this._super(imageName)},onEnter:function(){this._super();if(this._isStart)this.start();else if(this._isStop)this.stop()},start:function(){this._isStart=true;this._isStop=false;if(this.__isDestroyed)return;this.stopAllActions();this.setVisible(true);var action1=cc.rotateBy(0,45);var action2=cc.delayTime(this._updateLoadingTime);this.runAction(cc.repeatForever(cc.sequence(action1,
action2)));this._isStart=false},stop:function(){this._isStart=false;this._isStop=true;if(this.__isDestroyed)return;this.stopAllActions();this.setVisible(false);this._isStop=false}});var GSNumberLabel=GSAutoSizeLabel.extend({ctor:function(label,fontName,fontSize,dimensions,hAlignment,vAlignment){this._totalNumber=label;this.nowNumber=0;this._floorNumber=0;this._usedTime=0;this._isAddSymbol=false;this._isSymbolAtFront=false;this.updateTime=.5;this.isUseCurrencyString=false;this.symbol="";this._format=undefined;this._super(label,fontName,fontSize,dimensions,hAlignment,vAlignment)},scheduleUpdateLabel:function(dt){this._usedTime+=dt;if(this._usedTime<this.updateTime)this.nowNumber=
Math.floor(this._floorNumber+(this._totalNumber-this._floorNumber)*(this._usedTime/this.updateTime));else{this.unschedule(this.scheduleUpdateLabel);this.nowNumber=this._totalNumber}var label=this.isUseCurrencyString?JSCodeUtility.getCurrencyString(this.nowNumber):this.nowNumber;if(this._isAddSymbol)if(this._isSymbolAtFront)label=this.symbol+label;else label=label+this.symbol;else if(this._format){if(this.isUseCurrencyString){this._format=this._format.replace("%d","%s");this._format=this._format.replace("%f",
"%s")}label=JSStringUtility.format(this._format,label)}this.setString(label);this._updateCallback&&this._updateCallback(this.nowNumber)},stopAnimAndToTotalNumber:function(){this.unschedule(this.scheduleUpdateLabel);this.setToNumber(this._totalNumber,false)},setUpdateTime:function(updateTime){this.updateTime=updateTime},setToNumber:function(toNumber,isAnimation){toNumber=JSCodeUtility.getFloatValue(toNumber);var len=arguments.length;if(len<2)isAnimation=true;if(isAnimation){this._totalNumber=toNumber;
this._floorNumber=this.nowNumber;this._usedTime=0;if(this._floorNumber==this._totalNumber)return;this.unschedule(this.scheduleUpdateLabel);this.schedule(this.scheduleUpdateLabel)}else{this._totalNumber=toNumber;this._floorNumber=this.nowNumber;this.scheduleUpdateLabel(999999)}},setUseCurrencyString:function(enable){this.isUseCurrencyString=enable},setNumberUpdateCallback:function(callback){this._updateCallback=callback},getNumber:function(){return this._totalNumber},setSymbol:function(symbol,isFront=
false){this.symbol=symbol;this._isAddSymbol=!!symbol.length;if(this._isAddSymbol)this._isSymbolAtFront=isFront},setFormat:function(format){this._format=format}});let GSBigNumberLabel=GSNumberLabel.extend({ctor:function(number,fontName,fontSize,dimensions,hAlignment,vAlignment){this._super(JSCodeUtility.getStringValue(number),fontName,fontSize,dimensions,hAlignment,vAlignment);this.nowNumber="0";this._floorNumber="0";this._deltaNumber="0"},scheduleUpdateLabel:function(dt){this._usedTime+=dt;if(this._usedTime<this.updateTime){let percent=JSCodeUtility.getStringValue(this._usedTime/this.updateTime);this.nowNumber=JSCodeUtility.bigNumberAdd(this._floorNumber,
JSCodeUtility.bigNumberMultiply(this._deltaNumber,percent))}else{this.unschedule(this.scheduleUpdateLabel);this.nowNumber=this._totalNumber}this.nowNumber=(this.nowNumber.match(/^[1-9]\d*|^0$/)||["0"])[0];var label=this.isUseCurrencyString?this.nowNumber.replace(/\d(?=(?:\d{3})+$)/g,c=>c+","):this.nowNumber;if(this._isAddSymbol)if(this._isSymbolAtFront)label=this.symbol+label;else label=label+this.symbol;else if(this._format){if(this.isUseCurrencyString){this._format=this._format.replace("%d","%s");
this._format=this._format.replace("%f","%s")}label=JSStringUtility.format(this._format,label)}this.setString(label);this._updateCallback&&this._updateCallback(this.nowNumber)},setToNumber:function(toNumber,isAnimation=true){toNumber=JSCodeUtility.getStringValue(toNumber).match(/^[1-9]\d*|^0$/);toNumber=toNumber?toNumber[0]:"";if(toNumber.length===0){cc.log("Error: GSBigNumberLabel Number is invalid");return}if(isAnimation){this._totalNumber=toNumber;this._floorNumber=this.nowNumber;this._usedTime=
0;if(this._floorNumber===this._totalNumber)return;this.unschedule(this.scheduleUpdateLabel);this.schedule(this.scheduleUpdateLabel);this._deltaNumber=JSCodeUtility.bigNumberSub(this._totalNumber,this._floorNumber)}else{this._totalNumber=toNumber;this._floorNumber=this.nowNumber;this.scheduleUpdateLabel(this.updateTime)}}});var GSNumberNode=cc.Node.extend({ctor:function(number,prefixName,numberSize,dotSize,addPlus,addComma,maxWidth=0,numberFormat="%02d"){this._super();this.setCascadeColorEnabled(true);this.setCascadeOpacityEnabled(true);this._spriteArray=[];this._prefixName="";this._totalNumber=0;this._nowNumber=0;this._floorNumber=0;this._usedTime=0;this._updateTime=.5;this._docOfssetY=0;this._finishCallback=null;this._prefixMarkName="";this._prefixMarkSize=cc.size(0,0);this._prefixMarkSprite=null;this._suffixMarkName=
"";this._suffixMarkSize=cc.size(0,0);this._suffixMarkSprite=null;this._nowEffectIndex=0;this._markScale=1;this._numberScale=1;this._isAnim=false;this._originalScale=0;this._needAddPlus=!!addPlus;this._needAddComma=!!addComma;this._totalDotCount=0;this._prefixName=prefixName||"";this._numberSize=numberSize||cc.size(0,0);this._dotSize=dotSize||cc.size(0,0);this._maxWidth=maxWidth||0;this._numberFormat=numberFormat;number>=0&&this.setNumber(number);this.setAnchorPoint(cc.p(.5,.5))},setUpdateTime:function(updateTime){this._updateTime=
updateTime},setAnchorPoint:function(anchorPoint,y){if(typeof y!=="undefined")anchorPoint=cc.p(anchorPoint,y);this._super(anchorPoint);this.updatePosition()},updatePosition:function(){var totalSize=(this._spriteArray.length-this._totalDotCount)*this._numberSize.width+this._totalDotCount*this._dotSize.width;if(this._prefixMarkName.length)totalSize=totalSize-this._numberSize.width+this._prefixMarkSize.width;if(this._suffixMarkName.length)totalSize=totalSize-this._numberSize.width+this._suffixMarkSize.width;
this.setContentSize(cc.size(totalSize,this._numberSize.height));var nowWidth=0;var dotCount=0;for(var i=0;i<this._spriteArray.length;i++){var numberSprite=this._spriteArray[i];numberSprite.setPosition(totalSize-this._numberSize.width/2-nowWidth,this._numberSize.height/2);if(this._prefixMarkName.length&&numberSprite==this._prefixMarkSprite){numberSprite.setPosition(totalSize-this._prefixMarkSize.width/2-nowWidth,this._numberSize.height/2);nowWidth+=this._prefixMarkSize.width}else if(this._suffixMarkName.length&&
numberSprite==this._suffixMarkSprite){numberSprite.setPosition(totalSize-this._suffixMarkSize.width/2-nowWidth,this._numberSize.height/2);nowWidth+=this._suffixMarkSize.width}else nowWidth+=this._numberSize.width;if(this._needAddComma&&dotCount<this._totalDotCount){var posNum=this._suffixMarkName.length?1:0;if((i-2)%4===posNum){nowWidth-=this._numberSize.width;nowWidth+=this._numberSize.width/2;nowWidth+=this._dotSize.width/2;var numberSprite=this._spriteArray[i+1];numberSprite.setPosition(totalSize-
this._numberSize.width/2-nowWidth,this._numberSize.height/2+this._docOfssetY);nowWidth+=this._dotSize.width/2;nowWidth+=this._numberSize.width/2;i++;dotCount++}}}if(this._maxWidth)if(totalSize>this._maxWidth){if(!this._originalScale)this._originalScale=this.getScale();this.setScale(this._maxWidth/totalSize*this._originalScale)}else if(this._originalScale&&this.getScale()!=this._originalScale){this.setScale(this._originalScale);this._originalScale=0}},setNumber:function(number,actionParam){this.removeAllChildren();
this._spriteArray.length=0;if(number<0){cc.log("Error: GSNumberNode Number < 0");return}if(Number.isNaN(number)){cc.error("GSNumberNode Number is NaN");return}number=JSCodeUtility.getIntValue(number);this._nowNumber=number;var nowNumber=number;var i=0;this._totalDotCount=0;if(this._suffixMarkName.length){var suffixMarkSprite=this._suffixMarkSprite=new cc.Sprite("#"+this._suffixMarkName);suffixMarkSprite.setScale(this._markScale);this.addChild(suffixMarkSprite);this._spriteArray.push(suffixMarkSprite)}do{var imageName=
JSStringUtility.format("#%s_"+this._numberFormat+".png",this._prefixName,Math.abs(nowNumber%10));var numberSprite=new cc.Sprite(imageName);numberSprite.setScale(this._numberScale);this.addChild(numberSprite);nowNumber=Math.floor(nowNumber/10);i++;this._spriteArray.push(numberSprite);if(this._needAddComma&&i%3===0&&nowNumber!==0){var dotSprite=new cc.Sprite(JSStringUtility.format("#%s_%s.png",this._prefixName,","));dotSprite.setPositionY(this._docOfssetY);dotSprite.setScale(this._numberScale);this.addChild(dotSprite);
this._totalDotCount++;this._spriteArray.push(dotSprite)}}while(Math.abs(nowNumber)>0);if(this._prefixMarkName.length){var prefixMarkSprite=this._prefixMarkSprite=new cc.Sprite("#"+this._prefixMarkName);prefixMarkSprite.setScale(this._markScale);this.addChild(prefixMarkSprite);this._spriteArray.push(prefixMarkSprite)}if(actionParam){var action=actionParam.action;this._spriteArray.forEach((sprite,index,array)=>{var actionClone=action.clone();if(index===array.length-1){var actionCallBack=cc.callFunc(()=>
{this._finishCallback&&this._finishCallback()});sprite.setOpacity(0);sprite.runAction(cc.sequence(cc.delayTime(actionParam.time*(array.length-index)),actionClone,actionCallBack))}else sprite.runAction(cc.sequence(cc.delayTime(actionParam.time*(array.length-index)),actionClone))})}this.updatePosition()},getNumber:function(){return this._isAnim?this._totalNumber:this._nowNumber},getNowNumber:function(){return this._nowNumber},setToNumber:function(toNumber,animation){if(JSCodeUtility.checkType(animation)!=
JSTYPE.BOOLEAN)animation=true;if(toNumber<0){cc.log("Error: GSNumberNode Number < 0");return}if(this._totalNumber===toNumber&&animation===this._isAnim)return;this.unschedule(this.scheduleUpdateNumber);this._isAnim=false;if(animation){this._totalNumber=toNumber;this._floorNumber=this._nowNumber;this._usedTime=0;if(this._floorNumber==this._totalNumber){this.setNumber(this._totalNumber);return}else{this.schedule(this.scheduleUpdateNumber);this._isAnim=true}}else{this._totalNumber=toNumber;this.setNumber(toNumber)}},
scheduleUpdateNumber:function(dt){this._usedTime+=JSCodeUtility.getRandomFloat(dt,dt*1.1);if(this._usedTime<this._updateTime){this._nowNumber=this._floorNumber+(this._totalNumber-this._floorNumber)*(this._usedTime/this._updateTime);var parentVisible=this.getParent().isVisible();if(parentVisible&&this.isVisible()&&this._effect)if(this._usedTime>this._nowEffectIndex)this._nowEffectIndex+=this._frequency}else{this.unschedule(this.scheduleUpdateNumber);this._isAnim=false;this._nowNumber=this._totalNumber;
this._nowEffectIndex=0;if(this._finishCallback){var action1=cc.delayTime(dt);var action2=cc.callFunc(()=>{this._finishCallback()});this.runAction(cc.sequence(action1,action2))}}this.setNumber(this._nowNumber)},stopAnimAndToTotalNumber:function(){if(this._isAnim){this.unschedule(this.scheduleUpdateNumber);this.setToNumber(this._totalNumber,false);this._isAnim=false}},setDocOffsetY:function(value){this._docOfssetY=value;this.updatePosition()},setPrefixMark:function(imageName,markSize){this._prefixMarkName=
imageName;if(markSize)this._prefixMarkSize=markSize;else this._prefixMarkSize=this._numberSize;this.setNumber(this._nowNumber)},setSuffixMark:function(imageName,markSize){this._suffixMarkName=imageName;if(markSize)this._suffixMarkSize=markSize;else this._suffixMarkSize=this._numberSize;this.setNumber(this._nowNumber)},setPrefixName:function(prefixName){this._prefixName=prefixName||"";this.setNumber(this._nowNumber)},setEffect:function(effect,frequency){this._effect=effect;this._frequency=frequency},
setNumberScale:function(value){if(this._numberScale===value)return;this._numberScale=value;this.setNumber(this._nowNumber)},setFinishCallback:function(callback){if(callback)this._finishCallback=callback}});let GSBigNumberNode=GSNumberNode.extend({ctor:function(number,prefixName,numberSize,dotSize,addPlus,addComma,maxWidth=0,numberFormat="%02d"){this._super(0,prefixName,numberSize,dotSize,addPlus,addComma,maxWidth,numberFormat);this._totalNumber="0";this._nowNumber="0";this._floorNumber="0";this._deltaNumber="0";number>0&&this.setNumber(number)},setNumber:function(number,actionParam){this.removeAllChildren();this._spriteArray.length=0;number=JSCodeUtility.getStringValue(number).match(/^[1-9]\d*|^0$/);
number=number?number[0]:"";if(number.length===0){cc.log("Error: GSBigNumberLabel Number is invalid");return}this._nowNumber=number;var nowNumber=number.split("");var i=0;this._totalDotCount=0;if(this._suffixMarkName.length){var suffixMarkSprite=this._suffixMarkSprite=new cc.Sprite("#"+this._suffixMarkName);suffixMarkSprite.setScale(this._markScale);this.addChild(suffixMarkSprite);this._spriteArray.push(suffixMarkSprite)}do{var imageName=JSStringUtility.format("#%s_"+this._numberFormat+".png",this._prefixName,
nowNumber.pop());var numberSprite=new cc.Sprite(imageName);numberSprite.setScale(this._numberScale);this.addChild(numberSprite);i++;this._spriteArray.push(numberSprite);if(this._needAddComma&&i%3===0&&nowNumber.length!==0){var dotSprite=new cc.Sprite(JSStringUtility.format("#%s_%s.png",this._prefixName,","));dotSprite.setPositionY(this._docOfssetY);dotSprite.setScale(this._numberScale);this.addChild(dotSprite);this._totalDotCount++;this._spriteArray.push(dotSprite)}}while(nowNumber.length>0);if(this._prefixMarkName.length){var prefixMarkSprite=
this._prefixMarkSprite=new cc.Sprite("#"+this._prefixMarkName);prefixMarkSprite.setScale(this._markScale);this.addChild(prefixMarkSprite);this._spriteArray.push(prefixMarkSprite)}if(actionParam){var action=actionParam.action;this._spriteArray.forEach((sprite,index,array)=>{var actionClone=action.clone();if(index===array.length-1){var actionCallBack=cc.callFunc(()=>{this._finishCallback&&this._finishCallback()});sprite.setOpacity(0);sprite.runAction(cc.sequence(cc.delayTime(actionParam.time*(array.length-
index)),actionClone,actionCallBack))}else sprite.runAction(cc.sequence(cc.delayTime(actionParam.time*(array.length-index)),actionClone))})}this.updatePosition()},setToNumber:function(toNumber,animation){if(JSCodeUtility.checkType(animation)!=JSTYPE.BOOLEAN)animation=true;toNumber=JSCodeUtility.getStringValue(toNumber).match(/^[1-9]\d*|^0$/);toNumber=toNumber?toNumber[0]:"";if(toNumber.length===0){cc.log("Error: GSBigNumberLabel Number is invalid");return}if(this._totalNumber===toNumber&&animation===
this._isAnim)return;this.unschedule(this.scheduleUpdateNumber);this._isAnim=false;if(animation){this._totalNumber=toNumber;this._floorNumber=this._nowNumber;this._usedTime=0;if(this._floorNumber==this._totalNumber){this.setNumber(this._totalNumber);return}else{this.schedule(this.scheduleUpdateNumber);this._isAnim=true;this._deltaNumber=JSCodeUtility.bigNumberSub(this._totalNumber,this._floorNumber)}}else{this._totalNumber=toNumber;this.setNumber(toNumber)}},scheduleUpdateNumber:function(dt){this._usedTime+=
JSCodeUtility.getRandomFloat(dt,dt*1.1);if(this._usedTime<this._updateTime){let percent=JSCodeUtility.getStringValue(this._usedTime/this._updateTime);this._nowNumber=JSCodeUtility.bigNumberAdd(this._floorNumber,JSCodeUtility.bigNumberMultiply(this._deltaNumber,percent));var parentVisible=this.getParent().isVisible();if(parentVisible&&this.isVisible()&&this._effect)if(this._usedTime>this._nowEffectIndex)this._nowEffectIndex+=this._frequency}else{this.unschedule(this.scheduleUpdateNumber);this._isAnim=
false;this._nowNumber=this._totalNumber;this._nowEffectIndex=0;if(this._finishCallback){var action1=cc.delayTime(dt);var action2=cc.callFunc(()=>{this._finishCallback()});this.runAction(cc.sequence(action1,action2))}}this.setNumber(this._nowNumber)}});var GSOpenAppWrapper={};
(function(){var isNative=cc.sys.isNative;GSOpenAppWrapper.shareMessageByWhatsapp=function(message){return isNative&&GSOpenApp.shareMessageByWhatsapp(message)};GSOpenAppWrapper.sharePhotoByWhatsapp=function(filePath){return isNative&&GSOpenApp.sharePhotoByWhatsapp(filePath)};GSOpenAppWrapper.shareMessageByLine=function(message){return isNative&&GSOpenApp.shareMessageByLine(message)};GSOpenAppWrapper.sharePhotoByLine=function(filePath){return isNative&&GSOpenApp.sharePhotoByLine(filePath)};GSOpenAppWrapper.openLineOfficialAccount=
function(){return isNative&&GSOpenApp.openLineOfficialAccount()};GSOpenAppWrapper.shareMessageByFBMessager=function(message){return isNative&&GSOpenApp.shareMessageByFBMessager(message)};GSOpenAppWrapper.sharePhotoByInstagram=function(filePath){return isNative&&GSOpenApp.sharePhotoByInstagram(filePath)};GSOpenAppWrapper.openSMSApp=function(){isNative&&GSOpenApp.openSMSApp()};GSOpenAppWrapper.openSMSApp=function(phone,body){isNative&&GSOpenApp.openSMSApp(phone,body)};GSOpenAppWrapper.shareImage=function(filePath){isNative&&
GSOpenApp.shareImage(filePath)};GSOpenAppWrapper.shareMessage=function(message){isNative&&GSOpenApp.shareMessage(message)}}).call(window||module||{});var GSPermissionWrapper={};var GSPermissionDelegate=cc.Class.extend({onPermissionChanged:function(permissionName,status){}});
(function(){GSPermissionWrapper.Name={MIC:1,CAMERA:2,WRITE_EXTERNAL:3};GSPermissionWrapper.Status={NotDetermined:0,Authorized:1,Denied:-1};GSPermissionWrapper.getPermissionStatus=function(permission){if(cc.sys.isNative)return GSPermission.getPermissionStatus(permission);return 1};GSPermissionWrapper.requestPermission=function(permission,callback){if(!callback)callback=isSuccess=>{};if(cc.sys.isNative)GSPermission.requestPermission(permission,callback);else callback(true)};var _delegateArray=[];GSPermissionWrapper.addDelegate=
function(context){if(_delegateArray.indexOf(context)<0)_delegateArray.push(context)};GSPermissionWrapper.removeDelegate=function(context){var findIndex=_delegateArray.indexOf(context);if(findIndex>-1)_delegateArray.splice(findIndex,1)};var nativeDelegate={onPermissionChanged:function(permission,status){_delegateArray.forEach(delegate=>{delegate.onPermissionChanged&&delegate.onPermissionChanged(permission,status)})}};cc.sys.isNative&&GSPermission.addDelegate(nativeDelegate);GSPermissionWrapper._doNotToUse=
function(){if(nativeDelegate)GSPermission.addDelegate(nativeDelegate)}})();var GSProgressTimerDirection={HORIZONTAL:0,VERTICAL:1};
var GSProgressTimer=cc.Node.extend({_lastProgress:0,_nowProgress:0,_targetPercent:0,_animationTime:1,_nowTime:0,_isAnimation:false,_isRevert:false,_direction:GSProgressTimerDirection.HORIZONTAL,_updateCallback:null,_finishCallback:null,ctor:function(barBgName,barName,barBgSize,barSize,isUseBarAsStencil=false,offsetX=0){this._super();barSize=barSize||barBgSize;this._barBgSize=barBgSize;this._barSize=barSize;this._offsetX=offsetX;this.setCascadeColorEnabled(true);this.setCascadeOpacityEnabled(true);
var barBg=this._barBg=new ccui.Scale9Sprite(barBgName);barBg.setPreferredSize(barBgSize);this.addChild(barBg);let stencilName=isUseBarAsStencil?barName:barBgName;let stencil=new ccui.Scale9Sprite(stencilName);stencil.setPreferredSize(barSize);var clipNode=this._barNode=new cc.ClippingNode(stencil);clipNode.setAlphaThreshold(.1);clipNode.setCascadeColorEnabled(true);clipNode.setCascadeOpacityEnabled(true);this.addChild(clipNode);var barSp=this._barSp=new ccui.Scale9Sprite(barName);barSp.setPreferredSize(cc.size(barSize.width*
.2,barSize.height));barSp.setPosition(offsetX-barSize.width*.6,0);clipNode.addChild(barSp)},_refreshDirection:function(){if(this._direction===GSProgressTimerDirection.HORIZONTAL){this._barBg.setRotation(this._isRevert?180:0);this._barNode.setRotation(this._isRevert?180:0)}else{this._barBg.setRotation(this._isRevert?90:-90);this._barNode.setRotation(this._isRevert?90:-90)}},update:function(t){this._nowTime+=t;var timeScale=this._nowTime/this._animationTime;if(timeScale>1){this.unscheduleUpdate();timeScale=
1;if(this._isAnimation)this._finishCallback&&this._finishCallback()}var barSp=this._barSp;var targetProgress=this._targetPercent/100;var progress=this._nowProgress=this._lastProgress+timeScale*(targetProgress-this._lastProgress);if(progress<=.2){barSp.setPreferredSize(cc.size(this._barSize.width*.2,this._barSize.height));barSp.setPosition((progress?this._offsetX:0)+this._barSize.width*(progress-.6),0)}else{barSp.setPreferredSize(cc.size(this._barSize.width*progress,this._barSize.height));barSp.setPosition(this._offsetX+
this._barSize.width*(.5*(progress-1)),0)}this._updateCallback&&this._updateCallback(progress)},setDirection:function(direction){this._direction=direction;this._refreshDirection()},setIsRevert:function(isRevert){this._isRevert=isRevert;this._refreshDirection()},setAnimationTime:function(time){this._animationTime=time},setUpdateProgressCallback:function(callback){this._updateCallback=callback},setFinishProgressCallback:function(callback){this._finishCallback=callback},setPercentage:function(percent,
isAnimation=true){if(!percent||percent<0)percent=0;else if(percent>100)percent=100;this.unscheduleUpdate();this._lastProgress=this._nowProgress;this._targetPercent=percent;this._nowTime=0;this._isAnimation=isAnimation;if(isAnimation)this.scheduleUpdate();else this.update(this._animationTime)},getPercentage:function(){return this._targetPercent},getBar:function(){return this._barSp},getBarBg:function(){return this._barBg},setBarBg:function(bgStr){this._barBg.setSpriteFrame(bgStr);this._barBg.setPreferredSize(this._barBgSize)}});var GSPurchaseWrapper={};
(function(){var androidProductIDCache=null;var initDone=false;var iOSPaymentBit=16;GSPurchaseWrapper.init=function(callback){if(cc.sys.isNative&&!initDone){initDone=true;GSPurchase.init(callback);DataProcess.addSocketKeyDispatch(this,{"android_bill_pre":function(key,value){var jsonValue=JSON.parse(value);var productID=JSCodeUtility.getStringValue(jsonValue["productId"]);var payload=JSCodeUtility.getStringValue(jsonValue["payload"]);if(androidProductIDCache&&productID===androidProductIDCache.productID)GSPurchase.purchase(productID,payload,
androidProductIDCache.callback)}})}};GSPurchaseWrapper.setiOSPaymentBit=function(paymentBit){if(paymentBit)iOSPaymentBit=paymentBit};GSPurchaseWrapper.fetchProductInfo=function(productIDArray,callback){if(cc.sys.isNative)GSPurchase.fetchProductInfo(productIDArray,callback)};GSPurchaseWrapper.checkOldPurchase=function(){if(cc.sys.isNative)GSPurchase.checkOldPurchase()};GSPurchaseWrapper.purchase=function(productID,payload,callback){if(cc.sys.isNative)if(cc.sys.os==cc.sys.OS_ANDROID)if(payload)GSPurchase.purchase(productID,
payload,callback);else{androidProductIDCache={productID:productID,callback:callback};DataProcess.sendString("android_bill_pre "+JSON.stringify([productID]))}else GSPurchase.purchase(productID,"",callback)};GSPurchaseWrapper.finishTransaction=function(productID){if(cc.sys.isNative)GSPurchase.finishTransaction(productID)};GSPurchaseWrapper.finishAllTransaction=function(){if(cc.sys.isNative)GSPurchase.finishAllTransaction()};GSPurchaseWrapper.getPaymentBit=function(){if(cc.sys.isNative)if(cc.sys.os===
cc.sys.OS_ANDROID)return jsb.reflection.callStaticMethod("com/gamesofa/activity/GameInstance","getPaymentBit_","()I");else return iOSPaymentBit;else return 15}})();var GSRichTextNode=ccui.RichText.extend({ctor:function(text,fontName,fontSize,contentSize,flag,outlineColor,outlineSize){ccui.RichText.prototype.ctor.call(this);this.setCascadeOpacityEnabled(true);this.setCascadeColorEnabled(true);this._elementTag=0;this._text="";this._fontSize=0;this._defaultTextColor=JSColor.WHITE;this._outlineColor=outlineColor;this._outlineSize=outlineSize;if(!contentSize){this.ignoreContentAdaptWithSize(true);contentSize=cc.size(0,0)}else this.ignoreContentAdaptWithSize(false);
this._gsCustomSize=contentSize;this.setContentSize(contentSize);text&&this.addComplexText(text,fontName,fontSize)},addComplexText:function(text,fontName,fontSize){this._text=text;this._fontSize=fontSize;if(cc.sys.isNative)if(text[text.length-1]==="\n")text+=" ";var textColor=this._defaultTextColor;var textSize=this._fontSize;text.replace(GSRichTextNode.REGEXP_RICH_TEXT,(matchStr,color,opacity,fontSize,str)=>{if(!matchStr)return;fontSize=textSize=parseFloat(fontSize||textSize);color=textColor=color?
cc.hexToColor(color):textColor;opacity=opacity?parseInt("0x"+opacity):255;this.addPureText(str,fontName,fontSize,color,opacity)});this.formatText()},addPureText:function(text,fontName,fontSize,color,opacity){text=text.replace(/\n\n/g,"\n \n");var textArray=text.split("\n");var textLastIndex=textArray.length-1;textArray.forEach((curText,i)=>{var richElement=this._outlineColor&&this._outlineSize?new ccui.RichElementText(this._elementTag,color,opacity,curText,fontName,fontSize,32,this._outlineColor,
this._outlineSize):new ccui.RichElementText(this._elementTag,color,opacity,curText,fontName,fontSize);this.pushBackElement(richElement);this._elementTag++;if(i<textLastIndex){var newLine=new ccui.RichElementNewLine(this._elementTag,JSColor.WHITE,0);this.pushBackElement(newLine);this._elementTag++}})},setText:function(text,fontName,fontSize,customSize){this.removeAllElement();if(customSize)this._gsCustomSize=customSize;this.setContentSize(this._gsCustomSize);this.addComplexText(text,fontName,fontSize)},
setDefaultTextColor:function(color){this._defaultTextColor=color},getText:function(){return this._text},getFontSize:function(){return this._fontSize},runTypewriter:function(speed,callback){var actionTag=291842;var originalText=this._text;this.setText("",JSFontBoldName,this._fontSize);var typewriterFunc=()=>{var nowText=this._text;var nowLen=nowText.length;var front=originalText.indexOf("#!",nowLen);var back=originalText.indexOf("!#",front);var addWord=1;if(nowLen===front)addWord=back+3-front;var breakLineFront=
originalText.indexOf("\n",nowLen);if(nowLen===breakLineFront)addWord=2;this.setText(originalText.substr(0,nowLen+addWord),JSFontBoldName,this._fontSize);if(this._text===originalText){this.stopActionByTag(actionTag);callback&&callback()}};var action=cc.repeatForever(cc.sequence(cc.callFunc(typewriterFunc),cc.delayTime(speed)));action.setTag(actionTag);this.stopActionByTag(actionTag);this.runAction(action)}});
if(!cc.sys.isNative)GSRichTextNode.prototype.getBoundingBox=function(){var boundingBox=ccui.RichText.prototype.getBoundingBox.call(this);return cc.rect(boundingBox.x,boundingBox.y,boundingBox.width*this.getScaleX(),boundingBox.height*this.getScaleY())};GSRichTextNode.REGEXP_RICH_TEXT=/(?:#!([0-9,A-F]{6})?([0-9,A-F]{2})?(?:\$!(\d*(?:\.\d*)?)!\$)?!#)?([\w\W]*?)(?=#!|$)/gi;var GSScale9Sprite=ccui.Scale9Sprite.extend({_updateSize:function(dt){this._nowTime+=dt;if(this._nowTime>this._toTime){this.setPreferredSize(this._endSize);this.unschedule(this._updateSize)}else{var percent=this._nowTime/this._toTime;var newSize=cc.size(this._startSize.width+this._deltaWidth*percent,this._startSize.height+this._deltaHeight*percent);this.setPreferredSize(newSize)}},runSizeAnimation:function(duration,newSize){this.unschedule(this._updateSize);this._toTime=duration;this._nowTime=0;this._endSize=
newSize;var oldSize=this._startSize=this.getPreferredSize();this._deltaWidth=newSize.width-oldSize.width;this._deltaHeight=newSize.height-oldSize.height;this.schedule(this._updateSize)}});var GSScratchAreaNode=cc.Node.extend({ctor:function(coverNode,contentNode,coverBoundingBox,scratchImage,bgSprite=undefined){this._super();bgSprite&&this.addChild(bgSprite);this._scratchImage=scratchImage;var scratchSprite=this._scratchSprite=new cc.Sprite(scratchImage);scratchSprite.setVisible(false);this.addChild(scratchSprite);contentNode&&this.addChild(contentNode);var contentRect=this._bgRect=coverBoundingBox;if(contentRect.width<=0||contentRect.height<=0){cc.log("Error: contentRect empty");contentRect=
cc.rect(0,0,JSVisibleSize.width,JSVisibleSize.height)}var stencilNode=new cc.Node;var renderTexture=this._renderTexture=new cc.RenderTexture(JSVisibleSize.width,JSVisibleSize.height,cc.Texture2D.PIXEL_FORMAT_RGBA8888);renderTexture.getSprite().getTexture().setAntiAliasTexParameters();renderTexture.setPosition(JSScreenMidPos.x,JSScreenMidPos.y);stencilNode.addChild(renderTexture);var clippingNode=this._clippingNode=new cc.ClippingNode(stencilNode);clippingNode.setCascadeOpacityEnabled(true);clippingNode.setAlphaThreshold(.05);
clippingNode.setInverted(true);this.addChild(clippingNode);clippingNode.addChild(coverNode);this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:true,onTouchBegan:this._onTouchBegan.bind(this),onTouchMoved:this._onTouchMoved.bind(this),onTouchEnded:this._onTouchEnded.bind(this),onTouchCancelled:this._onTouchCancelled.bind(this)});cc.eventManager.addListener(this._touchListener,this)},_scratchingArea:function(touch){var touchPos=this._clippingNode.convertToNodeSpace(touch.getLocation());
var renderTexture=this._renderTexture;var scratchMaskSprite=this._scratchSprite;if(!cc.rectContainsPoint(this._bgRect,this.convertToNodeSpace(touch.getLocation()))){cc.log("Warning: \u4e0d\u5728\u522e\u7684\u7bc4\u570d\u5167");return}touchPos=cc.p(Math.round(touchPos.x),Math.round(touchPos.y));renderTexture.begin();scratchMaskSprite.setPosition(touchPos);scratchMaskSprite.setVisible(true);scratchMaskSprite.visit();scratchMaskSprite.setVisible(false);renderTexture.end();cc.director.getRenderer().render()},
runAutoScratchingAreaAsync:function(pointArray,totalSec=1){return new Promise(resolve=>{if(this._touchListener!=null)cc.eventManager.removeListener(this._touchListener);var autoScratchSprite=this._autoScratchSprite=new cc.Sprite(this._scratchImage);autoScratchSprite.setVisible(false);this.addChild(autoScratchSprite);this.schedule(this.updateScratching);var unitTime=totalSec/pointArray.length;var moveScratchingAsync=(nowPos,nextPos)=>{return new Promise(resolveMove=>{if(!nextPos){resolveMove();this.unschedule(this.updateScratching);
return}autoScratchSprite.setPosition(nowPos);autoScratchSprite.runAction(cc.sequence(cc.moveTo(unitTime,nextPos),cc.callFunc(resolveMove)))})};pointArray.reduce((p,cur,curIndex,curArray)=>{if(cur)p=p.then(()=>moveScratchingAsync(cur,curArray[curIndex+1]));return p},Promise.resolve()).then(resolve)})},updateScratching:function(){var obj={};obj.getLocation=()=>{return this.convertToWorldSpace(this._autoScratchSprite.getPosition())};this._scratchingArea(obj)},_onTouchBegan:function(touch,event){var target=
event.getCurrentTarget();if(!target.isVisible())return false;for(var c=target.parent;c!=null;c=c.parent)if(!c.isVisible())return false;this._scratchingArea(touch);return true},_onTouchMoved:function(touch,event){this._scratchingArea(touch)},_onTouchEnded:function(touch,event){this._scratchingArea(touch)},_onTouchCancelled:function(touch,event){this._onTouchEnded(touch,event)}});var GSScrollBar=cc.Node.extend({ctor:function(scrollView,image="common_scroll_bar.png",direction=cc.SCROLLVIEW_DIRECTION_VERTICAL,isReverse){this._super();this.setCascadeOpacityEnabled(true);var targetPosition,anchor;var viewSize=this._viewSize=scrollView.getViewSize();this._minBarLength=1;this._scrollLength=direction===cc.SCROLLVIEW_DIRECTION_VERTICAL?viewSize.height:viewSize.width;this._scrollView=scrollView;this._direction=direction;this._isReverse=isReverse;this._autoFadeOut=false;switch(direction){case cc.SCROLLVIEW_DIRECTION_VERTICAL:targetPosition=
this._targetPosition=cc.p(viewSize.width,0);anchor=cc.p(.5,0);break;case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:targetPosition=this._targetPosition=cc.p(0,0);anchor=cc.p(0,.5);break}var barNode=this._barNode=new cc.Node;barNode.setCascadeOpacityEnabled(true);barNode.setPosition(targetPosition);this.addChild(barNode,1);var barSprite=this._barSprite=new ccui.Scale9Sprite(image);barSprite.setOpacity(100);barSprite.setAnchorPoint(anchor);barNode.addChild(barSprite);this._baseSize=barSprite.getContentSize()},
onExit:function(){this._listener&&cc.eventManager.removeListener(this._listener);this._super()},setBarSize:function(size){this._baseSize=size},setTrackBg:function(image,size,color){if(!image)return;var trackSprite=this._trackSprite=new ccui.Scale9Sprite(image);trackSprite.setAnchorPoint(this._barSprite.getAnchorPoint());color&&trackSprite.setColor(color);trackSprite.setPosition(this._targetPosition);this.addChild(trackSprite);if(!size){var contentSize=trackSprite.getContentSize();switch(this._direction){case cc.SCROLLVIEW_DIRECTION_VERTICAL:size=
cc.size(contentSize.width,this._viewSize.height);break;case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:size=cc.size(this._viewSize.width,contentSize.height);break}}trackSprite.setPreferredSize(size)},getTrackBg:function(){return this._trackSprite},setArrowBtn:function(nodes,delayTime=.01){if(!nodes)return;var targetPos=this._targetPosition;var boundingBox=nodes[0].getBoundingBox();var size=cc.size(boundingBox.width,boundingBox.height);this.minusPercent=-.01;this.plusPercent=.01;nodes.forEach((node,idx)=>
{var pos=cc.p(targetPos.x,targetPos.y+(this._viewSize.height-size.height)*idx+size.height/2);var getNowPercentFunc=()=>this._barSprite.getPositionY()/this._scrollLength;switch(this._direction){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:pos=cc.p(targetPos.x+(this._viewSize.width-size.width)*idx+size.width/2,targetPos.y);getNowPercentFunc=()=>this._barSprite.getPositionX()/this._scrollLength;break}var isPercentDeclined=idx===0;var btnActionFunc=(sender,type)=>{if(type===cc.CONTROL_EVENT_TOUCH_DOWN)this.runAction(cc.repeatForever(cc.sequence(cc.callFunc(()=>
{var nowPercent=getNowPercentFunc();var percentValue=nowPercent+(isPercentDeclined?this.minusPercent:this.plusPercent);this.doBarDragCallback(percentValue)}),cc.delayTime(delayTime))));else this.stopAllActions()};var btn=new GSControlButton(node);btn.setPosition(pos);btn.addTargetWithActionForControlEvents(this,btnActionFunc,cc.CONTROL_EVENT_TOUCH_DOWN|cc.CONTROL_EVENT_TOUCH_CANCEL|cc.CONTROL_EVENT_TOUCH_UP_INSIDE|cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE);this.addChild(btn,1)});switch(this._direction){case cc.SCROLLVIEW_DIRECTION_VERTICAL:this._barNode.setPositionY(targetPos.y+
size.height);this._scrollLength-=size.height*2;break;case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:this._barNode.setPositionX(targetPos.x+size.width);this._scrollLength-=size.width*2;break}},setMinBarLength:function(length){if(this._minBarLength!==length)this._minBarLength=length},setBarColor:function(color){this._barSprite.setColor(color)},setBarOpacity:function(opacity){this._barSprite.setOpacity(opacity)},setAutoFadeOut:function(value){this._autoFadeOut=value;this.refresh()},setBarDragCallback:function(callback){this._barDragCallback=
callback;if(callback){if(!this._listener){var listener=this._listener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:true,onTouchBegan:this.onTouchBegan.bind(this),onTouchMoved:this.onTouchMoved.bind(this),onTouchEnded:this.onTouchEnded.bind(this),onTouchCancelled:this.onTouchCancelled.bind(this)});cc.eventManager.addListener(listener,this)}}else if(this._listener){cc.eventManager.removeListener(this._listener);this._listener=null}},doBarDragCallback:function(value){var percentValue=
this._isReverse?this._maxPercent-value:value;percentValue=Math.max(Math.min(percentValue,this._maxPercent),this._minPercent);this._barDragCallback&&this._barDragCallback(percentValue)},refresh:function(){var targetSize=this._scrollView.getContentSize();var contentOffset=this._scrollView.getContentOffset();var barSprite=this._barSprite;var viewLength=0;var contentLength=0;var offsetLength=0;var setPreferredSizeFunc;var setPositionFunc;switch(this._direction){case cc.SCROLLVIEW_DIRECTION_VERTICAL:viewLength=
this._viewSize.height;contentLength=targetSize.height;offsetLength=-contentOffset.y;setPreferredSizeFunc=length=>barSprite.setPreferredSize(cc.size(this._baseSize.width,length));setPositionFunc=value=>barSprite.setPositionY(value);break;case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:viewLength=this._viewSize.width;contentLength=targetSize.width;offsetLength=-contentOffset.x;setPreferredSizeFunc=length=>barSprite.setPreferredSize(cc.size(length,this._baseSize.height));setPositionFunc=value=>barSprite.setPositionX(value);
break}var maxPercent=this._maxPercent=1-viewLength/contentLength;var minPercent=this._minPercent=maxPercent<0?maxPercent:0;var scrollLength=this._scrollLength;var barLength=scrollLength;var value=0;if(contentLength>viewLength){barLength=scrollLength*(viewLength/contentLength);var posPercent=this._isReverse?maxPercent-offsetLength/contentLength:offsetLength/contentLength;value=scrollLength*posPercent;if(barLength<this._minBarLength){var lenDiff=(this._minBarLength-barLength)/2;if(value<lenDiff){barLength=
this._minBarLength-(lenDiff-value);value=0}else if(value>scrollLength-lenDiff-barLength){barLength=scrollLength-value+lenDiff;value-=lenDiff}else{barLength=this._minBarLength;value-=lenDiff}}if(posPercent<minPercent){barLength+=value;value=0}else if(posPercent>maxPercent)barLength=scrollLength-value}setPreferredSizeFunc&&setPreferredSizeFunc(barLength);setPositionFunc&&setPositionFunc(value);if(this._autoFadeOut){this.setOpacity(255);this.stopAllActions();this.runAction(cc.sequence(cc.delayTime(1),
cc.fadeOut(.2)))}},onTouchBegan:function(touch,event){if(!this.isVisible())return false;for(var parentNode=this.getParent();parentNode!=null;parentNode=parentNode.getParent())if(!parentNode.isVisible())return false;var barSprite=this._barSprite;var touchPos=this._barNode.convertToNodeSpace(touch.getLocation());if(cc.rectContainsPoint(barSprite.getBoundingBox(),touchPos)){this._touchOffset=cc.pSub(touchPos,barSprite.getPosition());barSprite.setColor(JSColor.GRAY);return true}else return false},onTouchMoved:function(touch,
event){var touchPos=this._barNode.convertToNodeSpace(touch.getLocation());var nsp=cc.pSub(touchPos,this._touchOffset);var value=0;switch(this._direction){case cc.SCROLLVIEW_DIRECTION_VERTICAL:value=nsp.y;break;case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:value=nsp.x;break}this.doBarDragCallback(value/this._scrollLength)},onTouchEnded:function(touch,event){this._barSprite.setColor(JSColor.WHITE)},onTouchCancelled:function(touch,event){this._barSprite.setColor(JSColor.WHITE)}});var GSSignInWithAppleWrapper={};(function(){GSSignInWithAppleWrapper.isSupport=function(){if(cc.sys.isNative)return GSSignInWithApple.isSupport();return false};GSSignInWithAppleWrapper.signIn=function(callback){if(cc.sys.isNative)GSSignInWithApple.signIn(callback)}})();var GSSpriteCacheParam=function(plist,pngFile){this.plist=plist;this.pngFile=pngFile};var GSSpriteNumberNode=cc.Node.extend({SPRITE_WIDTH:36,SPRITE_HEIGHT:26,DOT_WIDTH:25,ctor:function(obj){this._super();this.setCascadeColorEnabled(true);this.setCascadeOpacityEnabled(true);this.setAnchorPoint(.5,.5);this._param=obj;this._numberColor=null;this._spriteArray=[];this._totalDotCount=0;this._totalSymbolCount=0;this._customString=obj.numStr;this._customNumberFormat=obj.numberFormat||"%d";this._dotString=obj.dotStr||"dot";this._decimalPos=obj.decimals!=null?obj.decimals:-1;this._totalNumber=
0;this._nowNumber=0;this._floorNumber=0;this._usedTime=0;this._updateTime=.5;this._symbolWidth=obj.symbolWidth||0;this._symbolHeight=obj.symbolHeight||0;this._numberWidth=obj.spW!=null?obj.spW:this.SPRITE_WIDTH;this._numberHeight=obj.spH!=null?obj.spH:this.SPRITE_HEIGHT;this._dotWidth=obj.dotW!=null?obj.dotW:this.DOT_WIDTH;this._dotHeight=obj.dotH!=null?obj.dotH:0;this._pointWidth=obj.dotW!=null?obj.dotW:this.DOT_WIDTH;this._pointHeight=obj.dotH!=null?obj.dotH:0;this._isDotHeightAsNum=obj.isDotHeightAsNum;
this._symbolScale=obj.symbolScale||1;this._needAddSymbol=obj.symbolName!=null?true:false;this._needAddDot=obj.addDot!=null?true:false;this._isDecimal=false;this._isDelZero=obj.delZer!=null?obj.delZer:false;this._isChineseFormat=obj.isChineseFormat!=null?true:false;this._animationDoneCallback=null;this.setNumber(obj.number)},_updatePosition:function(){var len=this._spriteArray.length;var totalSize=len*this._numberWidth-this._totalSymbolCount*(this._symbolWidth>this._numberWidth?this._numberWidth-this._symbolWidth:
0)-this._totalDotCount*(this._numberWidth-this._dotWidth)-(this._isDecimal?this._pointWidth:0);this.setContentSize(cc.size(totalSize,this._numberHeight));var nowWidth=0;var dotCount=0;var symCount=0;var pointCount=0;var hasPoint=this._decimalPos!==-1;for(var i=0;i<len;i++)if(this._param.symbolLoc&&symCount<this._totalSymbolCount&&(i===0&&this._param.symbolLoc===GSSpriteNumberNode.SymbolLoc.BACK)){var symbol=this._spriteArray[i];symbol.setScale(this._symbolScale);symbol.setPosition(totalSize-this._symbolWidth/
2-nowWidth,this._symbolHeight?this._symbolHeight:this._numberHeight/2);nowWidth+=this._symbolWidth;symCount++}else{var numberSp=this._spriteArray[i];numberSp.setPosition(totalSize-this._numberWidth/2-nowWidth,this._numberHeight/2);nowWidth+=this._numberWidth;var nextIdx=i+1;if(nextIdx-symCount===this._decimalPos&&hasPoint){var numberSp=this._spriteArray[nextIdx];numberSp.setPosition(totalSize-this._pointWidth/2-nowWidth,this._isDotHeightAsNum?this._numberHeight/2:this._pointHeight?this._pointHeight:
numberSp.getContentSize().height/3-this._numberHeight/4);nowWidth+=this._pointWidth;i++;pointCount++}else if(this._needAddDot&&(!hasPoint||nextIdx>this._decimalPos)&&dotCount<this._totalDotCount&&(nextIdx-symCount-dotCount-(hasPoint?this._decimalPos+1:0))%3===0){var numberSp=this._spriteArray[nextIdx];numberSp.setPosition(totalSize-this._dotWidth/2-nowWidth,this._isDotHeightAsNum?this._numberHeight/2:this._dotHeight?this._dotHeight:-this._numberHeight/4);nowWidth+=this._dotWidth;i++;dotCount++}else if(this._needAddSymbol&&
symCount<this._totalSymbolCount&&i+2===len){var numberSp=this._spriteArray[nextIdx];numberSp.setPosition(totalSize-this._symbolWidth/2-nowWidth,this._symbolHeight?this._symbolHeight:this._numberHeight/2);nowWidth+=this._symbolWidth;i=len-1;symCount++}}},setCustomString:function(customString){if(customString===this._customString)return;this._customString=customString;this.setNumber(this._nowNumber)},getNumber:function(){return this._nowNumber},setNumber:function(number){this.removeAllChildren();this._spriteArray.length=
0;if(this._isChineseFormat&&number>=1E4){number=number/1E4;var wordSp=new cc.Sprite(JSStringUtility.format("%swen.png",this._customString));this.addChild(wordSp);this._spriteArray.splice(0,0,wordSp)}var nowNumber=parseInt(number);var decimalNumber=number-nowNumber;if(this._decimalPos===-1||this._decimalPos!==-1&&decimalNumber===0){decimalNumber=0;this._decimalPos=-1}else if(decimalNumber!==0)this._decimalPos=this._decimalPos===-1?1:this._decimalPos;this._isDecimal=decimalNumber!==0;var isCheckDecimal=
decimalNumber===0;this._totalDotCount=0;this._totalSymbolCount=0;this._nowNumber=number;nowNumber=nowNumber<0?0:nowNumber;var i=0;var j=0;do{if(!isCheckDecimal)if(j!==0&&this._isDelZero){var intNum=parseInt(decimalNumber);if(intNum===0){this._decimalPos=j-1;isCheckDecimal=true;continue}}else isCheckDecimal=j>this._decimalPos&&this._decimalPos!==-1;if(j<=this._decimalPos&&this._decimalPos!==-1&&!isCheckDecimal){var integerNumber=parseInt(decimalNumber);if(j===0){var pointSp=new cc.Sprite(JSStringUtility.format("%spoint.png",
this._customString));this.addChild(pointSp);this._spriteArray.push(pointSp)}else{var numberSp=new cc.Sprite(JSStringUtility.format("%s"+this._customNumberFormat+".png",this._customString,integerNumber));this.addChild(numberSp);this._spriteArray.splice(0,0,numberSp)}decimalNumber-=integerNumber;decimalNumber*=10;decimalNumber+=Math.pow(.1,this._decimalPos+1-j);j++}else{var s=JSStringUtility.format("%s"+this._customNumberFormat+".png",this._customString,nowNumber%10);var numberSp=new cc.Sprite(s);this.addChild(numberSp);
this._spriteArray.push(numberSp);i++;nowNumber=parseInt(nowNumber/10);if(this._needAddDot&&i%3===0&&nowNumber>0){var dotSp=new cc.Sprite(JSStringUtility.format("%s%s.png",this._customString,this._dotString));this.addChild(dotSp);this._spriteArray.push(dotSp);this._totalDotCount++}}}while(nowNumber>0&&isCheckDecimal||!isCheckDecimal);if(this._needAddSymbol){var param=this._param;if(param.symbolName!=null&&param.symbolLoc!=null){var plusSp=new cc.Sprite(param.symbolName);plusSp.setScale(this._symbolScale);
this.addChild(plusSp);this._totalSymbolCount++;if(this._symbolWidth===0)this._symbolWidth=plusSp.getContentSize().width;if(param.symbolLoc===GSSpriteNumberNode.SymbolLoc.FRONT)this._spriteArray.push(plusSp);else if(param.symbolLoc===GSSpriteNumberNode.SymbolLoc.BACK)this._spriteArray.splice(0,0,plusSp)}else{var symbolSp=new cc.Sprite(JSStringUtility.format("%ssymbol.png",this._customString));symbolSp.setScale(this._symbolScale);this.addChild(symbolSp);this._totalSymbolCount++;if(this._symbolWidth===
0)this._symbolWidth=this._numberWidth;this._spriteArray.push(symbolSp)}}this._updatePosition()},setUpdateTime:function(updateTime){this._updateTime=updateTime},setToNumber:function(toNum,isAnim=false,isOnlyUp=false){if(isAnim){this._totalNumber=toNum;if(isOnlyUp&&this._nowNumber>this._totalNumber)this._nowNumber=0;this._floorNumber=this._nowNumber;this._usedTime=0;if(this._floorNumber===this._totalNumber)this.setNumber(this._nowNumber);else{this.unschedule(this.scheduleUpdateNumber);this.schedule(this.scheduleUpdateNumber)}}else this.setNumber(toNum)},
setSymbolSprite:function(obj){this._param.symbolName=obj.symbolName;if(obj.symbolLoc)this._param.symbolLoc=obj.symbolLoc;this._needAddSymbol=obj.symbolName!=null?true:false;this.setNumber(this._nowNumber)},setSymbolSpriteWidth:function(width){if(width>0)this._symbolWidth=width;this._updatePosition()},setNumberSpriteSize:function(width,height){if(width&&width>0)this._numberWidth=width;if(height&&height>0)this._numberHeight=height;this._updatePosition()},setDotSpriteWidth:function(width){if(width>0)this._dotWidth=
width;this._updatePosition()},setPointSpriteWidth:function(width){if(width>0)this._pointWidth=width;this._updatePosition()},scheduleUpdateNumber:function(dt){this._usedTime+=dt;var isDone=this._usedTime>=this._updateTime;if(!isDone)this._nowNumber=parseInt(this._floorNumber)+(this._totalNumber-this._floorNumber)*(this._usedTime/this._updateTime);else{this.unschedule(this.scheduleUpdateNumber);this._nowNumber=this._totalNumber}this.setNumber(this._nowNumber);isDone&&this._animationDoneCallback&&this._animationDoneCallback()},
setAnimationDoneCallback:function(callback){this._animationDoneCallback=callback},stopUpdateNumber:function(){this.unschedule(this.scheduleUpdateNumber);this._usedTime=0;this._nowNumber=this._totalNumber;this.setNumber(this._nowNumber)}});GSSpriteNumberNode.SymbolLoc={NONE:0,FRONT:1,BACK:2};var GSTimeLabel=cc.LabelTTF.extend({ctor:function(){cc.LabelTTF.prototype.ctor.apply(this,arguments);this._formatList=[];this._prevSeconds=-1},setFormat:function(format){this._formatList=[this._createParam(format||"",0)]},setMultiFormat:function(formatDay,formatHour,formatMin,formatSec){this._formatList.length=0;formatDay&&this._formatList.push(this._createParam(formatDay,86400));formatHour&&this._formatList.push(this._createParam(formatHour,3600));formatMin&&this._formatList.push(this._createParam(formatMin,
60));formatSec&&this._formatList.push(this._createParam(formatSec,0))},setSwitchString:function(switchString,switchTime){this._enableSwitch=!!switchString.length;this._switchString=switchString;this._switchTime=switchTime;this._switchTimeTotal=switchTime*2},countdownDate:function(date,callback,tickCallback){this._time=date;this._cb=callback;this._tickCb=tickCallback;this.resumeTimer()},countdownSeconds:function(seconds,callback,tickCallback){this.countdownDate(new Date(Date.now()+seconds*1E3),callback,
tickCallback)},pauseTimer:function(){this.unschedule(this._tick)},resumeTimer:function(){this._tick();this.unschedule(this._tick);this.schedule(this._tick,1/3)},clearTimer:function(){this.unschedule(this._tick);this._time=undefined;this._cb=undefined;this._tickCb=undefined},getRemainderTime:function(){return this._prevSeconds},_tick:function(){if(this.__isDestroyed&&cc.sys.isNative)return;if(!this._time){cc.error("no time set stop countdown");return this.unscheduleAllCallbacks()}var seconds=Math.max(0,
Math.round((this._time-Date.now())/1E3));if(this._prevSeconds===seconds&&seconds!==0)return;var needTick=this._prevSeconds!==seconds;this._prevSeconds=seconds;if(this._enableSwitch&&seconds%this._switchTimeTotal<this._switchTime)this.setString(this._switchString);else this.setString(GSTimeLabel.getDateString(seconds,this._getFormat(seconds)));needTick&&this._tickCb&&this._tickCb(seconds);if(this._time<Date.now()&&!this.__isDestroyed){this.unschedule(this._tick);this._cb&&this._cb();this._time=undefined;
this._cb=undefined;this._tickCb=undefined}},_createParam:function(format,time){var param={format:format,time:time};return param},_getFormat:function(seconds){var formatList=this._formatList;var len=formatList.length;var lastFormat=len-1;for(var i=0;i<len;++i){var cur=formatList[i];if(i===lastFormat||seconds>=cur.time)return cur.format}return""}});
GSTimeLabel.getDateString=function(seconds,format){var output;if(format){var found=false;output=this.TIME_PATTERNS.reduce((str,x)=>{var re=x[0];var num=x[1];str=str.replace(re,match=>{found=true;var unit=Math.floor(seconds/num);return this._padLeft(unit.toString(),match.length-1,"0")});found&&(seconds%=num);return str},format)}else output=this.TIME_PATTERNS.reduce((str,x,i,a)=>{var re=x[0];var num=x[1];var unit=Math.floor(seconds/num);seconds%=num;if(str.length===0)return unit>0||i===a.length-1?unit.toString():
"";else return str+":"+("0"+unit).slice(-2)},"");return output};GSTimeLabel.TIME_PATTERNS=[[/%d+/g,86400],[/%h+/g,3600],[/%m+/g,60],[/%s+/g,1]];GSTimeLabel._padLeft=function(str,len,ch){while(str.length<len)str=ch+str;return str};var GSRichLabelNode=cc.Node.extend({ctor:function(label,fontName,fontSize,dimensions){this._super();this.setCascadeOpacityEnabled(true);this.setCascadeColorEnabled(true);this._label=JSCodeUtility.getStringValue(label);this._pureLabel="";this._fontName=fontName||JSFontBoldName;this._fontSize=fontSize||12;this._hAlignment=cc.TEXT_ALIGNMENT_CENTER;this._defaultTextColor=JSColor.WHITE;this._strokeColor=undefined;this._strokeSize=0;this._shadowColor=undefined;this._shadowOffset=cc.p(0,0);this._shadowBlurRadius=
0;this._minFontSize=0;this._resizeFontSize=0;this._anchorPoint={x:.5,y:.5};this._dimensions=dimensions&&dimensions.width?cc.size(Math.max(dimensions.width,fontSize),dimensions.height):undefined;this._mainAutoNode=new GSAutoLayoutNode;this.addChild(this._mainAutoNode);this._refreshAlignmentPos();label&&this._sortLabelPattern()},onExit:function(){this.clearTimer();this._super()},_sortLabelPattern:function(){var sortedLabelArray=this._sortedLabelArray=[];var maxFontSize=0;var textSize=this._fontSize;
var strokeSize=this._strokeSize;var textColor=this._defaultTextColor;this._pureLabel=this._label.replace(GSRichTextNode.REGEXP_RICH_TEXT,(matchStr,color,opacity,fontSize,str)=>{fontSize=textSize=parseFloat(fontSize||textSize);color=textColor=color?cc.hexToColor(color):textColor;opacity=opacity?parseInt("0x"+opacity):255;str&&sortedLabelArray.push({str:str,size:fontSize,color:color,opacity:opacity});if(this._dimensions&&maxFontSize<fontSize+strokeSize){maxFontSize=fontSize+strokeSize;var dimensions=
this._dimensions;this._dimensions=cc.size(Math.max(dimensions.width,maxFontSize),dimensions.height)}return str});this._sortLabelLineBreak()},_sortLabelLineBreak:function(){var oldLabelArray=this._sortedLabelArray;var sortedLabelArray=this._sortedLabelArray=[];var lineBreakArray=[];oldLabelArray.forEach(param=>{param.str=param.str.replace(/\n\n/g,"\n \n");var textArray=param.str.split("\n");var textLastIndex=textArray.length-1;textArray.forEach((curText,i)=>{lineBreakArray.push({str:curText,size:param.size,
color:param.color,opacity:param.opacity});if(i<textLastIndex){sortedLabelArray.push(lineBreakArray);lineBreakArray=[{str:"",size:param.size,color:param.color,opacity:param.opacity}]}})});sortedLabelArray.push(lineBreakArray);this._checkLabelWidth()},_checkLabelWidth:function(){if(this._dimensions&&this._dimensions.width>0)if(this._minFontSize>0)this._decreaseFontSizeMethod();else this._breakLineMethod();this._showLabel()},_breakLineMethod:function(){var strokeSize=this._strokeSize;var strokeColor=
this._strokeColor;var dimensionsWidth=this._dimensions.width;var sortedLabelArray=this._sortedLabelArray;var label=new cc.LabelTTF("",this._fontName,12);for(var i=0;i<sortedLabelArray.length;i++){var labelWidth=0;var lineArray=sortedLabelArray[i];for(var j=0,lineArrayLen=lineArray.length;j<lineArrayLen;j++){var param=lineArray[j];label.setString(param.str);label.setFontSize(param.size);strokeColor&&label.enableStroke(strokeColor,strokeSize);labelWidth+=label.getContentSize().width;if(labelWidth>dimensionsWidth){var nextLabelWidth=
0;var nextLabel=new cc.LabelTTF("",this._fontName,param.size);strokeColor&&nextLabel.enableStroke(strokeColor,strokeSize);do{var labelStr=new EmojiCharString(label.getString());label.setString(labelStr.substring(0,labelStr.length-1).toString());nextLabel.setString(labelStr.substr(-1)+nextLabel.getString());nextLabelWidth=Math.ceil(nextLabel.getContentSize().width)}while(labelWidth-nextLabelWidth>dimensionsWidth);param.str=label.getString();sortedLabelArray.splice(i+1,0,[{str:nextLabel.getString(),
size:param.size,color:param.color,opacity:param.opacity}].concat(lineArray.slice(j+1,lineArrayLen)));lineArray.length=j+1;break}}}},_decreaseFontSizeMethod:function(){var needToLineBreak=false;var strokeSize=this._strokeSize;var strokeColor=this._strokeColor;var minFontSize=this._minFontSize;var resizeFontSize=this._fontSize+1;var sortedLabelArray=this._sortedLabelArray;var dimensionsWidth=this._dimensions.width;var dimensionsHeight=this._dimensions.height;var maxWidth=0;var maxHeight=0;var labelWidth=
0;var label=new cc.LabelTTF("",this._fontName,12);do{needToLineBreak=resizeFontSize-1<minFontSize;resizeFontSize=needToLineBreak?minFontSize:resizeFontSize-1;maxWidth=0;maxHeight=0;sortedLabelArray.forEach(lineArray=>{labelWidth=0;lineArray.forEach(param=>{param.size=resizeFontSize;label.setString(param.str);label.setFontSize(resizeFontSize);strokeColor&&label.enableStroke(strokeColor,strokeSize);labelWidth+=label.getContentSize().width});maxWidth=Math.max(maxWidth,labelWidth);maxHeight+=label.getContentSize().height});
if(needToLineBreak)break}while(maxWidth>dimensionsWidth||maxHeight>dimensionsHeight);this._resizeFontSize=resizeFontSize;needToLineBreak&&this._breakLineMethod()},_showLabel:function(){var mainAutoNode=this._mainAutoNode;mainAutoNode.removeAllChildren();this._sortedLabelArray.forEach(lineArray=>{var autoNode=new GSAutoLayoutNode;mainAutoNode.addChild(autoNode);lineArray.forEach(param=>{var label=new cc.LabelTTF(param.str,this._fontName,param.size);label.setFontFillColor(param.color);label.setOpacity(param.opacity);
this._strokeColor&&label.enableStroke(this._strokeColor,this._strokeSize);this._shadowColor&&label.enableShadow(this._shadowColor,this._shadowOffset,this._shadowBlurRadius,null);autoNode.addChild(label)});autoNode.refresh()});mainAutoNode.refresh()},_refreshLabelPattern:function(){var mainAutoNode=this._mainAutoNode;mainAutoNode.getChildren().forEach(autoNode=>{autoNode.getChildren().forEach(label=>{this._strokeColor&&label.enableStroke(this._strokeColor,this._strokeSize);this._shadowColor&&label.enableShadow(this._shadowColor,
this._shadowOffset,this._shadowBlurRadius,null)});autoNode.refresh()});mainAutoNode.refresh()},_refreshAlignmentPos:function(){var autoLayoutType;switch(this._hAlignment){case cc.TEXT_ALIGNMENT_LEFT:autoLayoutType=GSAutoLayout.TYPE.VERTICAL_LEFT;break;case cc.TEXT_ALIGNMENT_RIGHT:autoLayoutType=GSAutoLayout.TYPE.VERTICAL_RIGHT;break;default:autoLayoutType=GSAutoLayout.TYPE.VERTICAL;break}this._mainAutoNode.setType(autoLayoutType)},_createTimer:function(){this._timer=new GSTimeLabel("",this._fontName,
this._fontSize);this._timer.setVisible(false);this.addChild(this._timer)},_createNumberUpdater:function(){this._numberUpdater=new GSRichLabelNode.NumberUpdater;this._numberUpdater.setNumberUpdateCallback(()=>{this.setString(this._numberUpdater.getString())})},setAnchorPoint:function(anchorPoint,y){if(typeof y!=="undefined")anchorPoint=cc.p(anchorPoint,y);var tempPoint=this._anchorPoint;tempPoint.x=anchorPoint.x;tempPoint.y=anchorPoint.y;this._super(anchorPoint);this._mainAutoNode.setAnchorPoint(anchorPoint)},
setString:function(label){this._timer&&this.clearTimer();this._label=JSCodeUtility.getStringValue(label);this._sortLabelPattern()},setContentSize:function(size,height){var width=height?size:size.width;height=height?height:size.height;this._dimensions=width?cc.size(Math.max(width,this._fontSize+this._strokeSize),height):undefined;this._sortLabelPattern()},setMinFontSize:function(minFontSize){this._minFontSize=minFontSize;this._resizeFontSize=this._fontSize;this._sortLabelPattern()},setFontSize:function(fontSize){this._fontSize=
fontSize;this._sortLabelPattern()},setFontFillColor:function(fillColor){this._defaultTextColor=fillColor;this._sortLabelPattern()},setHorizontalAlignment:function(alignment){this._hAlignment=alignment;this._refreshAlignmentPos()},setLineBreakSpace:function(space){this._mainAutoNode.setSpace(space)},enableStroke:function(strokeColor,strokeSize){this._strokeColor=strokeColor;this._strokeSize=strokeSize||0;this._refreshLabelPattern()},enableShadow:function(shadowColor,shadowOffset,shadowBlurRadius){this._shadowColor=
shadowColor;this._shadowOffset=shadowOffset||cc.p(0,0);this._shadowBlurRadius=shadowBlurRadius||0;this._refreshLabelPattern()},getString:function(needColorSymbol=false){if(needColorSymbol)return this._label;else return this._pureLabel},getContentSize:function(){return this._dimensions?cc.size(this._dimensions.width,this._mainAutoNode.getContentSize().height):this._mainAutoNode.getContentSize()},getBoundingBox:function(){return this._dimensions?cc.size(this._dimensions.width,this._mainAutoNode.getContentSize().height):
this._mainAutoNode.getContentSize()},getFontSize:function(){return this._minFontSize?this._resizeFontSize:this._fontSize},setFormat:function(format){!this._timer&&this._createTimer();this._timer.setFormat(format)},setMultiFormat:function(formatDay,formatHour,formatMin,formatSec){!this._timer&&this._createTimer();this._timer.setMultiFormat(formatDay,formatHour,formatMin,formatSec)},countdownSeconds:function(seconds,callback=null,tickCallback=null){!this._timer&&this._createTimer();var timer=this._timer;
timer.clearTimer();timer.countdownSeconds(seconds,callback,seconds=>{this._label=timer.getString();this._sortLabelPattern();tickCallback&&tickCallback(seconds)})},pauseTimer:function(){this._timer&&this._timer.pauseTimer()},resumeTimer:function(){this._timer&&this._timer.resumeTimer()},clearTimer:function(){this._timer&&this._timer.clearTimer()},startMarquee:function(duration,marqueeSize){if(this._marqueeNode){this._marqueeNode.removeFromParent();this._marqueeNode=null}var marqueeWidth=marqueeSize.width;
var marqueeHeight=marqueeSize.height;var anchorPoint=this._anchorPoint;var anchorPointY=anchorPoint.y;var stencil=new cc.LayerColor(cc.color(255,255,255,255),marqueeWidth,marqueeHeight);stencil.setPosition(-marqueeWidth/2,-marqueeHeight*anchorPointY);var marqueeNode=this._marqueeNode=new cc.ClippingNode(stencil);this.addChild(marqueeNode);var mainAutoNode=this._mainAutoNode;mainAutoNode.setAnchorPoint(0,anchorPointY);mainAutoNode.setPosition(marqueeWidth,0);mainAutoNode.retain();mainAutoNode.removeFromParent(false);
marqueeNode.addChild(mainAutoNode);mainAutoNode.release();mainAutoNode.stopAllActions();mainAutoNode.runAction(cc.sequence(cc.moveTo(duration,-(marqueeWidth+mainAutoNode.getContentSize().width),0),cc.moveTo(0,marqueeWidth,0)).repeatForever())},stopMarquee:function(){var mainAutoNode=this._mainAutoNode;mainAutoNode.stopAllActions();mainAutoNode.setPosition(0,0);mainAutoNode.retain();mainAutoNode.removeFromParent(false);this.addChild(mainAutoNode);mainAutoNode.release();var anchorPoint=this._anchorPoint;
mainAutoNode.setAnchorPoint(anchorPoint.x,anchorPoint.y)},setUseCurrencyString:function(enable){!this._numberUpdater&&this._createNumberUpdater();this._numberUpdater.setUseCurrencyString(enable)},setSymbol:function(symbol,isFront=false){!this._numberUpdater&&this._createNumberUpdater();this._numberUpdater.setSymbol(symbol,isFront)},setNumberUpdaterFormat:function(format){!this._numberUpdater&&this._createNumberUpdater();this._numberUpdater.setFormat(format)},setUpdateTime:function(updateTime){!this._numberUpdater&&
this._createNumberUpdater();this._numberUpdater.setUpdateTime(updateTime)},setNumberUpdateCallback:function(callback){!this._numberUpdater&&this._createNumberUpdater();this._numberUpdater.setNumberUpdateCallback(nowNumber=>{this.setString(this._numberUpdater.getString());callback&&callback(nowNumber)})},setToNumber:function(toNumber,isAnimation=false){!this._numberUpdater&&this._createNumberUpdater();this._numberUpdater.setToNumber(toNumber,isAnimation)}});
GSRichLabelNode.NumberUpdater=cc.Class.extend({ctor:function(){this._label="";this._totalNumber=0;this._nowNumber=0;this._floorNumber=0;this._isUseCurrencyString=false;this._usedTime=0;this._updateTime=.5;this._format=undefined;this._updateCallback=null},scheduleUpdateLabel:function(dt){this._usedTime+=JSCodeUtility.getRandomFloat(dt,dt*1.1);if(this._usedTime<this._updateTime)this._nowNumber=Math.floor(this._floorNumber+(this._totalNumber-this._floorNumber)*(this._usedTime/this._updateTime));else{GS.unschedule("scheduleUpdateLabel",
this);this._nowNumber=this._totalNumber}this._label=this._isUseCurrencyString?JSCodeUtility.getCurrencyString(this._nowNumber):this._nowNumber.toString();if(this._format){if(this._isUseCurrencyString){this._format=this._format.replace("%d","%s");this._format=this._format.replace("%f","%s")}this._label=JSStringUtility.format(this._format,this._label)}this._updateCallback&&this._updateCallback(this._label)},setToNumber:function(toNumber,isAnimation){toNumber=JSCodeUtility.getFloatValue(toNumber);if(isAnimation){this._totalNumber=
toNumber;this._floorNumber=this._nowNumber;this._usedTime=0;if(this._floorNumber===this._totalNumber)return;GS.unschedule("scheduleUpdateLabel",this);GS.schedule(this.scheduleUpdateLabel,this,0,0,"scheduleUpdateLabel")}else{this._totalNumber=toNumber;this._floorNumber=this._nowNumber;this.scheduleUpdateLabel(999999)}},getString:function(){return this._label},setUpdateTime:function(time){this._updateTime=time},setUseCurrencyString:function(enable){this._isUseCurrencyString=enable},setNumberUpdateCallback:function(callback){this._updateCallback=
callback},setFormat:function(format){this._format=format}});var GSTypewriterTextNode=cc.Node.extend({ctor:function(text,fontName=JSFontBoldName,fontSize=12){this._super();this.setCascadeColorEnabled(true);this.setCascadeOpacityEnabled(true);this._mainText=text;this._isFixedStringPos=false;this._typingText="";var label=this._mainLabel=new cc.LabelTTF(text,fontName,fontSize);var labelSize=label.getContentSize();label.setPosition(labelSize.width/2,labelSize.height/2);this.addChild(label);this.setContentSize(labelSize);this.setAnchorPoint(.5,.5)},setString:function(text){this._mainText=
text;this._mainLabel.setString(text+this._typingText);this._updateLabelPos()},setTypingString:function(typingText){this._typingText=typingText;this._mainLabel.setString(this._mainText+typingText);this._updateLabelPos()},setIsFixedStringPos:function(isFixedStringPos=false){if(this._isFixedStringPos===isFixedStringPos)return;this._isFixedStringPos=isFixedStringPos;this._updateLabelPos()},setFontFillColor:function(fillColor){this._mainLabel.setFontFillColor(fillColor)},enableOutline:function(color,size){this._mainLabel.enableStroke(color,
size)},setHorizontalAlignment:function(alignment){this._mainLabel.setHorizontalAlignment(alignment)},_updateLabelPos:function(){var label=this._mainLabel;var labelSize=label.getContentSize();label.setAnchorPoint(this._isFixedStringPos?0:.5,.5);label.setPosition(this._isFixedStringPos?0:labelSize.width/2,labelSize.height/2);this.setContentSize(labelSize)},startTyping:function(interval=.8,loop=true){if(!this._typingText)return;var typingTextLen=this._typingText.length;var nowLen=0;var updateFunc=()=>
{this._mainLabel.setString(this._mainText+this._typingText.substr(0,nowLen))};updateFunc();var tag=429431;this.stopActionByTag(tag);var action=cc.sequence(cc.callFunc(function(){nowLen=(nowLen+1)%(typingTextLen+1);updateFunc()},this),cc.delayTime(interval)).repeat(typingTextLen);if(loop)action=cc.repeatForever(action);action.setTag(tag);this.runAction(action)},stopTyping:function(showFullString){this.stopActionByTag(429431);this._mainLabel.setString(this._mainText+(showFullString?this._typingText:
""))}});var GSVoiceChatWrapper={};var GSVoiceChatConnectStatus={NO_PERMISSION:-1,NONE:0,CONNECTED:1,DISCONNECTED:2};var GSVoiceChatDelegate=cc.Class.extend({deviceNotSupport:function(){},onConnectStatusChanged:function(status){},onTalkStatusChanged:function(isTalking,energy,voiceID){}});
(function(){var _isConnected=false;var _isInited=false;var _muteMap={};var _selfDelegate=undefined;var _delegateArray=[];GSVoiceChatWrapper.init=function(){};GSVoiceChatWrapper.addDelegate=function(context){};GSVoiceChatWrapper.removeDelegate=function(context){};GSVoiceChatWrapper.setVivoxSetting=function(endPoint,realm){};GSVoiceChatWrapper.startVivox=function(issuer,key,voiceID,channel,callback){};GSVoiceChatWrapper.destroy=function(){};GSVoiceChatWrapper.getIsConnected=function(){return _isConnected};
GSVoiceChatWrapper.getIsMute=function(voiceID){return _muteMap[voiceID]};GSVoiceChatWrapper.getSelfIsMuteMic=function(){return _muteMap["selfMic"]};GSVoiceChatWrapper.muteClient=function(isMute,voiceID){return false};GSVoiceChatWrapper.muteSelfMic=function(isMute){};GSVoiceChatWrapper.muteSelfSpeaker=function(isMute){};GSVoiceChatWrapper.setMicVolume=function(level){};GSVoiceChatWrapper.setSpeakerVolume=function(level){};GSVoiceChatWrapper.setVadProperties=function(hangover,sensitivity,noiseFloor,
isAuto){}})();var JSCodeUtility={};JSCodeUtility.checkIsdefined=function(obj){return typeof obj!=="undefined"};JSCodeUtility.checkType=function(obj){if(obj===null)return JSTYPE.NULL;else if(Array.isArray(obj))return JSTYPE.ARRAY;else{var type=typeof obj;switch(type){case "string":return JSTYPE.STRING;case "number":return JSTYPE.NUMBER;case "boolean":return JSTYPE.BOOLEAN;case "object":return JSTYPE.OBJECT;case "undefined":return JSTYPE.UNDEFINED;case "function":return JSTYPE.FUNCTION;default:return JSTYPE.UNKNOW}}};
JSCodeUtility.isArray=function(obj){return JSCodeUtility.checkType(obj)===JSTYPE.ARRAY};JSCodeUtility.isObject=function(obj){return JSCodeUtility.checkType(obj)===JSTYPE.OBJECT};JSCodeUtility.getBooleanValue=function(obj,defaultValue=false){var objType=JSCodeUtility.checkType(obj);switch(objType){case JSTYPE.STRING:return!!parseInt(obj);case JSTYPE.NUMBER:return!!obj;case JSTYPE.BOOLEAN:return obj;default:return defaultValue}};
JSCodeUtility.getIntValue=function(obj,defaultValue=0){var objType=JSCodeUtility.checkType(obj);switch(objType){case JSTYPE.STRING:var parseResult=parseInt(obj);return Number.isInteger(parseResult)?parseResult:defaultValue;case JSTYPE.NUMBER:return Math.round(obj);default:return defaultValue}};JSCodeUtility.getStringValue=function(obj,defaultValue=""){var objType=JSCodeUtility.checkType(obj);switch(objType){case JSTYPE.STRING:return obj;case JSTYPE.NUMBER:return obj.toString();default:return defaultValue}};
JSCodeUtility.getFloatValue=function(obj,defaultValue=0){var objType=JSCodeUtility.checkType(obj);switch(objType){case JSTYPE.STRING:return parseFloat(obj);case JSTYPE.NUMBER:return obj;default:return defaultValue}};JSCodeUtility.getDecodeStringValue=function(obj,defaultValue=""){return decodeURIComponent(JSCodeUtility.getStringValue(obj,defaultValue))};JSCodeUtility.removeArrayObject=function(array,obj){for(var i=0;i<array.length;i++)if(array[i]===obj){array.splice(i,1);break}};
JSCodeUtility.reloadProjectJson=function(){var txt=jsb.fileUtils.getStringFromFile("project.json");var data=JSON.parse(txt);if(JSCodeUtility.checkIsdefined(data["jsList"])){var jsList=data["jsList"];JSCodeUtility.reloadScript(jsList)}};JSCodeUtility.reloadScript=function(scriptArray){if(!scriptArray||scriptArray.length===0)return;try{cc.sys.cleanScriptArray(scriptArray);scriptArray.forEach(cur=>require(cur))}catch(e){cc.log("JSCodeUtility.reloadScript exception = "+e.message)}};
JSCodeUtility.getRandomFloat=function(min,max){return Math.random()*(max-min)+min};JSCodeUtility.getRandomInt=function(min,max){return Math.floor(Math.random()*(max-min+1))+min};JSCodeUtility.getSeedRandomInt=function(seedrandom,min,max){return Math.floor(seedrandom()*(max-min+1))+min};
JSCodeUtility.toMMSS=function(value){var sec_num=parseInt(value,10);var hours=0;var minutes=Math.floor((sec_num-hours*3600)/60);var seconds=sec_num-hours*3600-minutes*60;if(minutes<10)minutes="0"+minutes;if(seconds<10)seconds="0"+seconds;return minutes+":"+seconds};
JSCodeUtility.toHHMMSS=function(value){var sec_num=parseInt(value,10);var hours=Math.floor(sec_num/3600);var minutes=Math.floor((sec_num-hours*3600)/60);var seconds=sec_num-hours*3600-minutes*60;if(hours<10)hours="0"+hours;if(minutes<10)minutes="0"+minutes;if(seconds<10)seconds="0"+seconds;return hours+":"+minutes+":"+seconds};JSCodeUtility.getNowTime=function(){return Math.floor((new Date).getTime()/1E3)};
JSCodeUtility.getCurrentTime=function(){var date=new Date;return date.getHours()+":"+date.getMinutes()+":"+date.getSeconds()};
JSCodeUtility.getNowDateString=function(format="%Y/%m/%d"){var date=new Date;var result="";var formatList=format.match(/(%\w)(.*)(%\w)(.*)(%\w)/);for(var i=1,len=formatList.length;i<len;i++)switch(formatList[i]){case "%Y":result+=JSStringUtility.format("%04d",date.getFullYear());break;case "%y":result+=JSStringUtility.format("%02d",date.getFullYear()%100);break;case "%m":result+=JSStringUtility.format("%02d",date.getMonth()+1);break;case "%d":result+=JSStringUtility.format("%02d",date.getDate());
break;default:result+=formatList[i]}return result};JSCodeUtility.getRemainTime=function(serverTime,socketTime){var nowTime=JSCodeUtility.getNowTime();var decreaseTime=nowTime-socketTime;return Math.max(serverTime-decreaseTime,0)};JSCodeUtility.pauseAllChild=function(node){node.getChildren().forEach(child=>{child.pause();JSCodeUtility.pauseAllChild(child)})};JSCodeUtility.resumeAllChild=function(node){node.getChildren().forEach(child=>{child.resume();JSCodeUtility.resumeAllChild(child)})};
String.prototype.replaceAt=function(index,character){return this.substr(0,index)+character+this.substr(index+character.length)};
JSCodeUtility.getSimpleNumber=function(number,decimals=0,deleteZero=true){var money_rule=[{units:1E9,simple:"B"},{units:1E6,simple:"M"},{units:1E3,simple:"K"}];var ruleSize=money_rule.length;for(var i=0;i<ruleSize;i++)if(number>=money_rule[i].units){var e_money=(number/money_rule[i].units).toString();var decimalPos=e_money.indexOf(".");if(decimalPos!==-1){if(decimals===0)var endPos=decimalPos;else var endPos=decimalPos+1+decimals>e_money.length?e_money.length:decimalPos+1+decimals;e_money=e_money.substring(0,
endPos);if(deleteZero&&decimals!=0)for(var j=0;j<decimals+1;j++){var endChar=e_money[e_money.length-1];if(endChar==="0")e_money=e_money.slice(0,-1);else if(endChar==="."){e_money=e_money.slice(0,-1);break}else break}}return e_money+money_rule[i].simple}return number};
JSCodeUtility.getCurrencyString=function(number){switch(JSCodeUtility.checkType(number)){case JSTYPE.STRING:number=parseInt(number,10);break;case JSTYPE.NUMBER:break;default:return"0"}return number.toFixed().replace(/\d(?=(?:\d{3})+$)/g,c=>c+",")};JSCodeUtility.getMoreNumberString=function(number,maxNumber=0,isCurrencyString=true){var str="";if(number>maxNumber){number=maxNumber;str="+"}var numString=isCurrencyString?JSCodeUtility.getCurrencyString(number):number.toString();return numString.concat(str)};
JSCodeUtility.filterOutDigitByString=function(str){return str.replace(/\D/g,"")};JSCodeUtility.validateEmail=function(email){var re=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(email)};
JSCodeUtility.bigNumberAdd=function(a,b){if(a[0]==="-"&&b[0]!=="-"||b[0]==="-"&&a[0]!=="-")if(a[0]==="-"){a=a.slice(1);return JSCodeUtility.bigNumberSub(b,a)}else{b=b.slice(1);return JSCodeUtility.bigNumberSub(a,b)}else{let minus=false;if(a[0]==="-"&&b[0]==="-"){minus=true;a=a.slice(1);b=b.slice(1)}let tempA=a.split(".").map(value=>value.split("").map(value=>JSCodeUtility.getIntValue(value)));let tempB=b.split(".").map(value=>value.split("").map(value=>JSCodeUtility.getIntValue(value)));let integerA=
tempA[0],decimalsA=tempA[1]||[];let integerB=tempB[0],decimalsB=tempB[1]||[];if(decimalsA.length>decimalsB.length)decimalsB=decimalsB.concat(Array.from({length:decimalsA.length-decimalsB.length},()=>0));else decimalsA=decimalsA.concat(Array.from({length:decimalsB.length-decimalsA.length},()=>0));let carry=0;let result=[];while(decimalsA.length>0||decimalsB.length>0){let digitA=decimalsA.pop()||0;let digitB=decimalsB.pop()||0;let sum=carry+digitA+digitB;let num=sum%10;if(num>0||result.length>0)result.push(num);
carry=Math.trunc(sum/10)}result.length>0&&result.push(".");while(integerA.length>0||integerB.length>0){let digitA=integerA.pop()||0;let digitB=integerB.pop()||0;let sum=carry+digitA+digitB;result.push(sum%10);carry=Math.trunc(sum/10)}if(carry>0)result.push(carry);return(minus?"-":"")+result.reverse().join("")}};
JSCodeUtility.bigNumberSub=function(a,b){let tempA=a.split(".").map(value=>value.split("").map(value=>JSCodeUtility.getIntValue(value)));let tempB=b.split(".").map(value=>value.split("").map(value=>JSCodeUtility.getIntValue(value)));let integerA=tempA[0],decimalsA=tempA[1]||[];let integerB=tempB[0],decimalsB=tempB[1]||[];if(decimalsA.length>decimalsB.length)decimalsB=decimalsB.concat(Array.from({length:decimalsA.length-decimalsB.length},()=>0));else decimalsA=decimalsA.concat(Array.from({length:decimalsB.length-
decimalsA.length},()=>0));let borrow=0;let result=[];while(decimalsA.length>0||decimalsB.length>0){let digitA=decimalsA.pop()||0;let digitB=decimalsB.pop()||0;let leave=digitA-digitB-borrow;if(leave<0){borrow=1;leave+=10}else borrow=0;if(leave>0||result.length>0)result.push(leave)}result.length>0&&result.push(".");let leaveZero=0;while(integerA.length>0||integerB.length>0){let digitA=integerA.pop()||0;let digitB=integerB.pop()||0;let leave=digitA-digitB-borrow;if(leave<0){borrow=1;leave+=10}else borrow=
0;if(leave===0)leaveZero++;else{result=result.concat(Array.from({length:leaveZero},()=>0));result.push(leave);leaveZero=0}}result[result.length-1]==="."&&result.push(0);result=result.reverse();if(borrow===1){result=Array.from({length:leaveZero},()=>0).concat(result);result="-"+JSCodeUtility.bigNumberSub("1"+result.map(value=>value==="."?".":"0").join(""),result.join(""))}else result=result.join("");return result||"0"};
JSCodeUtility.bigNumberMultiply=function(a,b){let minus=false;if(a[0]==="-"){a=a.substring(1);minus=!minus}if(b[0]==="-"){b=b.substring(1);minus=!minus}let tempA=a.split(".").map(value=>value.split("").map(value=>JSCodeUtility.getIntValue(value)));let tempB=b.split(".").map(value=>value.split("").map(value=>JSCodeUtility.getIntValue(value)));let integerA=tempA[0],decimalsA=tempA[1]||[];let integerB=tempB[0],decimalsB=tempB[1]||[];tempA=decimalsA.reverse().concat(integerA.reverse());integerB=integerB.reverse();
let mul=(a1,multiplier,power)=>{let carry=0;let result=[];a1.forEach(value=>{let product=value*multiplier+carry;let num=product%10;result.push(num);carry=Math.trunc(product/10)});if(carry>0)result.push(carry);result=result.reverse().join("");if(power<0){power=0-power;if(result.length>power){let decimalPlaces=result.length-power;result=result.slice(0,decimalPlaces)+"."+result.slice(decimalPlaces)}else result="0."+Array.from({length:power-result.length},()=>"0").join("")+result}else result=result+Array.from({length:power},
()=>"0").join("");return result};let multiplyResult="0";decimalsB.forEach((digit,index)=>{if(digit>0)multiplyResult=JSCodeUtility.bigNumberAdd(multiplyResult,mul(tempA,digit,-1-index-decimalsA.length))});integerB.forEach((digit,index)=>{if(digit>0)multiplyResult=JSCodeUtility.bigNumberAdd(multiplyResult,mul(tempA,digit,index-decimalsA.length))});return(minus?"-":"")+multiplyResult};
JSCodeUtility.bigNumberIntDiv=function(a,b,dotLength=1){var dotMul=Math.pow(10,dotLength);a=JSCodeUtility.bigNumberMultiply(a,dotMul.toString());var aLen=a.length;var result=[];var temp=0;var remainder=0;var quotient=0;for(var i=0;i<aLen;i++){temp=remainder*10+parseInt(a[i]);if(temp<b){remainder=temp;result.push(0)}else{quotient=parseInt(temp/b);remainder=temp%b;result.push(quotient)}}var result=[result.join("").replace(/\b(0+)/gi,""),remainder][0]/dotMul;return result};
JSCodeUtility.screenCapture=function(node,size,isScene,fileName,imageFormat,saveCallback){size=size||JSVisibleSize;imageFormat=imageFormat||cc.IMAGE_FORMAT_JPEG;var depthStencilFormat=GS.engineVersion>=4?cc.IS_AX_LIB?30:24:35056;var renderTexture=new cc.RenderTexture(size.width,size.height,cc.Texture2D.PIXEL_FORMAT_RGBA8888,depthStencilFormat);renderTexture.begin();var savedPos=node.getPosition();var contentSize=node.getContentSize();var anchor=cc.p(0,0);if(!node.isIgnoreAnchorPointForPosition())anchor=
node.getAnchorPoint();var newPos=cc.p(contentSize.width*anchor.x,contentSize.height*anchor.y);isScene&&(newPos=cc.pSub(newPos,JSOriginPoint));node.setPosition(newPos);node.visit();node.setPosition(savedPos);renderTexture.end();cc.director.getRenderer().render();if(fileName&&cc.sys.isNative){var writePath=JSWriteablePath+fileName;var targetArr=writePath.split("/");targetArr.pop();var directoryPath=targetArr.join("/");if(!jsb.fileUtils.isDirectoryExist(directoryPath))jsb.fileUtils.createDirectory(directoryPath);
renderTexture.saveToFile(fileName,imageFormat,imageFormat===cc.IMAGE_FORMAT_PNG,saveCallback);cc.log("\u5b58\u5716\u7247\u5b58\u5728:%s",writePath)}var texture2d=renderTexture.getSprite().getTexture();texture2d.setAntiAliasTexParameters();return texture2d};
JSCodeUtility.parseLog=function(logString){var retArray;var nowTextArray=logString.split("\n");var regex;if(logString.indexOf("GSSocket.js")>-1)regex=/\d\d:\d\d:\d\d.\d\d\d GSSocket.js:[0-9]* Socket \u6536\u5230:/g;else if(logString.indexOf("DataProcess \u6536\u5230")>-1)regex=/\d\d:\d\d:\d\d.\d\d\d DataProcess \u6536\u5230 /g;else if(logString.indexOf("Server->Proxy")>-1)regex=/\d\d:\d\d:\d\d.\d\d\d Server->Proxy /g;else if(logString.indexOf("D/cocos2d-x\u00a0debug\u00a0info")>-1)regex=/D\/cocos2d-x\u00a0debug\u00a0info: Socket \u9001\u51fa:/g;
else if(logString.indexOf("[cocos2d] \u8655\u7406")>-1)regex=/\d\d\d\d-\d\d-\d\d \d\d:\d\d:\d\d.\d\d\d \[cocos2d\] \u8655\u7406 /g;else if(logString.indexOf(" CW ")>-1)regex=/\d{10}\.\d{3} CW /g;if(regex)retArray=nowTextArray.reduce((array,cur)=>{var text=cur.split(regex)[1];if(text&&text.indexOf("_")!==0&&text.indexOf("!")!==0)array.push(text);return array},[]);return retArray};
JSCodeUtility.generateCombination=function(dataArr,chooseNum){if(chooseNum>dataArr.length){cc.log("logic error: chooseNum should always be no larger than totalNum in combination calculation");return[]}var idxArr=dataArr.map((data,i)=>i).reverse();var output=[];var stack=[];idxArr.forEach((ele,i)=>{if(i>=chooseNum-1)stack.push([ele])});while(stack.length!==0){let curr=stack.pop();let length=curr.length;if(length===chooseNum){let data=curr.map(ele=>{return dataArr[ele]});output.push(data)}else{let idxOfLastElement=
idxArr.indexOf(curr[length-1]);for(let i=0;i<idxOfLastElement;i++)if(i>=chooseNum-1-length){let possible=curr.concat(idxArr[i]);stack.push(possible)}}}return output};
JSCodeUtility.playFullScreenVideo=function(filename,videoSize,callback){var contentSize;if(videoSize)if(videoSize.width>videoSize.height){var ratio=videoSize.width/JSVisibleSize.width;contentSize=cc.size(JSVisibleSize.width,videoSize.height/ratio)}else{var ratio=videoSize.height/JSVisibleSize.height;contentSize=cc.size(videoSize.width/ratio,JSVisibleSize.height)}var video=new ccui.VideoPlayer(filename);video.setPosition(cc.pAdd(JSOriginPoint,JSScreenMidPos));video.setContentSize(contentSize||JSVisibleSize);
video.setKeepAspectRatioEnabled(true);video.setEventListener(ccui.VideoPlayer.EventType.COMPLETED,()=>{callback&&callback();video.setVisible(false);video.runAction(cc.removeSelf())});video.play();cc.director.getRunningScene().addChild(video)};var localizedTableMap={};
var JSLocalizedStringFromTable=function(key,table,comment){if(JSCodeUtility.checkType(key)!=JSTYPE.STRING)key="";if(JSCodeUtility.checkType(table)!=JSTYPE.STRING)table="Localized_String";var resultStr="";var localizedMap=localizedTableMap[table];if(JSCodeUtility.checkType(localizedMap)==JSTYPE.OBJECT){resultStr=localizedMap[key];if(JSCodeUtility.checkType(resultStr)!=JSTYPE.STRING)resultStr=key}else{localizedMap={};localizedTableMap[table]=localizedMap;var fullPath="LocalizedString/"+table;var fileString=
jsb.fileUtils.getStringFromFile(fullPath);if(JSCodeUtility.checkType(fileString)!=JSTYPE.STRING||fileString.length==0)return key;var lines=fileString.split("\n");for(var i=0;i<lines.length;i++){var lineString=lines[i];var findUnused=lineString.indexOf("/*")>=0||lineString.indexOf("//")>=0||lineString.indexOf("*/")>=0||lineString.length==0;if(!findUnused){cc.log("i=%d String=%s",i,lines[i]);var validPos=lineString.search("=");if(validPos>0){var lineLength=lineString.length;var keyStr=lineString.slice(0,
validPos).trim();var valueStr=lineString.slice(validPos+1).trim();keyStr=JSStringUtility.getStringFromFindString(keyStr,'"',false);keyStr=JSStringUtility.getStringFromFindString(keyStr,'"',true);valueStr=JSStringUtility.getStringFromFindString(valueStr,'"',false);valueStr=JSStringUtility.getStringFromFindString(valueStr,'"',true);keyStr=keyStr.replace(/\n/g,"\n");valueStr=valueStr.replace(/\n/g,"\n");localizedMap[keyStr]=valueStr}}}resultStr=localizedMap[key]}if(resultStr.length>0)return resultStr;
else return key};var JSNotify={};JSNotify.DEFAULT_EFFECT_NAME="";
JSNotify.scheduleNotify=function(info){if(!cc.sys.isNative)return;if(info.stopTime!==undefined&&info.startTime!==undefined){var stopTime=parseInt(info.stopTime);var startTime=parseInt(info.startTime);var hr=(new Date).getHours();var min=(new Date).getMinutes();var sec=(new Date).getSeconds();var totalSec=hr*3600+min*60+sec;var timeLeft=info.trigger;info.trigger=String(timeLeft);var notifyTime=totalSec+timeLeft;if(notifyTime>86400)notifyTime-=86400;if(startTime<stopTime){if(stopTime<notifyTime&&notifyTime<
86400||0<notifyTime&&notifyTime<startTime)info.trigger=String(startTime+86400-totalSec)}else if(stopTime<notifyTime&&notifyTime<startTime)info.trigger=String(startTime-totalSec)}info.bg=info.bg||"";info.big=info.big||"";info.sound=info.sound||JSNotify.DEFAULT_EFFECT_NAME;info.icon=info.icon||"";info.interval=info.interval||0;info.title=info.title||"";info.subTitle=info.subTitle||"";info.title=info.title||"";info.id=info.id+"";if(cc.sys.os===cc.sys.OS_ANDROID)jsb.reflection.callStaticMethod("com/gamesofa/activity/GSNotify",
"scheduleNotify","(Ljava/lang/String;)V",JSON.stringify(info));else if(cc.sys.os===cc.sys.OS_IOS){info.bg="";jsb.reflection.callStaticMethod("GSNotify","scheduleNotify:",JSON.stringify(info))}};
JSNotify.scheduleFixNotify=function(info){if(!cc.sys.isNative)return;info.date=info.date||"0";info.bg=info.bg||"";info.big=info.big||"";info.sound=info.sound||JSNotify.DEFAULT_EFFECT_NAME;info.icon=info.icon||"";info.interval=info.interval||0;info.title=info.title||"";if(cc.sys.os===cc.sys.OS_ANDROID)jsb.reflection.callStaticMethod("com/gamesofa/activity/GSNotify","scheduleFixNotify","(Ljava/lang/String;)V",JSON.stringify(info));else if(cc.sys.os===cc.sys.OS_IOS){info.bg="";jsb.reflection.callStaticMethod("GSNotify",
"scheduleFixNotify:",JSON.stringify(info))}};JSNotify.removeNotify=function(key){if(!cc.sys.isNative)return;if(cc.sys.os===cc.sys.OS_ANDROID)jsb.reflection.callStaticMethod("com/gamesofa/activity/GSNotify","cancelNotify","(Ljava/lang/String;)V",key);else if(cc.sys.os===cc.sys.OS_IOS)jsb.reflection.callStaticMethod("GSNotify","cancelNotify:",key)};
JSNotify.key={DailyMission:"9100",DailyLogin:"9101",DailyLoginReward:"9102",ContinueSignInReward:"13530516603044",DAILY_SLOT:"888667",LOGIN:"180124",TEST_MAIN:"878701",DAILY_SIGN:"40666888",GAME_TURN_SELF:"30019",LOBBY_D1:"112233",CASH_COW:"40001",KO_GET_NOTIFICATION:"50000",BIG_LOTTERY_NOTIFICATION:"50001",WELCOME_BACK_NOTIFICATION:"50003",MBJ_SURVIVAL_NOTIFICATION:"50009",HONOR_MEDAL_NOTIFICATION:"50010",VEGAS_NEWBIE_MISSION_NOTIFICATION:"50011",VEGAS_COMPETE_NOTIFICATION:"50012",FIERCE_BATTLE_NOTIFICATION:"50013",
LOGIN_REWARD_NOTIFICATION:"50014",GAPLE_JP_BATTLE_NOTIFICATION:"50028",WINWIN_LOTTERY_NOTIFICATION:"50029",POKER_HAND_NOTIFICATION:"50030",ROUND_CONTINUE_SIGNIN_NOTIFICATION:"50031",RETURN_WELFARE_NOTIFICATION:"50039",NOVICE:"180719"};
JSNotify.getLastlyRemoteNotifyData=function(){if(cc.sys.isNative)if(cc.sys.os===cc.sys.OS_ANDROID)return jsb.reflection.callStaticMethod("com/gamesofa/activity/GSNotify","getLastlyRemoteNotifyData","()Ljava/lang/String;");else if(cc.sys.os===cc.sys.OS_IOS)return jsb.reflection.callStaticMethod("GSNotify","getLastlyRemoteNotifyData");return""};var JSStringUtility={};JSStringUtility.getLengthInUtf8Bytes=function(str){var m=encodeURIComponent(str).match(/%[89ABab]/g);return str.length+(m?m.length:0)};
JSStringUtility.getStringFromFindString=function(str,findStr,fromEnd=false){if(JSCodeUtility.checkType(findStr)!==JSTYPE.STRING||findStr.length===0)return str;var resultStr=str;var findPos=0;if(fromEnd)findPos=str.lastIndexOf(findStr);else findPos=str.indexOf(findStr);if(findPos>=0)if(fromEnd)resultStr=str.slice(0,findPos);else resultStr=str.slice(findPos+1);return resultStr};JSStringUtility.containString=function(str,findStr){return str.indexOf(findStr)>=0};JSStringUtility.format=function(){return sprintf(arguments)};
JSStringUtility.replaceString=function(str,replaceStr,toStr){return str.replace(new RegExp(replaceStr,"g"),toStr)};JSStringUtility.getSubStringWithEmoji=function(str,size){return Array.from(str).slice(0,size).join("")};
JSStringUtility.cutStringReplaceByEllipsis=(theStr,fontSize,maxWidth,otherEndString="")=>{var tempStr=theStr;var nameLabel=new cc.LabelTTF(theStr.concat(otherEndString),JSFontBoldName,fontSize);if(nameLabel.getContentSize().width>maxWidth){var eachWordLengthList=Array.from(theStr).map(c=>c.length);var ellipsis="...";var stringLength=theStr.length;for(var wordCount=eachWordLengthList.length-1;nameLabel.getContentSize().width>maxWidth&&wordCount>0;wordCount--){stringLength-=eachWordLengthList[wordCount];
tempStr=theStr.slice(0,stringLength);nameLabel.setString(tempStr.concat(ellipsis).concat(otherEndString))}tempStr=tempStr.concat(ellipsis)}return tempStr};
!function(){window.decodeURIComponent=function(r){if(!r)return"";r=r.toString();var i=r.indexOf("%");if(-1===i)return r;var o=r.length,c="",u=0,d=0,s=i;for(a=e;i>-1&&i<o-2;)switch(d=f(d,n(r[i+1],4)|n(r[i+2],0)),a){case e:c+=r.substring(u,s),c+=d<=65535?String.fromCharCode(d):String.fromCharCode(55232+(d>>10),56320+(1023&d)),d=0,u=i+3,i=s=r.indexOf("%",u);break;default:if((i+=3)<o&&"%"===r[i])break;case t:a=e,d=0,i=s=r.indexOf("%",s+1)}return c+r.substring(u)};var r=Object.assign(Object.create(null),
{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15});function n(n,e){var t=r[n];return void 0===t?255:t<<e}var e=12,t=0,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,7,7,7,7,7,7,7,7,7,7,7,7,8,7,7,10,9,9,9,11,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,24,36,48,60,72,84,96,0,12,12,12,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,24,24,24,0,0,0,0,0,0,0,0,0,24,24,0,0,0,0,0,0,0,0,0,0,48,48,48,0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,0,0,0,127,63,63,63,0,31,15,15,15,7,7,7],a=e;function f(r,n){var e=i[n];return a=i[256+
a+e],r<<6|n&i[364+e]}}();var LobbyBannerMode={None:0,Purchase:1,Event:2,Play:3,Shop:4,Setting:5,Rules:6,Link:7,Compete:8,Slot:9,Blackjack:10,GameListType0:11,GameListType1:12,InsideLink:13,BonusStore:14,Alias:15,WinAnim:16,WebUrl:17,Chicken:18,OutAd:19,Guild:20,Unlimit:21,GuildCompete:22,FortuneCat:23,Private:24,DailySignIn:25,ScratchCard:26,UnlimitRace:27,Joker:28,SitNGo:29,GameListAllin:30,Bonus:31,Achieve:32,LobbyInvite:33,InviteCode:34,PlayOmaha:35,PlayRoyal:36,FriendsArea:37,Blind:38,Director:39,JokerUnlimit:40,Award:41,
ShopDice:42,SettingHelpReport:43,FacebookLike:44,DiceBo:45,DailyMission:46,VipMonth:47,VipUpgrade:48,ScratchShop:49,BlackJack888:50,BonusStoreOther:51,BonusStoreAcces:52,BonusStorePhoto:53,ShopAcces:54,ShopPhoto:55,ShopItem:56,FriendGameLobby:57,FriendGameCreate:58,GoConvert:60,AvatarFittingRoom:61,SettingProfile:62,SettingGame:63,AvatarShopMoney:64,AvatarShopBonus:65,SlotB:66,InAppPurchase:67,Spinrace:68,HooHeyHow:69,TreasureBowl:70,Luckypool:71,RPG:72,Treasury:73,VNPayTeach:74,SlotFruit:75,GoldSlot:76,
GameListBeauty:77,AvatarGachapon:78,GameListType2:79,GameListType3:80,GameListShowhand:81,Ladder:82,T9DailySignIn:83,VipArea:84,PK5:85,GoogleAD:86,HonorRoll:87,VegasLobby:88,ShowDealerInstance:89,ProAnalysis:90,TournamentRoom:91,VipCenter:92,CombatLevelExplain:93,PlayModeLayer:94,VipTask:95,ContinueSignIn:96,GameListLayer:97,ChangeGame:98,GroupMissionLayer:99,Verify:100,Eliminate:101,Mary:102,Bakarat:103,Football:104,FriendTableJoin:105,VipDailyRewardLayer:106,GameRankLobbyLayer:107,PopToLobby:113,
TexasOpenBag:114,KoinLuxyLayer:115,TreasuryDialog:116,CompeteLobby:117,PandaSlot:118,MallTycoon:119,RedDog:120,RegionCompete:121,WeeklyTask:122,Bingo:124,GapleKO:126,PurchaseBonusPage:128,TebakQQ:129,VipBattlePass:130,PhoneNumberVerify:131,Fission:132,BonusStoreGachapon:133,BonusStoreItem:134,MedalStoreOther:135,MedalStoreAcces:136,MedalStorePhoto:137,MedalStoreGachapon:138,MedalStoreItem:139,MultiBlackjack:140,BigLotteryMainLayer:141,BigLotteryBuyLayer:142,GameListOmaha:143,GameListRoyal:144,Line25:145,
VegasVipLayer:146,CasinoSlot:147,GameListPirateTexas:148,GameRank:149,VipLuckyBagLayer:150,VegasPiggyBank:151,CardKing:153,CashCow:154,IDPurchaseEvent:155,GuildGameRecord:156,VIP_BLACKJACK:157,VegasTreasureIsland:158,SlotRich:159,AreaCompete:160,GemStore:161,StarShine:162,FriendVideoLobby:163,FriendVideoCreate:164,FriendVideoJoin:165,LuckyBox:166,MegaWheelRecharge:167,PurchaseRewardCard:168,MonthChallengeLobby:169,MonthChallengeRank:170,MonthChallengeRules:171,FishHunterLobby:172,GemWheel:173,PlayGameWithParam:174,
MasterPoker:175,TurnTable:176,MultiBJWithParam:177,PurchaseDiscount:178,VegasStarWander:179,MBJ_SURVIVAL:180,GreatDeal:181,CardKingMap:182,StarShineReward:183,VegasMission:184,PlayGameWithParamObj:185,VegasCompete:186,Equip:187,GodOfWealth:188,LotteryRedEnvelope:189,MoneyRecord:190,VegasRacing:191,MultiDiceBo:192,CouponBackpack:193,StarCardBook:194,GoldRush:195,VegasHonorMedal:196,StarCardBookBuy:197,CardsCollection:198,PuzzleLottery:199,AvatarDecompose:200,CrystalStore:201,CardSkin:202,CrystalRecord:203,
MultiShootGate:204,BigGashapon:205,FierceBattle:206,CarnivalWheel:207,RebateWallet:208,BingoHomeRun:209,MBJClub:210,VipTransformItem:211,MultiHooHeyHow:212,GardenMission:213,DragonVsLeopard:214,VipRewardLayer:215,LoginReward:216,MultiNiuNiu:217,ClawMachine:218,BlastPinball:219,FreeChip:220,KingdomWar:222,TreasureMission:223,GapleJPBattle:224,WinWinLottery:226,OrangeCollection:227,GroupBuy:228,VegasCasinoVault:229,CrazyBall:230,Mail:231,ShopFrame:232,BonusStoreFrame:233,MedalStoreFrame:234,EquipFrame:235,
MultiBaccarat:236};var PUSH_ANIM_MOVE_TIME=.2;
var PushScene=cc.Scene.extend({_isAlive:true,_canUseAndroidBackKey:true,_backKeyLayerArray:null,_pushLayerArray:null,_canPushLayer:true,_popLayerCount:0,_lastPopClipNode:null,_dummyTouchLayer:null,ctor:function(){this._super();PushScene.isSingletonGame=false;this._backKeyNumber=cc.sys.isNative?cc.KEY.back:cc.KEY.backspace;this._pushLayerArray=[];var dummyTouch=this._dummyTouchLayer=new DummyTouchLayer(JSVisibleSize);dummyTouch.setPosition(cc.director.getVisibleOrigin());dummyTouch.setVisible(false);
this.addChild(dummyTouch,1E5);if(cc.sys.platform===cc.sys.ANDROID){this._backKeyLayerArray=[];cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:this.onKeyReleased.bind(this)},this)}else if(!cc.sys.isNative&&JSDebugMode){this._backKeyLayerArray=[];cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:this.onKeyReleased.bind(this)},this)}},onEnter:function(){this._super();if(cc.sys.isNative){cc.sys.garbageCollect();cc.textureCache.removeUnusedTextures()}var sceneTag=
cc.director.getRunningScene().getTag();PushScene.isLogin=sceneTag===GSEnum.Scene.Login;PushScene.isLobby=sceneTag===GSEnum.Scene.Lobby;PushScene.isGame=sceneTag===GSEnum.Scene.Game;PushScene.isSlot=sceneTag===GSEnum.Scene.Slot},onExit:function(){DialogManager.cleanAllDialog(true);this._super();cc.sys.garbageCollect()},createClipNode:function(){var stencil=new cc.LayerColor(cc.color(255,255,255,255),JSVisibleSize.width,JSVisibleSize.height);var clipNode=new cc.ClippingNode(stencil);clipNode.setContentSize(JSVisibleSize);
clipNode.setAnchorPoint(cc.p(0,0));return clipNode},checkPreviousLayer:function(constructor){if(this._pushLayerArray.length>1){var clipNode=this._pushLayerArray[this._pushLayerArray.length-2];var mainLayer=clipNode.mainLayer||clipNode.getChildren()[0];return mainLayer&&mainLayer instanceof constructor}return false},checkLastPopLayer:function(constructor){if(this._lastPopClipNode){var clipNode=this._lastPopClipNode;var mainLayer=clipNode.mainLayer||clipNode.getChildren()[0];return mainLayer&&mainLayer instanceof
constructor}return false},checkNowLayer:function(constructor){if(this._pushLayerArray.length>0){var clipNode=this._pushLayerArray[this._pushLayerArray.length-1];var mainLayer=clipNode.mainLayer||clipNode.getChildren()[0];return mainLayer&&mainLayer instanceof constructor}return false},getNowLayer:function(){if(this._pushLayerArray.length>0){var clipNode=this._pushLayerArray[this._pushLayerArray.length-1];var mainLayer=clipNode.mainLayer||clipNode.getChildren()[0];return mainLayer}return undefined},
getLayerArrayLength:function(){return this._pushLayerArray?this._pushLayerArray.length:0},getCanPushLayer:function(){return this._canPushLayer},_checkShowLobbyDialog:function(){DialogManager.updateLobbyDialogVisible()},_getNodeIsVisible:function(node){return node&&node.isVisibleRecursive()},onKeyReleased:function(key,event){if(key===this._backKeyNumber){if(!this._canPushLayer)return;var backKeyLayer;if(this._backKeyLayerArray.length>0){var lastLen=this._backKeyLayerArray.length-1;while(lastLen>=0){backKeyLayer=
this._backKeyLayerArray[lastLen];if(backKeyLayer.isRunning()&&this._getNodeIsVisible(backKeyLayer))break;else{backKeyLayer=null;lastLen--}}}if(backKeyLayer)if(backKeyLayer.keyBackPressed)backKeyLayer.keyBackPressed();else cc.log("\u6b64Layer\u6c92\u6709\u5be6\u4f5ckeyBackPressed");else if(this._pushLayerArray.length>1)this.popLayer();else if(this.keyBackPressed)this.keyBackPressed();else cc.log("\u6c92\u6709Layer\u53ef\u4ee5Back\u4e86")}},addBackKeyEnableLayer:function(keyLayer){if(this._backKeyLayerArray)if(this._backKeyLayerArray.indexOf(keyLayer)===
-1)this._backKeyLayerArray.push(keyLayer)},removeBackKeyEnableLayer:function(keyLayer){this._backKeyLayerArray&&JSCodeUtility.removeArrayObject(this._backKeyLayerArray,keyLayer)},pushLayer:function(nextLayer,forcePush,animation=true){if(!JSCodeUtility.checkIsdefined(nextLayer)||nextLayer==null)return;if(!forcePush&&!this._canPushLayer)return;this._canPushLayer=false;var leftNode=this._pushLayerArray[this._pushLayerArray.length-1];var rightNode=this.createClipNode();rightNode.mainLayer=nextLayer;rightNode.setPosition(JSOriginPoint.x+
JSVisibleSize.width,JSOriginPoint.y);rightNode.addChild(nextLayer);this._pushLayerArray.push(rightNode);animation&&this.addChild(rightNode);var leftChild=leftNode.mainLayer||leftNode.getChildren()[0];if(leftChild&&leftChild.viewWillDisappear)leftChild.viewWillDisappear();var rightChild=rightNode.mainLayer;if(rightChild&&rightChild.viewWillAppear)rightChild.viewWillAppear();leftNode.stopAllActions();rightNode.stopAllActions();if(animation){var action1=cc.moveTo(PUSH_ANIM_MOVE_TIME,cc.p(JSOriginPoint.x-
JSVisibleSize.width,JSOriginPoint.y)).easing(cc.easeInOut(2));var action2=cc.callFunc(()=>{var leftChild=leftNode.mainLayer||leftNode.getChildren()[0];if(leftChild&&leftChild.viewDidDisappear)leftChild.viewDidDisappear();leftNode.setVisible(false)});leftNode.runAction(cc.sequence(action1,action2));var action1=cc.moveTo(PUSH_ANIM_MOVE_TIME,cc.p(JSOriginPoint.x,JSOriginPoint.y)).easing(cc.easeInOut(2));var action2=cc.callFunc(()=>{this._canPushLayer=true;var rightChild=rightNode.mainLayer;if(rightChild&&
rightChild.viewDidAppear)rightChild.viewDidAppear();this._dummyTouchLayer.setVisible(false)});rightNode.runAction(cc.sequence(action1,action2));this._dummyTouchLayer.setVisible(true)}else{leftNode.x=JSOriginPoint.x-JSVisibleSize.width;if(leftChild&&leftChild.viewDidDisappear)leftChild.viewDidDisappear();leftNode.setVisible(false);this._canPushLayer=true;rightNode.x=JSOriginPoint.x;if(rightChild&&rightChild.viewDidAppear)rightChild.viewDidAppear();this._dummyTouchLayer.setVisible(false);this.addChild(rightNode)}this._checkShowLobbyDialog()},
popLayer:function(popCount,animation){if(!JSCodeUtility.checkIsdefined(popCount))popCount=1;if(!JSCodeUtility.checkIsdefined(animation))animation=true;this._popLayerCount=popCount;var pushLayerCount=this._pushLayerArray.length;if(pushLayerCount===1)return;if(popCount===-1)this._popLayerCount=pushLayerCount-1;if(this._popLayerCount>=pushLayerCount)return;this._canPushLayer=false;var leftNode=this._pushLayerArray[pushLayerCount-1-this._popLayerCount];var rightNode=this._lastPopClipNode=this._pushLayerArray[pushLayerCount-
1];var rightChild=rightNode.mainLayer;if(rightChild&&rightChild.viewWillDisappear)rightChild.viewWillDisappear();var leftChild=leftNode.mainLayer||leftNode.getChildren()[0];if(leftChild&&leftChild.viewWillAppear)leftChild.viewWillAppear();leftNode.setVisible(true);leftNode.stopAllActions();rightNode.stopAllActions();if(animation){var action1=cc.moveTo(PUSH_ANIM_MOVE_TIME,cc.p(JSOriginPoint.x+JSVisibleSize.width,JSOriginPoint.y)).easing(cc.easeInOut(2));var action2=cc.callFunc(()=>{var rightChild=
rightNode.mainLayer;if(rightChild&&rightChild.viewDidDisappear)rightChild.viewDidDisappear();for(var i=0;i<this._popLayerCount;i++){var lastNode=this._pushLayerArray.pop();lastNode.removeFromParent(true)}});rightNode.runAction(cc.sequence(action1,action2));var action1=cc.moveTo(PUSH_ANIM_MOVE_TIME,cc.p(JSOriginPoint.x,JSOriginPoint.y)).easing(cc.easeInOut(2));var action2=cc.callFunc(()=>{this._canPushLayer=true;var leftChild=leftNode.mainLayer||leftNode.getChildren()[0];if(leftChild&&leftChild.viewDidAppear)leftChild.viewDidAppear();
this._dummyTouchLayer.setVisible(false);this._checkShowLobbyDialog()});leftNode.runAction(cc.sequence(action1,action2));this._dummyTouchLayer.setVisible(true)}else{if(rightChild&&rightChild.viewDidDisappear)rightChild.viewDidDisappear();for(var i=0;i<this._popLayerCount;i++){var lastNode=this._pushLayerArray.pop();lastNode.removeFromParent(true)}this._canPushLayer=true;leftNode.x=JSOriginPoint.x;if(leftChild&&leftChild.viewDidAppear)leftChild.viewDidAppear();this._dummyTouchLayer.setVisible(false);
this._checkShowLobbyDialog()}},replaceLayer:function(replaceLayer,forceReplace,animation=true){if(!JSCodeUtility.checkIsdefined(replaceLayer)||replaceLayer==null)return;if(!forceReplace&&!this._canPushLayer)return;var pushLayerCount=this._pushLayerArray.length;if(pushLayerCount===1)return;this._canPushLayer=false;var leftNode=this._pushLayerArray[this._pushLayerArray.length-1];var rightNode=this.createClipNode();rightNode.mainLayer=replaceLayer;rightNode.setPosition(JSOriginPoint.x+JSVisibleSize.width,
JSOriginPoint.y);rightNode.addChild(replaceLayer);this._pushLayerArray[this._pushLayerArray.length-1]=rightNode;animation&&this.addChild(rightNode);var leftChild=leftNode.mainLayer||leftNode.getChildren()[0];if(leftChild&&leftChild.viewWillDisappear)leftChild.viewWillDisappear();var rightChild=rightNode.mainLayer;if(rightChild&&rightChild.viewWillAppear)rightChild.viewWillAppear();leftNode.stopAllActions();rightNode.stopAllActions();if(animation){var action1=cc.delayTime(PUSH_ANIM_MOVE_TIME);var action2=
cc.callFunc(()=>{var leftChild=leftNode.mainLayer||leftNode.getChildren()[0];if(leftChild&&leftChild.viewDidDisappear)leftChild.viewDidDisappear();leftNode.removeFromParent(true)});leftNode.runAction(cc.sequence(action1,action2));var action1=cc.moveTo(PUSH_ANIM_MOVE_TIME,cc.p(JSOriginPoint.x,JSOriginPoint.y)).easing(cc.easeInOut(2));var action2=cc.callFunc(()=>{this._canPushLayer=true;var rightChild=rightNode.mainLayer;if(rightChild&&rightChild.viewDidAppear)rightChild.viewDidAppear();this._dummyTouchLayer.setVisible(false)});
rightNode.runAction(cc.sequence(action1,action2));this._dummyTouchLayer.setVisible(true)}else{leftNode.x=JSOriginPoint.x-JSVisibleSize.width;if(leftChild&&leftChild.viewDidDisappear)leftChild.viewDidDisappear();leftNode.removeFromParent(true);this._canPushLayer=true;rightNode.x=JSOriginPoint.x;if(rightChild&&rightChild.viewDidAppear)rightChild.viewDidAppear();this._dummyTouchLayer.setVisible(false);this.addChild(rightNode)}this._checkShowLobbyDialog()}});
PushScene.pushLayer=function(nextLayer,forcePush,animation){var runningScene=cc.director.getRunningScene();if(runningScene.pushLayer)runningScene.pushLayer(nextLayer,forcePush,animation)};PushScene.popLayer=function(popCount,animation){var runningScene=cc.director.getRunningScene();if(runningScene.popLayer)runningScene.popLayer(popCount,animation)};
PushScene.replaceLayer=function(replaceLayer,forceReplace,animation){var runningScene=cc.director.getRunningScene();if(runningScene.replaceLayer)runningScene.replaceLayer(replaceLayer,forceReplace,animation)};PushScene.addBackKeyEnableLayer=function(keyLayer){var runningScene=cc.director.getRunningScene();if(runningScene&&runningScene.addBackKeyEnableLayer)runningScene.addBackKeyEnableLayer(keyLayer)};
PushScene.removeBackKeyEnableLayer=function(keyLayer){var runningScene=cc.director.getRunningScene();if(runningScene&&runningScene.removeBackKeyEnableLayer)runningScene.removeBackKeyEnableLayer(keyLayer)};PushScene.checkPreviousLayer=function(constructor){var runningScene=cc.director.getRunningScene();return runningScene.checkPreviousLayer&&runningScene.checkPreviousLayer(constructor)};
PushScene.checkLastPopLayer=function(constructor){var runningScene=cc.director.getRunningScene();return runningScene.checkLastPopLayer&&runningScene.checkLastPopLayer(constructor)};PushScene.checkNowLayer=function(constructor){var runningScene=cc.director.getRunningScene();return runningScene.checkNowLayer&&runningScene.checkNowLayer(constructor)};PushScene.getNowLayer=function(){var runningScene=cc.director.getRunningScene();return runningScene.getNowLayer&&runningScene.getNowLayer()};
PushScene.getLayerArrayLength=function(){var runningScene=cc.director.getRunningScene();return runningScene.getLayerArrayLength&&runningScene.getLayerArrayLength()};PushScene.getCanPushLayer=function(){var runninScene=cc.director.getRunningScene();return runninScene.getCanPushLayer&&runninScene.getCanPushLayer()};(function(window){var re={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/bcdiefguxX/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function sprintf(){var arg=arguments;if(typeof arguments[0]==="object")arg=arguments[0];var key=
arg[0],cache=sprintf.cache;if(!(cache[key]&&cache.hasOwnProperty(key)))cache[key]=sprintf.parse(key);return sprintf.format.call(null,cache[key],arg)}sprintf.format=function(parse_tree,argv){var cursor=1,tree_length=parse_tree.length,node_type="",arg,output=[],i,k,match,pad,pad_character,pad_length,is_positive=true,sign="";for(i=0;i<tree_length;i++){node_type=get_type(parse_tree[i]);if(node_type==="string")output[output.length]=parse_tree[i];else if(node_type==="array"){match=parse_tree[i];if(match[2]){arg=
argv[cursor];for(k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k]))throw new Error(sprintf('[sprintf] property "%s" does not exist',match[2][k]));arg=arg[match[2][k]]}}else if(match[1])arg=argv[match[1]];else arg=argv[cursor++];if(re.not_type.test(match[8])&&re.not_primitive.test(match[8])&&get_type(arg)=="function")arg=arg();if(re.numeric_arg.test(match[8])&&(get_type(arg)!="number"&&isNaN(arg)))throw new TypeError(sprintf("[sprintf] expecting number but found %s",get_type(arg)));if(re.number.test(match[8]))is_positive=
arg>=0;switch(match[8]){case "b":arg=parseInt(arg,10).toString(2);break;case "c":arg=String.fromCharCode(parseInt(arg,10));break;case "d":case "i":arg=parseInt(arg,10);break;case "j":arg=JSON.stringify(arg,null,match[6]?parseInt(match[6]):0);break;case "e":arg=match[7]?parseFloat(arg).toExponential(match[7]):parseFloat(arg).toExponential();break;case "f":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case "g":arg=match[7]?parseFloat(arg).toPrecision(match[7]):parseFloat(arg);
break;case "o":arg=arg.toString(8);break;case "s":arg=String(arg);arg=match[7]?arg.substring(0,match[7]):arg;break;case "t":arg=String(!!arg);arg=match[7]?arg.substring(0,match[7]):arg;break;case "T":arg=get_type(arg);arg=match[7]?arg.substring(0,match[7]):arg;break;case "u":arg=parseInt(arg,10)>>>0;break;case "v":arg=arg.valueOf();arg=match[7]?arg.substring(0,match[7]):arg;break;case "x":arg=parseInt(arg,10).toString(16);break;case "X":arg=parseInt(arg,10).toString(16).toUpperCase();break}if(re.json.test(match[8]))output[output.length]=
arg;else{if(re.number.test(match[8])&&(!is_positive||match[3])){sign=is_positive?"+":"-";arg=arg.toString().replace(re.sign,"")}else sign="";pad_character=match[4]?match[4]==="0"?"0":match[4].charAt(1):" ";pad_length=match[6]-(sign+arg).length;pad=match[6]?pad_length>0?str_repeat(pad_character,pad_length):"":"";output[output.length]=match[5]?sign+arg+pad:pad_character==="0"?sign+pad+arg:pad+sign+arg}}}return output.join("")};sprintf.cache={};sprintf.parse=function(fmt){var _fmt=fmt,match=[],parse_tree=
[],arg_names=0;while(_fmt){if((match=re.text.exec(_fmt))!==null)parse_tree[parse_tree.length]=match[0];else if((match=re.modulo.exec(_fmt))!==null)parse_tree[parse_tree.length]="%";else if((match=re.placeholder.exec(_fmt))!==null){if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if((field_match=re.key.exec(replacement_field))!==null){field_list[field_list.length]=field_match[1];while((replacement_field=replacement_field.substring(field_match[0].length))!=="")if((field_match=
re.key_access.exec(replacement_field))!==null)field_list[field_list.length]=field_match[1];else if((field_match=re.index_access.exec(replacement_field))!==null)field_list[field_list.length]=field_match[1];else throw new SyntaxError("[sprintf] failed to parse named argument key");}else throw new SyntaxError("[sprintf] failed to parse named argument key");match[2]=field_list}else arg_names|=2;if(arg_names===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");
parse_tree[parse_tree.length]=match}else throw new SyntaxError("[sprintf] unexpected placeholder");_fmt=_fmt.substring(match[0].length)}return parse_tree};var vsprintf=function(fmt,argv,_argv){_argv=(argv||[]).slice(0);_argv.splice(0,0,fmt);return sprintf.apply(null,_argv)};function get_type(variable){if(typeof variable==="number")return"number";else if(typeof variable==="string")return"string";else return Object.prototype.toString.call(variable).slice(8,-1).toLowerCase()}var preformattedPadding=
{0:["","0","00","000","0000","00000","000000","0000000"]," ":[""," ","  ","   ","    ","     ","      ","       "],"_":["","_","__","___","____","_____","______","_______"]};function str_repeat(input,multiplier){if(multiplier>=0&&multiplier<=7&&preformattedPadding[input])return preformattedPadding[input][multiplier];return Array(multiplier+1).join(input)}if(typeof exports!=="undefined"){exports.sprintf=sprintf;exports.vsprintf=vsprintf}else{window.sprintf=sprintf;window.vsprintf=vsprintf;if(typeof define===
"function"&&define.amd)define(function(){return{sprintf:sprintf,vsprintf:vsprintf}})}})(typeof window==="undefined"?this:window);var SpriteToBuffer={};SpriteToBuffer.Channel={ALL:0,RED:1,GREEN:2,BLUE:3,ALPHA:4};
(function(){function getChannel(image,channel){var canvas=null;var ctx=null;if(image instanceof HTMLCanvasElement){canvas=image;ctx=canvas.getContext("2d")}else{var canvas=createCanvas(image.width,image.height);ctx=canvas.getContext("2d");ctx.drawImage(image,0,0)}var imageData=ctx.getImageData(0,0,canvas.width,canvas.height);var retData;if(channel==SpriteToBuffer.Channel.ALL)retData=imageData.data;else retData=extractChannel(imageData.data,canvas.width,canvas.height,channel);return retData}function createCanvas(w,
h){var canvas=document.createElement("canvas");canvas.width=w;canvas.height=h;return canvas}function extractChannel(data,width,height,channel){var ret=typeof Uint8Array!=="undefined"?new Uint8Array(width*height):new Array(width*height);var pos=0;for(var i=0;i<data.length;i+=4)ret[pos++]=data[i+(channel-1)];return ret}SpriteToBuffer.getImageBuffer=function(sprite,channel){channel=channel||SpriteToBuffer.Channel.ALL;if(!cc.sys.isNative)return getChannel(sprite.getTexture().getHtmlElementObj(),channel);
else;}}).call(window||module||{});(function(){var root=this;var previousUnderscore=root._;var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,nativeCreate=Object.create;var Ctor=function(){};var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj};if(typeof exports!==
"undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=_;exports._=_}else root._=_;_.VERSION="1.8.3";var optimizeCb=function(func,context,argCount){if(context===void 0)return func;switch(argCount==null?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,
value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}};var cb=function(value,context,argCount){if(value==null)return _.identity;if(_.isFunction(value))return optimizeCb(value,context,argCount);if(_.isObject(value))return _.matcher(value);return _.property(value)};_.iteratee=function(value,context){return cb(value,context,Infinity)};var createAssigner=function(keysFunc,undefinedOnly){return function(obj){var length=
arguments.length;if(length<2||obj==null)return obj;for(var index=1;index<length;index++){var source=arguments[index],keys=keysFunc(source),l=keys.length;for(var i=0;i<l;i++){var key=keys[i];if(!undefinedOnly||obj[key]===void 0)obj[key]=source[key]}}return obj}};var baseCreate=function(prototype){if(!_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;Ctor.prototype=null;return result};var property=function(key){return function(obj){return obj==
null?void 0:obj[key]}};var MAX_ARRAY_INDEX=Math.pow(2,53)-1;var getLength=property("length");var isArrayLike=function(collection){var length=getLength(collection);return typeof length=="number"&&length>=0&&length<=MAX_ARRAY_INDEX};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj))for(i=0,length=obj.length;i<length;i++)iteratee(obj[i],i,obj);else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++)iteratee(obj[keys[i]],keys[i],
obj)}return obj};_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length);for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj)}return results};function createReduce(dir){function iterator(obj,iteratee,memo,keys,index,length){for(;index>=0&&index<length;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,
obj[currentKey],currentKey,obj)}return memo}return function(obj,iteratee,memo,context){iteratee=optimizeCb(iteratee,context,4);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;if(arguments.length<3){memo=obj[keys?keys[index]:index];index+=dir}return iterator(obj,iteratee,memo,keys,index,length)}}_.reduce=_.foldl=_.inject=createReduce(1);_.reduceRight=_.foldr=createReduce(-1);_.find=_.detect=function(obj,predicate,context){var key;if(isArrayLike(obj))key=_.findIndex(obj,
predicate,context);else key=_.findKey(obj,predicate,context);if(key!==void 0&&key!==-1)return obj[key]};_.filter=_.select=function(obj,predicate,context){var results=[];predicate=cb(predicate,context);_.each(obj,function(value,index,list){if(predicate(value,index,list))results.push(value)});return results};_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context)};_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&
_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return false}return true};_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return true}return false};_.contains=_.includes=_.include=
function(obj,item,fromIndex,guard){if(!isArrayLike(obj))obj=_.values(obj);if(typeof fromIndex!="number"||guard)fromIndex=0;return _.indexOf(obj,item,fromIndex)>=0};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){var func=isFunc?method:value[method];return func==null?func:func.apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,_.property(key))};_.where=function(obj,attrs){return _.filter(obj,_.matcher(attrs))};
_.findWhere=function(obj,attrs){return _.find(obj,_.matcher(attrs))};_.max=function(obj,iteratee,context){var result=-Infinity,lastComputed=-Infinity,value,computed;if(iteratee==null&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value>result)result=value}}else{iteratee=cb(iteratee,context);_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed>lastComputed||computed===-Infinity&&result===-Infinity){result=
value;lastComputed=computed}})}return result};_.min=function(obj,iteratee,context){var result=Infinity,lastComputed=Infinity,value,computed;if(iteratee==null&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value<result)result=value}}else{iteratee=cb(iteratee,context);_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed<lastComputed||computed===Infinity&&result===Infinity){result=value;lastComputed=computed}})}return result};
_.shuffle=function(obj){var set=isArrayLike(obj)?obj:_.values(obj);var length=set.length;var shuffled=Array(length);for(var index=0,rand;index<length;index++){rand=_.random(0,index);if(rand!==index)shuffled[index]=shuffled[rand];shuffled[rand]=set[index]}return shuffled};_.sample=function(obj,n,guard){if(n==null||guard){if(!isArrayLike(obj))obj=_.values(obj);return obj[_.random(obj.length-1)]}return _.shuffle(obj).slice(0,Math.max(0,n))};_.sortBy=function(obj,iteratee,context){iteratee=cb(iteratee,
context);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};iteratee=cb(iteratee,context);_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,
key)});return result}};_.groupBy=group(function(result,value,key){if(_.has(result,key))result[key].push(value);else result[key]=[value]});_.indexBy=group(function(result,value,key){result[key]=value});_.countBy=group(function(result,value,key){if(_.has(result,key))result[key]++;else result[key]=1});_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(isArrayLike(obj))return _.map(obj,_.identity);return _.values(obj)};_.size=function(obj){if(obj==null)return 0;return isArrayLike(obj)?
obj.length:_.keys(obj).length};_.partition=function(obj,predicate,context){predicate=cb(predicate,context);var pass=[],fail=[];_.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)});return[pass,fail]};_.first=_.head=_.take=function(array,n,guard){if(array==null)return void 0;if(n==null||guard)return array[0];return _.initial(array,array.length-n)};_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(n==null||guard?1:n)))};_.last=function(array,
n,guard){if(array==null)return void 0;if(n==null||guard)return array[array.length-1];return _.rest(array,Math.max(0,array.length-n))};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n)};_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,startIndex){var output=[],idx=0;for(var i=startIndex||0,length=getLength(input);i<length;i++){var value=input[i];if(isArrayLike(value)&&(_.isArray(value)||_.isArguments(value))){if(!shallow)value=
flatten(value,shallow,strict);var j=0,len=value.length;output.length+=len;while(j<len)output[idx++]=value[j++]}else if(!strict)output[idx++]=value}return output};_.flatten=function(array,shallow){return flatten(array,shallow,false)};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iteratee,context){if(!_.isBoolean(isSorted)){context=iteratee;iteratee=isSorted;isSorted=false}if(iteratee!=null)iteratee=cb(iteratee,context);var result=
[];var seen=[];for(var i=0,length=getLength(array);i<length;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;if(isSorted){if(!i||seen!==computed)result.push(value);seen=computed}else if(iteratee){if(!_.contains(seen,computed)){seen.push(computed);result.push(value)}}else if(!_.contains(result,value))result.push(value)}return result};_.union=function(){return _.uniq(flatten(arguments,true,true))};_.intersection=function(array){var result=[];var argsLength=arguments.length;for(var i=
0,length=getLength(array);i<length;i++){var item=array[i];if(_.contains(result,item))continue;for(var j=1;j<argsLength;j++)if(!_.contains(arguments[j],item))break;if(j===argsLength)result.push(item)}return result};_.difference=function(array){var rest=flatten(arguments,true,true,1);return _.filter(array,function(value){return!_.contains(rest,value)})};_.zip=function(){return _.unzip(arguments)};_.unzip=function(array){var length=array&&_.max(array,getLength).length||0;var result=Array(length);for(var index=
0;index<length;index++)result[index]=_.pluck(array,index);return result};_.object=function(list,values){var result={};for(var i=0,length=getLength(list);i<length;i++)if(values)result[list[i]]=values[i];else result[list[i][0]]=list[i][1];return result};function createPredicateIndexFinder(dir){return function(array,predicate,context){predicate=cb(predicate,context);var length=getLength(array);var index=dir>0?0:length-1;for(;index>=0&&index<length;index+=dir)if(predicate(array[index],index,array))return index;
return-1}}_.findIndex=createPredicateIndexFinder(1);_.findLastIndex=createPredicateIndexFinder(-1);_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);var value=iteratee(obj);var low=0,high=getLength(array);while(low<high){var mid=Math.floor((low+high)/2);if(iteratee(array[mid])<value)low=mid+1;else high=mid}return low};function createIndexFinder(dir,predicateFind,sortedIndex){return function(array,item,idx){var i=0,length=getLength(array);if(typeof idx=="number")if(dir>
0)i=idx>=0?idx:Math.max(idx+length,i);else length=idx>=0?Math.min(idx+1,length):idx+length+1;else if(sortedIndex&&idx&&length){idx=sortedIndex(array,item);return array[idx]===item?idx:-1}if(item!==item){idx=predicateFind(slice.call(array,i,length),_.isNaN);return idx>=0?idx+i:-1}for(idx=dir>0?i:length-1;idx>=0&&idx<length;idx+=dir)if(array[idx]===item)return idx;return-1}}_.indexOf=createIndexFinder(1,_.findIndex,_.sortedIndex);_.lastIndexOf=createIndexFinder(-1,_.findLastIndex);_.range=function(start,
stop,step){if(stop==null){stop=start||0;start=0}step=step||1;var length=Math.max(Math.ceil((stop-start)/step),0);var range=Array(length);for(var idx=0;idx<length;idx++,start+=step)range[idx]=start;return range};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype);var result=sourceFunc.apply(self,args);if(_.isObject(result))return result;return self};_.bind=
function(func,context){if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");var args=slice.call(arguments,2);var bound=function(){return executeBound(func,bound,context,this,args.concat(slice.call(arguments)))};return bound};_.partial=function(func){var boundArgs=slice.call(arguments,1);var bound=function(){var position=0,length=boundArgs.length;var args=Array(length);for(var i=0;i<
length;i++)args[i]=boundArgs[i]===_?arguments[position++]:boundArgs[i];while(position<arguments.length)args.push(arguments[position++]);return executeBound(func,bound,this,this,args)};return bound};_.bindAll=function(obj){var i,length=arguments.length,key;if(length<=1)throw new Error("bindAll must be passed function names");for(i=1;i<length;i++){key=arguments[i];obj[key]=_.bind(obj[key],obj)}return obj};_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache;var address=
""+(hasher?hasher.apply(this,arguments):key);if(!_.has(cache,address))cache[address]=func.apply(this,arguments);return cache[address]};memoize.cache={};return memoize};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};_.defer=_.partial(_.delay,_,1);_.throttle=function(func,wait,options){var context,args,result;var timeout=null;var previous=0;if(!options)options={};var later=function(){previous=options.leading===false?0:_.now();
timeout=null;result=func.apply(context,args);if(!timeout)context=args=null};return function(){var now=_.now();if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0||remaining>wait){if(timeout){clearTimeout(timeout);timeout=null}previous=now;result=func.apply(context,args);if(!timeout)context=args=null}else if(!timeout&&options.trailing!==false)timeout=setTimeout(later,remaining);return result}};_.debounce=function(func,wait,
immediate){var timeout,args,context,timestamp,result;var later=function(){var last=_.now()-timestamp;if(last<wait&&last>=0)timeout=setTimeout(later,wait-last);else{timeout=null;if(!immediate){result=func.apply(context,args);if(!timeout)context=args=null}}};return function(){context=this;args=arguments;timestamp=_.now();var callNow=immediate&&!timeout;if(!timeout)timeout=setTimeout(later,wait);if(callNow){result=func.apply(context,args);context=args=null}return result}};_.wrap=function(func,wrapper){return _.partial(wrapper,
func)};_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}};_.compose=function(){var args=arguments;var start=args.length-1;return function(){var i=start;var result=args[start].apply(this,arguments);while(i--)result=args[i].call(this,result);return result}};_.after=function(times,func){return function(){if(--times<1)return func.apply(this,arguments)}};_.before=function(times,func){var memo;return function(){if(--times>0)memo=func.apply(this,arguments);if(times<=
1)func=null;return memo}};_.once=_.partial(_.before,2);var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString");var nonEnumerableProps=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function collectNonEnumProps(obj,keys){var nonEnumIdx=nonEnumerableProps.length;var constructor=obj.constructor;var proto=_.isFunction(constructor)&&constructor.prototype||ObjProto;var prop="constructor";if(_.has(obj,prop)&&!_.contains(keys,prop))keys.push(prop);
while(nonEnumIdx--){prop=nonEnumerableProps[nonEnumIdx];if(prop in obj&&obj[prop]!==proto[prop]&&!_.contains(keys,prop))keys.push(prop)}}_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)if(_.has(obj,key))keys.push(key);if(hasEnumBug)collectNonEnumProps(obj,keys);return keys};_.allKeys=function(obj){if(!_.isObject(obj))return[];var keys=[];for(var key in obj)keys.push(key);if(hasEnumBug)collectNonEnumProps(obj,keys);return keys};
_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=Array(length);for(var i=0;i<length;i++)values[i]=obj[keys[i]];return values};_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=_.keys(obj),length=keys.length,results={},currentKey;for(var index=0;index<length;index++){currentKey=keys[index];results[currentKey]=iteratee(obj[currentKey],currentKey,obj)}return results};_.pairs=function(obj){var keys=_.keys(obj);var length=keys.length;var pairs=
Array(length);for(var i=0;i<length;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++)result[obj[keys[i]]]=keys[i];return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj)if(_.isFunction(obj[key]))names.push(key);return names.sort()};_.extend=createAssigner(_.allKeys);_.extendOwn=_.assign=createAssigner(_.keys);_.findKey=function(obj,predicate,context){predicate=cb(predicate,
context);var keys=_.keys(obj),key;for(var i=0,length=keys.length;i<length;i++){key=keys[i];if(predicate(obj[key],key,obj))return key}};_.pick=function(object,oiteratee,context){var result={},obj=object,iteratee,keys;if(obj==null)return result;if(_.isFunction(oiteratee)){keys=_.allKeys(obj);iteratee=optimizeCb(oiteratee,context)}else{keys=flatten(arguments,false,false,1);iteratee=function(value,key,obj){return key in obj};obj=Object(obj)}for(var i=0,length=keys.length;i<length;i++){var key=keys[i];
var value=obj[key];if(iteratee(value,key,obj))result[key]=value}return result};_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee))iteratee=_.negate(iteratee);else{var keys=_.map(flatten(arguments,false,false,1),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)};_.defaults=createAssigner(_.allKeys,true);_.create=function(prototype,props){var result=baseCreate(prototype);if(props)_.extendOwn(result,props);return result};_.clone=function(obj){if(!_.isObject(obj))return obj;
return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};_.isMatch=function(object,attrs){var keys=_.keys(attrs),length=keys.length;if(object==null)return!length;var obj=Object(object);for(var i=0;i<length;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return false}return true};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a===1/b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=
b._wrapped;var className=toString.call(a);if(className!==toString.call(b))return false;switch(className){case "[object RegExp]":case "[object String]":return""+a===""+b;case "[object Number]":if(+a!==+a)return+b!==+b;return+a===0?1/+a===1/b:+a===+b;case "[object Date]":case "[object Boolean]":return+a===+b}var areArrays=className==="[object Array]";if(!areArrays){if(typeof a!="object"||typeof b!="object")return false;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&
aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&("constructor"in a&&"constructor"in b))return false}aStack=aStack||[];bStack=bStack||[];var length=aStack.length;while(length--)if(aStack[length]===a)return bStack[length]===b;aStack.push(a);bStack.push(b);if(areArrays){length=a.length;if(length!==b.length)return false;while(length--)if(!eq(a[length],b[length],aStack,bStack))return false}else{var keys=_.keys(a),key;length=keys.length;if(_.keys(b).length!==length)return false;while(length--){key=
keys[length];if(!(_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))return false}}aStack.pop();bStack.pop();return true};_.isEqual=function(a,b){return eq(a,b)};_.isEmpty=function(obj){if(obj==null)return true;if(isArrayLike(obj)&&(_.isArray(obj)||_.isString(obj)||_.isArguments(obj)))return obj.length===0;return _.keys(obj).length===0};_.isElement=function(obj){return!!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==="[object Array]"};_.isObject=function(obj){var type=
typeof obj;return type==="function"||type==="object"&&!!obj};_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}});if(!_.isArguments(arguments))_.isArguments=function(obj){return _.has(obj,"callee")};if(typeof/./!="function"&&typeof Int8Array!="object")_.isFunction=function(obj){return typeof obj=="function"||false};_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))};
_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)==="[object Boolean]"};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,key){return obj!=null&&hasOwnProperty.call(obj,key)};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.constant=function(value){return function(){return value}};_.noop=function(){};
_.property=property;_.propertyOf=function(obj){return obj==null?function(){}:function(key){return obj[key]}};_.matcher=_.matches=function(attrs){attrs=_.extendOwn({},attrs);return function(obj){return _.isMatch(obj,attrs)}};_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;i<n;i++)accum[i]=iteratee(i);return accum};_.random=function(min,max){if(max==null){max=min;min=0}return min+Math.floor(Math.random()*(max-min+1))};_.now=Date.now||
function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var unescapeMap=_.invert(escapeMap);var createEscaper=function(map){var escaper=function(match){return map[match]};var source="(?:"+_.keys(map).join("|")+")";var testRegexp=RegExp(source);var replaceRegexp=RegExp(source,"g");return function(string){string=string==null?"":""+string;return testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap);
_.unescape=createEscaper(unescapeMap);_.result=function(object,property,fallback){var value=object==null?void 0:object[property];if(value===void 0)value=fallback;return _.isFunction(value)?value.call(object):value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};
var escaper=/\\|'|\r|\n|\u2028|\u2029/g;var escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){if(!settings&&oldSettings)settings=oldSettings;settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g");var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=
text.slice(index,offset).replace(escaper,escapeChar);index=offset+match.length;if(escape)source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'";else if(interpolate)source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'";else if(evaluate)source+="';\n"+evaluate+"\n__p+='";return match});source+="';\n";if(!settings.variable)source="with(obj||{}){\n"+source+"}\n";source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=
new Function(settings.variable||"obj","_",source)}catch(e){e.source=source;throw e;}var template=function(data){return render.call(this,data,_)};var argument=settings.variable||"obj";template.source="function("+argument+"){\n"+source+"}";return template};_.chain=function(obj){var instance=_(obj);instance._chain=true;return instance};var result=function(instance,obj){return instance._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=
function(){var args=[this._wrapped];push.apply(args,arguments);return result(this,func.apply(_,args))}})};_.mixin(_);_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name==="shift"||name==="splice")&&obj.length===0)delete obj[0];return result(this,obj)}});_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result(this,
method.apply(this._wrapped,arguments))}});_.prototype.value=function(){return this._wrapped};_.prototype.valueOf=_.prototype.toJSON=_.prototype.value;_.prototype.toString=function(){return""+this._wrapped};if(typeof define==="function"&&define.amd)define("underscore",[],function(){return _})}).call(window||module||{});var WebAppInstallBanner={};WebAppInstallBanner.deferredPrompt=null;WebAppInstallBanner.canShowPrompt=true;if(!cc.sys.isNative)window.addEventListener("beforeinstallprompt",function(e){cc.log("\u6536\u5230\u8981\u51fa\u73feWebInstallBanner");WebAppInstallBanner.deferredPrompt=e;if(WebAppInstallBanner.canShowPrompt)WebAppInstallBanner.showBanner(true);else{e.preventDefault();return false}});
WebAppInstallBanner.showBanner=function(directShow){var deferredPrompt=WebAppInstallBanner.deferredPrompt;if(deferredPrompt){if(!directShow)deferredPrompt.prompt();var nowScene=cc.director.getRunningScene();var screen="\u767b\u5165\u524d";if(nowScene)screen=nowScene.getTag()==GSEnum.Scene.Lobby?"\u5927\u5ef3":"\u767b\u5165\u524d";GSGoogleAnalytics.logEvent("\u52a0\u5230\u4e3b\u756b\u9762","\u8df3\u51fa\u8996\u7a97",screen);deferredPrompt.userChoice.then(function(choiceResult){var outcome=choiceResult.outcome;
cc.log(outcome);if(outcome=="dismissed"){GSGoogleAnalytics.logEvent("\u52a0\u5230\u4e3b\u756b\u9762","\u53d6\u6d88",screen);cc.log("\u4f7f\u7528\u8005\u53d6\u6d88\u5b89\u88dd")}else{GSGoogleAnalytics.logEvent("\u52a0\u5230\u4e3b\u756b\u9762","\u78ba\u8a8d",screen);cc.log("\u4f7f\u7528\u8005\u78ba\u5b9a\u5b89\u88dd")}WebAppInstallBanner.deferredPrompt=null})}};var GSEaseNumberLabel=GSNumberLabel.extend({ctor:function(label,fontName,fontSize,dimensions,hAlignment,vAlignment){this._super(label,fontName,fontSize,dimensions,hAlignment,vAlignment);this._totalNumber=parseInt(label);this.nowNumber=parseInt(label);this._originalUpdateTime=.5;this._totalUpdateTime=.5;this._updateCallback=undefined},scheduleUpdateLabel:function(dt){this._usedTime+=dt;var easingValue=this.easeOutCirc(this._usedTime/this._totalUpdateTime);if(this._usedTime<this._totalUpdateTime)this.nowNumber=
Math.floor(this._floorNumber+(this._totalNumber-this._floorNumber)*easingValue);else{this._reset();this.unschedule(this.scheduleUpdateLabel);this.nowNumber=this._totalNumber}var label=this.isUseCurrencyString?JSCodeUtility.getCurrencyString(this.nowNumber):this.nowNumber;if(this._isAddSymbol)if(this._isSymbolAtFront)label=this.symbol+label;else label=label+this.symbol;else if(this._format){if(this.isUseCurrencyString){this._format=this._format.replace("%d","%s");this._format=this._format.replace("%f",
"%s")}label=JSStringUtility.format(this._format,label)}this.setString(label);this._updateCallback&&this._updateCallback(this.nowNumber)},setUpdateTime:function(updateTime){this._totalUpdateTime=updateTime;this._originalUpdateTime=updateTime},setToNumber:function(toNumber,deltaTime=.05){toNumber=JSCodeUtility.getFloatValue(toNumber);if(toNumber<0||toNumber===this._totalNumber)return;if(toNumber===this._totalNumber&&deltaTime!==false)return;this.unschedule(this.scheduleUpdateLabel);if(toNumber<this._nowNumber||
deltaTime===false)this.setNumber(toNumber);else{this._totalNumber=toNumber;this._floorNumber=this.nowNumber;this._totalUpdateTime+=this._usedTime;this._usedTime=0;if(this._floorNumber===this._totalNumber)return;this.schedule(this.scheduleUpdateLabel,deltaTime)}},setNumber:function(toNumber){toNumber=JSCodeUtility.getFloatValue(toNumber);this._totalNumber=toNumber;this._floorNumber=this.nowNumber;this.scheduleUpdateLabel(999999);this._reset()},getNumberUpdateCallback:function(){return this._updateCallback},
_reset:function(){this._totalUpdateTime=this._originalUpdateTime;this._usedTime=0},easeOutCirc:function(x){return Math.sqrt(1-Math.pow(x-1,2))},stopAnimAndToTotalNumber:function(){this._reset();this._super()}});var GSEaseNumberNode=GSNumberNode.extend({ctor:function(number,prefixName,numberSize,dotSize,addPlus,addComma,maxWidth=0,numberFormat="%02d"){this._originalUpdateTime=.5;this._totalUpdateTime=.5;this._updateCallback=undefined;this._super(number,prefixName,numberSize,dotSize,addPlus,addComma,maxWidth,numberFormat)},setUpdateTime:function(updateTime){this._originalUpdateTime=updateTime;this._totalUpdateTime=updateTime},setNumber:function(number,actionParam,isSchedule=false){number=parseInt(number);
if(!isSchedule){this._totalNumber=number;this._isAnim=false}this._super(number,actionParam)},setToNumber:function(toNumber,deltaTime=.05){toNumber=parseInt(toNumber);if(toNumber<0){cc.log("Error: GSEaseNumberNode Number < 0");return}if(toNumber===this._totalNumber&&deltaTime!==false)return;this.unschedule(this.scheduleUpdateNumber);if(toNumber<this._nowNumber||deltaTime===false)this.setNumber(toNumber);else{this._totalNumber=toNumber;this._floorNumber=this._nowNumber;this._totalUpdateTime+=this._usedTime;
this._usedTime=0;if(this._floorNumber===this._totalNumber)this.setNumber(this._nowNumber);else{this.schedule(this.scheduleUpdateNumber,deltaTime);this._isAnim=true}}},scheduleUpdateNumber:function(dt){this._usedTime+=dt;if(this._usedTime<this._totalUpdateTime){var easingValue=this.easeOutCirc(this._usedTime/this._totalUpdateTime);this._nowNumber=Math.floor(this._floorNumber+(this._totalNumber-this._floorNumber)*easingValue)}else{this._reset();this.unschedule(this.scheduleUpdateNumber);this._isAnim=
false;this._nowNumber=this._totalNumber;if(this._finishCallback){var action1=cc.delayTime(dt);var action2=cc.callFunc(()=>this._finishCallback());this.runAction(cc.sequence(action1,action2))}}this.setNumber(this._nowNumber,null,true);if(this._updateCallback)this._updateCallback(this._nowNumber)},stopAnimAndToTotalNumber:function(){this._reset();this._super()},setNumberUpdateCallback:function(callback){if(callback)this._updateCallback=callback},getNumberUpdateCallback:function(){return this._updateCallback},
_reset:function(){this._totalUpdateTime=this._originalUpdateTime;this._usedTime=0},easeOutCirc:function(x){return Math.sqrt(1-Math.pow(x-1,2))}});var GSListPicker=BaseDialogLayer.extend({ctor:function(param){this._super();this.key="GSListPicker";this._param=param;var aniLayer=this._animationLayer;var list=param.list;var title=param.title;var length=this._length=list.length;var cellSize=this._cellSize=param.cellSize||GSListPickerCell.SIZE;var max=length>=5?5:length;var useConfirmBtn=this._useConfirmBtn=param.buttonString&&param.buttonString.length;var tableViewSize=cc.size(cellSize.width,cellSize.height*(max+(length>5?.5:0)));var backgroundBonus=
param.backgroundBonus||cc.size(40,80);var backgroundSize=this._backgroundSize=cc.size(tableViewSize.width+backgroundBonus.width,tableViewSize.height+backgroundBonus.height);var background=new ccui.Scale9Sprite(param.backgroundImage);if(param.backgroundCapInsets)background.setCapInsets(param.backgroundCapInsets);background.setPreferredSize(backgroundSize);background.setPosition(JSScreenMidPos);aniLayer.addChild(background);for(var i=0;i<2;i++){var isUp=i===0;var light=new cc.Sprite(param.lightImage);
light.setRotation(isUp?0:180);light.setAnchorPoint(cc.p(.5,0));light.setPosition(cc.p(JSScreenMidPos.x,JSScreenMidPos.y+tableViewSize.height*.5*(isUp?1:-1)));aniLayer.addChild(light)}if(title&&title.length){var pos=cc.p(JSScreenMidPos.x,JSScreenMidPos.y+backgroundSize.height/2-24);var titleLabel=new cc.LabelTTF(title,JSFontBoldName,15);titleLabel.setFontFillColor(param.titleColor||JSColor.WHITE);titleLabel.setPosition(pos);aniLayer.addChild(titleLabel)}var mainLayer=new cc.Layer;var tableView=this._tableView=
new cc.TableView(this,tableViewSize,mainLayer);tableView.setDirection(cc.SCROLLVIEW_DIRECTION_VERTICAL);tableView.setVerticalFillOrder(cc.TABLEVIEW_FILL_TOPDOWN);tableView.setDelegate(this);tableView.setPosition(JSScreenMidPos.x-tableViewSize.width/2,JSScreenMidPos.y-tableViewSize.height/2);aniLayer.addChild(tableView);if(param.selectedIndex>=2){var paddingIndex=3.5;if(length-param.selectedIndex<=3)paddingIndex=length-param.selectedIndex;tableView.setContentOffset(cc.p(0,-cellSize.height*(length-
param.selectedIndex-paddingIndex)),false)}if(useConfirmBtn){var confirmBtnSize=param.buttonSize||cc.size(98,28);var node=new cc.Node;var buttonSprite=new ccui.Scale9Sprite(param.buttonImage);buttonSprite.setPreferredSize(confirmBtnSize);node.addChild(buttonSprite);var buttonLabel=new cc.LabelTTF(param.buttonString,JSFontBoldName,12);buttonLabel.setFontFillColor(param.buttonColor||JSColor.BLACK);param.buttonOutlineColor&&buttonLabel.enableStroke(param.buttonOutlineColor,param.buttonOutlineSize);node.addChild(buttonLabel);
var button=new GSControlButton(node,confirmBtnSize);button.setPosition(JSScreenMidPos.x,JSScreenMidPos.y-backgroundSize.height/2+22);button.addTouchUpInsideAction(this._confirmClicked,this);aniLayer.addChild(button)}},addExitBtn:function(button,btnPosition=cc.p(-5,-5)){button.setPosition(JSScreenMidPos.x+this._backgroundSize.width/2+btnPosition.x,JSScreenMidPos.y+this._backgroundSize.height/2+btnPosition.y);button.addTouchUpInsideAction(this._exitClick,this);this._animationLayer.addChild(button,2)},
addIDExitBtn:function(){var node=new cc.Node;var buttonSprite1=new cc.Sprite("#lobby_btn_circle_04.png");node.addChild(buttonSprite1);var buttonSprite2=new cc.Sprite("#lobby_btn_pic_window_x.png");node.addChild(buttonSprite2);var button=new GSControlButton(node,cc.size(28,28));button.setPosition(JSScreenMidPos.x+this._backgroundSize.width/2-5,JSScreenMidPos.y+this._backgroundSize.height/2+-5);button.addTouchUpInsideAction(this._exitClick,this);this._animationLayer.addChild(button)},_confirmClicked:function(){this._param.callback&&
this._param.callback(this._param.selectedIndex);this._closeDialogAnimation()},_exitClick:function(){this._closeDialogAnimation()},tableCellTouched:function(table,cell){this._param.selectedIndex=cell.getIdx();if(this._useConfirmBtn)this._tableView.reloadData();else this._confirmClicked()},tableCellHighlight:function(table,cell){cell.setIsHighlight(true)},tableCellUnhighlight:function(table,cell){cell.setIsHighlight(false)},tableCellAtIndex:function(table,idx){var cell=table.dequeueCell();if(cell==
null){cell=new GSListPickerCell(this._param,this._cellSize);cell.setAnchorPoint(cc.p(0,1))}cell.refresh(idx,this._param);return cell},numberOfCellsInTableView:function(table){return this._length},tableCellSizeForIndex:function(table,idx){return this._cellSize}});
GSListPicker.createIDListPicker=function(param){var pickerParam={"title":param.title||"","list":param.list,"backgroundImage":"lobby_bg_window.png","lightImage":"#lobby_pic_light_gold.png","selectImage":"pic_line_red.png","selectedIndex":param.selectedIndex,"buttonImage":"lobby_btn_01.png","buttonString":param.buttonString||"",callback:param.callback};var picker=new GSListPicker(pickerParam);picker.addIDExitBtn();DialogManager.addDialog(picker,false)};var GSListPickerCell=cc.TableViewCell.extend({ctor:function(param,cellSize){this._super();this.setCascadeColorEnabled(true);var midPos=cc.p(cellSize.width/2,cellSize.height/2);var selectBG=this._selectBG=new ccui.Scale9Sprite(param.selectImage);selectBG.setPreferredSize(cc.size(cellSize.width-20,cellSize.height-4));selectBG.setPosition(midPos);selectBG.setVisible(false);this.addChild(selectBG);var label=this._label=new cc.LabelTTF("",JSFontBoldName,12);label.setFontFillColor(JSColor.BLACK);label.setPosition(midPos);
this.addChild(label)},setIsHighlight:function(isSelect){this._selectBG.setVisible(isSelect)},refresh:function(idx,param){if(idx>=0){this._label.setString(param.list[idx]);if(idx===param.selectedIndex)this._label.setFontFillColor(param.selectColor||JSColor.YELLOW);else this._label.setFontFillColor(param.unselectColor||JSColor.WHITE)}}});GSListPickerCell.SIZE=cc.size(290,28);var AlertDialogArray=[];
var AlertDialog=BaseDialogLayer.extend({ctor:function(obj){this._super();this.setCascadeOpacityEnabled(true);this._callback=obj.callback;this.testString=obj.content;if(!obj.buttons||obj.buttons.length===0)obj.buttons=[LocalizedString.Common("\u78ba\u8a8d")];var aniLayer=this._animationLayer;var imageEmptyOffset=8;var upperOffset=14;var contentOffsetY=6;var buttonOffsetY=10;var dialogWidth=200;var btnHeight=24;var bgSize=cc.size(dialogWidth,imageEmptyOffset*2+btnHeight);var mainNode=new cc.ClippingNode;
mainNode.setAlphaThreshold(.1);mainNode.setPosition(JSScreenMidPos);aniLayer.addChild(mainNode);var posOffsetY=0;if(obj.title&&obj.title.length){var titleLabel=new cc.LabelTTF(obj.title,JSFontBoldName,13,cc.size(dialogWidth-20,0),cc.TEXT_ALIGNMENT_CENTER);titleLabel.setColor(JSColor.BLACK);titleLabel.setAnchorPoint(.5,1);mainNode.addChild(titleLabel);posOffsetY=titleLabel.getContentSize().height+contentOffsetY;bgSize.height+=posOffsetY}if(obj.content&&obj.content.length){var contentLabel=new GSRichTextNode("#!000000!#"+
obj.content,JSFontBoldName,10,cc.size(dialogWidth-20,0));contentLabel.setTextHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);contentLabel.setTextVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER);mainNode.addChild(contentLabel);bgSize.height+=contentLabel.getContentSize().height+buttonOffsetY}var btnLen=obj.buttons.length;var menu=this._menu=new cc.Menu;menu.setPosition(0,0);mainNode.addChild(menu);this._buttons=[];obj.buttons.forEach((cur,index)=>{var itemNode=[];var size=cc.size(btnLen===2?dialogWidth/
2:dialogWidth,btnHeight);for(var i=0;i<2;i++){var node=itemNode[i]=new cc.Node;node.setCascadeColorEnabled(true);node.setCascadeOpacityEnabled(true);node.setContentSize(size);if(i===1){var bgLayer=new cc.LayerColor(cc.color(255,255,255,50),size.width-(btnLen==2?3:6),size.height);if(btnLen===2)bgLayer.setPosition(index===0?3:0,0);else bgLayer.setPosition(3,0);node.addChild(bgLayer)}var label=new cc.LabelTTF(cur,JSFontBoldName,10);label.setColor(cc.color(10,90,255));label.setPosition(size.width/2,size.height/
2);node.addChild(label);if(i===1)node.setColor(JSColor.GRAY)}var menuItem=new cc.MenuItemSprite(itemNode[0],itemNode[1],this._buttonClicked,this);menu.addChild(menuItem);this._buttons.push(menuItem)});if(btnLen>2)bgSize.height+=btnHeight*(btnLen-1);var titlePosY=bgSize.height/2-upperOffset;titleLabel&&titleLabel.setPosition(0,titlePosY);contentLabel&&contentLabel.setPosition(0,titlePosY-posOffsetY-contentLabel.getContentSize().height/2);var btnBottomY=-bgSize.height/2+15;var lineColor=cc.color(0,
0,0,180);for(var i=0;i<btnLen;i++)if(btnLen===2){this._buttons[i].setPosition(-dialogWidth/4+i*dialogWidth/2,btnBottomY);if(i===0){var line=new cc.LayerColor(lineColor,dialogWidth-6,.5);line.setPosition(-dialogWidth/2+3,btnBottomY+btnHeight/2+btnHeight*i);mainNode.addChild(line,-1)}else{var line=new cc.LayerColor(lineColor,.5,btnHeight);line.setPosition(-1,btnBottomY-btnHeight/2);mainNode.addChild(line,-1)}}else{this._buttons[btnLen-1-i].setPosition(0,btnBottomY+btnHeight*i);var line=new cc.LayerColor(lineColor,
dialogWidth-6,.5);line.setPosition(-dialogWidth/2+3,btnBottomY+btnHeight/2+btnHeight*i);mainNode.addChild(line,-1)}var bgSprite=new ccui.Scale9Sprite("information_whiteShadow_bg.png");bgSprite.setPreferredSize(bgSize);bgSprite.setOpacity(240);mainNode.addChild(bgSprite,-10);var stencilBg=new ccui.Scale9Sprite("information_whiteShadow_bg.png");stencilBg.setPreferredSize(bgSize);mainNode.setStencil(stencilBg);this._startDialogAnimation();var emptyNode=new cc.Node;mainNode.addChild(emptyNode);this.schedule(function(){emptyNode.setVisible(!emptyNode.isVisible())},
2);this.setCloseCallback(()=>{JSCodeUtility.removeArrayObject(AlertDialogArray,this);var len=AlertDialogArray.length;if(len){var alert=AlertDialogArray[0];alert._startDialogAnimation();cc.director.getNotificationNode().addChild(alert);AlertDialogArray.splice(0,1)}})},keyBackPressed:function(){this._callback&&this._callback(-1);this._closeDialogAnimation()},_buttonClicked:function(sender){var index=0;for(var i=0;i<this._buttons.length;i++)if(this._buttons[i]===sender){index=i;break}if(this._callback)this._callback(index);
this._closeDialogAnimation()}});
AlertDialog.showAlert=function(title,content,buttons,cb){if(cc.sys.isNative){title=title||"";content=content||"";buttons=buttons||[LocalizedString.Common("\u78ba\u8a8d")];var button0=buttons[0]||"";var button1=buttons[1]||"";var button2=buttons[2]||"";GSDeviceInfo.showAlert(title,content,button0,button1,button2,cb);return}var alert=new AlertDialog({title:title,content:content,buttons:buttons,callback:cb});AlertDialogArray.push(alert);if(AlertDialogArray.length===1)cc.director.getNotificationNode().addChild(alert);else alert._stopDialogAnimation()};var BadmintonButton=GSControlButton.extend({ctor:function(type,titleOrImage,size=cc.size(70,32),fontSize=12){var contentNode=new cc.Node;this._super(contentNode,cc.size(size.width,size.height));this._changeColorWhenDisabled=false;this.__type=type;this.__size=size;this.__strokeSize=2;var bgSprite=this._bgSprite=new ccui.Scale9Sprite(this._getBgImageName());bgSprite.setPreferredSize(size);contentNode.addChild(bgSprite);if(titleOrImage.indexOf(".png")>0){var imageSprite=this.imageSprite=new cc.Sprite(titleOrImage);
contentNode.addChild(imageSprite)}else{var titleLabel=this.__titleLabel=new GSAutoScaleSizeLabel(titleOrImage,JSFontBoldName,fontSize,cc.size(size.width-13,18),cc.TEXT_ALIGNMENT_CENTER,cc.VERTICAL_TEXT_ALIGNMENT_CENTER);titleLabel.enableStroke(BadmintonButton.STROKE_COLOR[type],2);contentNode.addChild(titleLabel)}},setButtonType:function(type){if(this.__type===type)return;this.__type=type;this._bgSprite.setSpriteFrame(this._getBgImageName());this._bgSprite.setPreferredSize(this.__size);this.__titleLabel&&
this.__titleLabel.enableStroke(BadmintonButton.STROKE_COLOR[type],this.__strokeSize)},setButtonTitle:function(title){this.__titleLabel&&this.__titleLabel.setString(title)},setButtonTitlePosition:function(pos){this.__titleLabel&&this.__titleLabel.setPosition(pos)},setButtonTitleStrokeSize:function(size){this.__strokeSize=size;this.__titleLabel&&this.__titleLabel.enableStroke(BadmintonButton.STROKE_COLOR[this.__type],size)},setImageScale:function(scale){var size=this.__size;this.setContentSize(cc.size(size.width*
scale,size.height*scale));this.setPreferredSize(this.getContentSize());this.refreshContentNodesPosAndSize();this._bgSprite.setScale(scale);this.__titleLabel&&this.__titleLabel.setDimensions(cc.size((size.width-13)*scale,18*scale))},_getBgImageName:function(){var bgImage;switch(this.__type){case BadmintonButton.TYPE.YELLOW:bgImage="fish_BT_01.png";break;case BadmintonButton.TYPE.BLUE:bgImage="fish_BT_02.png";break;case BadmintonButton.TYPE.GRAY:bgImage="fish_BT_03.png";break;case BadmintonButton.TYPE.GREEN:bgImage=
"fish_BT_04.png";break;case BadmintonButton.TYPE.RED:bgImage="fish_BT_05.png";break;case BadmintonButton.TYPE.LIGHT_BLUE:bgImage="fish_BT_06.png";break;case BadmintonButton.TYPE.PURPLE:bgImage="fish_BT_14_2.png";break;case BadmintonButton.TYPE.PINK_ARROW:bgImage="fish_BT_07.png";break;case BadmintonButton.TYPE.YELLOW_ARROW:bgImage="fish_BT_01-2.png";break;case BadmintonButton.TYPE.YELLOW_NO_FRAME:bgImage="fish_BT_10.png";break;case BadmintonButton.TYPE.GREEN_NO_FRAME:bgImage="fish_BT_11_2.png";break;
case BadmintonButton.TYPE.BLUE_NO_FRAME:bgImage="fish_BT_13.png";break;case BadmintonButton.TYPE.PURPLE_NO_FRAME:bgImage="fish_BT_14.png";break;case BadmintonButton.TYPE.GRAY_NO_FRAME:bgImage="fish_BT_12.png";break}return bgImage}});BadmintonButton.TYPE=GSEnumHelper({YELLOW:-1,BLUE:-1,GRAY:-1,GREEN:-1,RED:-1,LIGHT_BLUE:-1,PURPLE:-1,PINK_ARROW:-1,YELLOW_ARROW:-1,YELLOW_NO_FRAME:-1,GREEN_NO_FRAME:-1,BLUE_NO_FRAME:-1,PURPLE_NO_FRAME:-1,GRAY_NO_FRAME:-1});BadmintonButton.STROKE_COLOR={};
BadmintonButton.STROKE_COLOR[BadmintonButton.TYPE.YELLOW]=cc.color(102,55,10);BadmintonButton.STROKE_COLOR[BadmintonButton.TYPE.BLUE]=cc.color(0,68,129);BadmintonButton.STROKE_COLOR[BadmintonButton.TYPE.GRAY]=cc.color(66,66,66);BadmintonButton.STROKE_COLOR[BadmintonButton.TYPE.GREEN]=cc.color(0,94,20);BadmintonButton.STROKE_COLOR[BadmintonButton.TYPE.RED]=cc.color(102,10,10);BadmintonButton.STROKE_COLOR[BadmintonButton.TYPE.LIGHT_BLUE]=cc.color(0,113,185);
BadmintonButton.STROKE_COLOR[BadmintonButton.TYPE.PURPLE]=cc.color(119,0,181);BadmintonButton.STROKE_COLOR[BadmintonButton.TYPE.PINK_ARROW]=cc.color(155,0,58);BadmintonButton.STROKE_COLOR[BadmintonButton.TYPE.YELLOW_ARROW]=cc.color(102,55,10);BadmintonButton.STROKE_COLOR[BadmintonButton.TYPE.YELLOW_NO_FRAME]=cc.color(150,78,0);BadmintonButton.STROKE_COLOR[BadmintonButton.TYPE.GREEN_NO_FRAME]=cc.color(21,130,0);BadmintonButton.STROKE_COLOR[BadmintonButton.TYPE.BLUE_NO_FRAME]=cc.color(0,113,185);
BadmintonButton.STROKE_COLOR[BadmintonButton.TYPE.PURPLE_NO_FRAME]=cc.color(135,0,230);BadmintonButton.STROKE_COLOR[BadmintonButton.TYPE.GRAY_NO_FRAME]=cc.color(78,78,78);var BadmintonData={init:function(){var savePlayer=GS.localStorage.getItem("LocalPlayer",null);if(savePlayer)this.playerArray=JSON.parse(savePlayer);else this.restoreToDefault();this.history=[];this.sortPlayer()},addPlayer:function(name){var index=this.playerArray.findIndex(p=>p.name===name);if(index>-1)return;this.playerArray.push({name:name,isPlaying:true});this.sortPlayer();this.save()},restoreToDefault:function(){this.playerArray=[{name:"Wayne",isPlaying:true},{name:"\u963f\u96ea",isPlaying:true},
{name:"\u4e39\u4e39",isPlaying:true},{name:"Lena",isPlaying:true},{name:"\u963f\u5cf0",isPlaying:true},{name:"Bella",isPlaying:false},{name:"\u677e",isPlaying:true},{name:"Sharon",isPlaying:true},{name:"\u5e79\u6851",isPlaying:true},{name:"\u963f\u80a5",isPlaying:true},{name:"BB",isPlaying:true},{name:"Vicki",isPlaying:true},{name:"Alice",isPlaying:false},{name:"Joane",isPlaying:false},{name:"\u54aa\u54aa",isPlaying:false}];this.sortPlayer();this.save();GS.dispatchCustomEvent("NotifyUpdateTableView",
true)},save:function(){var newArray=this.playerArray.map(c=>{return{name:c.name,isPlaying:c.isPlaying}});GS.localStorage.setItem("LocalPlayer",JSON.stringify(newArray))},sortPlayer:function(){this.playerArray.sort((a,b)=>b.isPlaying-a.isPlaying);GS.dispatchCustomEvent("NotifyUpdateTableView")},play:function(index){var newPlayerArray=this.playerArray.slice().filter(p=>p.isPlaying).shuffle().sort((a,b)=>(a.playCount||0)-(b.playCount||0)).slice(0,4).shuffle();for(var i=0;i<4;i++)newPlayerArray[i].playCount=
(newPlayerArray[i].playCount||0)+1;this.history.push(newPlayerArray);GS.dispatchCustomEvent("NotifyUpdateTableView");return newPlayerArray}};Array.prototype.shuffle=function(){var i=this.length;while(i){var j=Math.floor(Math.random()*i);var t=this[--i];this[i]=this[j];this[j]=t}return this};var BadmintonLayer=cc.Layer.extend({ctor:function(){this._super();var background=new cc.Sprite("background.jpeg");background.setPosition(JSScreenMidPos);this.addChild(background);var courtNode=new CourtNode(1);courtNode.setPosition(JSScreenSafeWidth+90,JSScreenMidPos.y+16);this.addChild(courtNode);var historySize=cc.size(160,100);var historyNode=new HistoryNode(cc.size(160,100));historyNode.setPosition(JSScreenMidPos.x,historySize.height/2+10);this.addChild(historyNode);{var editboxPosY=JSVisibleSize.height-
40;var editBoxSize=cc.size(150,24);var editboxSprite1=new ccui.Scale9Sprite("select_01.png");var editboxSprite2=new ccui.Scale9Sprite("select_01.png");editboxSprite2.setColor(JSColor.GRAY);var accEditBox=new cc.EditBox(editBoxSize,editboxSprite1,editboxSprite2);accEditBox.setPosition(JSScreenMidPos.x,editboxPosY);accEditBox.setFontColor(JSColor.BLACK);accEditBox.setPlaceHolder("\u65b0\u589e\u5e33\u865f");accEditBox.setFontName(JSFontBoldName);accEditBox.setFontSize(12);accEditBox.setPlaceholderFontName(JSFontBoldName);
accEditBox.setReturnType(cc.KEYBOARD_RETURNTYPE_DONE);accEditBox.setInputFlag(cc.EDITBOX_INPUT_FLAG_SENSITIVE);accEditBox.setInputMode(cc.EDITBOX_INPUT_MODE_SINGLELINE);accEditBox.setCascadeOpacityEnabled(true);accEditBox.setMaxLength(100);accEditBox.setDelegate(this);this.addChild(accEditBox);var button=new BadmintonButton(BadmintonButton.TYPE.YELLOW,"\u65b0\u589e");button.setPosition(JSScreenMidPos.x+40,editboxPosY-30);button.addTouchUpInsideAction(()=>{if(!accEditBox.getString())return;BadmintonData.addPlayer(accEditBox.getString())},
this);this.addChild(button);var button=new BadmintonButton(BadmintonButton.TYPE.BLUE,"\u6e05\u6389\u65b0\u589e");button.setPosition(JSScreenMidPos.x-40,editboxPosY-30);button.addTouchUpInsideAction(()=>{BadmintonData.restoreToDefault()},this);this.addChild(button)}{var tableViewWidth=this._tableViewWidth=150;var tableViewPos=cc.p(JSVisibleSize.width-JSScreenSafeWidth-tableViewWidth,0);var tableViewBg=new ccui.Scale9Sprite("fish_BG_frame10.png");tableViewBg.setPreferredSize(cc.size(tableViewWidth+
JSScreenSafeWidth,JSVisibleSize.height));tableViewBg.setAnchorPoint(0,0);tableViewBg.setPosition(tableViewPos);this.addChild(tableViewBg);var tableView=this._tableView=new cc.TableView(this,cc.size(tableViewWidth,JSVisibleSize.height));tableView.setDirection(cc.SCROLLVIEW_DIRECTION_VERTICAL);tableView.setVerticalFillOrder(cc.TABLEVIEW_FILL_TOPDOWN);tableView.setPosition(tableViewPos);tableView.setDelegate(this);this.addChild(tableView);tableView.reloadData(true)}GS.addListener("NotifyUpdateTableView",
this.notifyUpdateTableView.bind(this),this)},tableCellAtIndex:function(table,idx){var cell=table.dequeueCell();if(cell==null){cell=new PlayerCell;cell.setAnchorPoint(cc.p(0,0))}cell.refreshCell(idx);return cell},numberOfCellsInTableView:function(table){return BadmintonData.playerArray.length},tableCellSizeForIndex:function(table,idx){return cc.size(this._tableViewWidth,PlayerCell.HEIGHT)},notifyUpdateTableView:function(e){this._tableView.reloadData(e.getUserData())}});var CourtNode=cc.Node.extend({ctor:function(index=1){this._super();this._index=index;var bgSprite=new cc.Sprite("court.jpg");bgSprite.setScale(.7,.4);this.addChild(bgSprite);var titleLabel=new cc.LabelTTF("\u5834\u5730:"+index.toString(),JSFontBoldName,14);titleLabel.setPosition(0,105);titleLabel.enableStroke(JSColor.BLACK,2);this.addChild(titleLabel);this._labels=[];var lrPadding=38;var tbPadding=58;for(var i=0;i<4;i++){var label=this._labels[i]=new cc.LabelTTF("",JSFontBoldName,12,cc.size(0,0),
1,1);label.setPosition(i%2===0?-lrPadding:lrPadding,i>1?-tbPadding:tbPadding-2);label.enableStroke(JSColor.BLACK,2);this.addChild(label)}var button=new BadmintonButton(BadmintonButton.TYPE.YELLOW,"\u958b\u6253");button.setPosition(40,-108);button.addTouchUpInsideAction(this._playClicked,this);this.addChild(button);var button=new BadmintonButton(BadmintonButton.TYPE.BLUE,"\u91cd\u65b0\u5206\u914d");button.setPosition(-40,-108);button.addTouchUpInsideAction(this._resetClicked,this);this.addChild(button);
var button=new BadmintonButton(BadmintonButton.TYPE.GREEN,"\u56de\u4e0a\u4e00\u5834");button.setPosition(0,-140);button.addTouchUpInsideAction(this._backClicked,this);this.addChild(button)},_playClicked:function(){var playingArray=this._playingArray=BadmintonData.play(this._index);for(var i=0;i<4;i++)this._labels[i].setString(playingArray[i].name)},_resetClicked:function(){var playingArray=BadmintonData.history.pop();if(!playingArray||playingArray.length<4)return;for(var i=0;i<4;i++)playingArray[i].playCount--;
this._playClicked()},_backClicked:function(){var lastArray=BadmintonData.history.pop();if(lastArray)lastArray.forEach(p=>p.playCount--);if(BadmintonData.history.length){var playingArray=BadmintonData.history[BadmintonData.history.length-1];for(var i=0;i<4;i++)this._labels[i].setString(playingArray[i].name)}else for(var i=0;i<4;i++)this._labels[i].setString("");GS.dispatchCustomEvent("NotifyUpdateTableView")}});var HistoryNode=cc.Node.extend({ctor:function(size){this._super();this._tableViewSize=size;this._cellHeight=14;var bgSprite=new ccui.Scale9Sprite("select_01.png");bgSprite.setPreferredSize(size);this.addChild(bgSprite);var titleLabel=new cc.LabelTTF("\u6b77\u53f2\u8a18\u9304",JSFontBoldName,14);titleLabel.enableStroke(JSColor.BLACK,2);titleLabel.setAnchorPoint(0,0);titleLabel.setPosition(-size.width/2+2,size.height/2+2);this.addChild(titleLabel);var tableView=this._tableView=new cc.TableView(this,
size);tableView.setDirection(cc.SCROLLVIEW_DIRECTION_VERTICAL);tableView.setVerticalFillOrder(cc.TABLEVIEW_FILL_TOPDOWN);tableView.setPosition(-size.width/2,-size.height/2);tableView.setDelegate(this);this.addChild(tableView);GS.addListener("NotifyUpdateTableView",this.notifyUpdateTableView.bind(this),this)},tableCellAtIndex:function(table,idx){var cell=table.dequeueCell();if(cell==null){cell=new cc.TableViewCell;cell.setAnchorPoint(cc.p(0,0));var nameLabel=cell.nameLabel=new cc.LabelTTF("",JSFontBoldName,
8);nameLabel.setFontFillColor(JSColor.BLACK);nameLabel.setAnchorPoint(0,.5);nameLabel.setPosition(2,this._cellHeight/2);cell.addChild(nameLabel)}var playerArray=BadmintonData.history[idx];var str=JSStringUtility.format("%s.[%s , %s] vs [%s , %s]",idx+1,playerArray[0].name,playerArray[1].name,playerArray[2].name,playerArray[3].name);cell.nameLabel.setString(str);return cell},numberOfCellsInTableView:function(table){return BadmintonData.history.length},tableCellSizeForIndex:function(table,idx){return cc.size(this._tableViewSize.width,
this._cellHeight)},notifyUpdateTableView:function(){this._tableView.reloadData(true);this._tableView.setContentOffset(cc.p(0,0))}});var LaunchScene=cc.Scene.extend({ctor:function(){this._super();if(cc.sys.isNative){var searchArray=[JSWriteablePath,GS.resourcesFolder];jsb.fileUtils.setSearchPaths(searchArray)}cc.spriteFrameCache.addSpriteFrames("common/common.plist","common/common.png");var notificationNode=new cc.Node;notificationNode.setPosition(JSOriginPoint);cc.director.setNotificationNode(notificationNode);BadmintonData.init();var mainLayer=new BadmintonLayer;mainLayer.setPosition(JSOriginPoint);this.addChild(mainLayer)}});var PlayerCell=cc.TableViewCell.extend({ctor:function(){this._super();this.setCascadeColorEnabled(true);var posY=PlayerCell.HEIGHT/2;var checkButton=this._checkBtn=new PlayerCheckButton;checkButton.setAnchorPoint(0,.5);checkButton.setPosition(2,posY);checkButton.addTouchUpInsideAction(this._checkButtonClicked,this);this.addChild(checkButton);var label=this._nameLabel=new cc.LabelTTF("",JSFontBoldName,10);label.enableStroke(JSColor.BLACK,2);label.setAnchorPoint(0,.5);label.setPosition(16,posY);this.addChild(label);
var countLabel=this._countLabel=new cc.LabelTTF("0",JSFontBoldName,10);countLabel.enableStroke(JSColor.BLACK,2);countLabel.setAnchorPoint(0,.5);countLabel.setPosition(90,posY);this.addChild(countLabel)},refreshCell:function(index){this._index=index;var param=BadmintonData.playerArray[index];this._nameLabel.setString(param.name);this._countLabel.setString((param.playCount||0).toString());this._checkBtn.setIsPlay(param.isPlaying)},_checkButtonClicked:function(){var param=BadmintonData.playerArray[this._index];
param.isPlaying=!param.isPlaying;this._checkBtn.setIsPlay(param.isPlaying);BadmintonData.sortPlayer()}});PlayerCell.HEIGHT=20;var PlayerCheckButton=GSControlButton.extend({ctor:function(){var contentNode=new cc.Node;this._super(contentNode,cc.size(24,24));var checkSprite=this._checkSprite=new cc.Sprite("#select_02.png");contentNode.addChild(checkSprite);this.setScale(.5);this.enableTouchCancel(cc.SCROLLVIEW_DIRECTION_VERTICAL)},setIsPlay:function(isPlay){this._checkSprite.setSpriteFrame(isPlay?"select_02.png":"select_01.png")}});
//# sourceMappingURL=game_h5.js.map